<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.35">
<style type="text/css">
.equationcontainer{position:relative;}
.equationnumber{float:right;left:auto;position:absolute;right:0}
.equationnumber-valign{float:right;left:auto;position:absolute;right:0;margin-top:-0.5em;}
.floatrule{background-color: black; border: none; height: 1px; width: 80%}
.phantom{display: inline-block; visibility: hidden}
.hphantom{display: inline-block; height: 0; visibility: hidden}
.vphantom{display: inline-block; visibility: hidden; width: 0}
.smash{display: inline-block; height: 0; line-height: 0}
.li-itemize{margin:1ex 0ex;}
.li-enumerate{margin:1ex 0ex;}
.dd-description{margin:0ex 0ex 1ex 4ex;}
.dt-description{margin:0ex;}
.toc{list-style:none;}
.footnotetext{margin:0ex; padding:0ex;}
div.footnotetext P{margin:0px; text-indent:1em;}
.thefootnotes{text-align:left;margin:0ex;}
.dt-thefootnotes{margin:0em;}
.dd-thefootnotes{margin:0em 0em 0em 2em;}
.footnoterule{background-color: black; border: none; height: 1px; margin: 1em auto 1em 0px; width: 40%}
.caption{padding-left:2ex; padding-right:2ex; margin-left:auto; margin-right:auto}
.title{margin:2ex auto;text-align:center}
.titlemain{margin:1ex 2ex 2ex 1ex;}
.titlerest{margin:0ex 2ex;}
.center{text-align:center;margin-left:auto;margin-right:auto;}
.flushleft{text-align:left;margin-left:0ex;margin-right:auto;}
.flushright{text-align:right;margin-left:auto;margin-right:0ex;}
div table{margin-left:inherit;margin-right:inherit;margin-bottom:2px;margin-top:2px}
td table{margin:auto;}
table{border-collapse:collapse;}
td{padding:0;}
.cellpadding0 tr td{padding:0;}
.cellpadding1 tr td{padding:1px;}
pre{text-align:left;margin-left:0ex;margin-right:auto;}
blockquote{margin-left:4ex;margin-right:4ex;text-align:left;}
td p{margin:0px;}
.quote{margin-left:3em;margin-right:3em;text-align:inherit;text-indent:0pt}
.quotation{margin-left:3em;margin-right:3em;text-align:inherit;text-indent:1.5em}
.verse{margin-left:3em;margin-right:3em;text-indent:1.5em hanging each-line}
.parbox{box-sizing: border-box;
display: inline-block;
text-indent: 0;
}
.rule-rect{fill: black;}
.lrbox{box-sizing:border-box;display:inline-block;overflow:visible;white-space:nowrap;}
.center-lrbox{display:inline-block;margin-left:50%;transform:translateX(-50%);}
.makebox{}
.framebox{border:1px solid black;padding:0.25em;}
.vertical-rule{border:none;width:2px;background-color:black;}
.horizontal-rule{border:none;background-color:black;}
.hrule{border:none;height:2px;width:100%;background-color:black;}
.hfill{border:none;height:1px;width:200%;background-color:black;}
.vdisplay{border-collapse:separate;border-spacing:2px;line-height:1.1;width:auto; empty-cells:show; border:2px solid red;}
.vdcell{white-space:nowrap;padding:0px; border:2px solid green;}
.display{border-collapse:separate;border-spacing:2px;line-height:1.1;width:auto; border:none;}
.dcell{white-space:nowrap;padding:0px; border:none;}
.dcenter{margin:0ex auto;}
.vdcenter{border:solid #FF8000 2px; margin:0ex auto;}
.minipage{text-align:left; margin-left:0em; margin-right:auto;}
.marginpar{border:solid thin black; margin-bottom:1ex; width:20%; text-align:left;}
.marginparleft{float:left; clear:left; margin-left:0ex; margin-right:1ex;}
.marginparright{float:right; clear:right; margin-left:1ex; margin-right:0ex;}
.theorem{text-align:left;margin:1ex auto 1ex 0ex;}
.part{margin:2ex auto;text-align:center}
</style>
<title>Ott: Tool Support for
Semantics  
User Guide 
 version 0.33

</title>
</head>
<body >
<!--HEVEA command line is: hevea -fix top2 -->
<!--CUT STYLE article--><!--CUT DEF section 1 --><table class="title"><tr><td style="padding:1ex"><h1 class="titlemain">Ott: Tool Support for
Semantics <br>
User Guide<br>
 version 0.33
</h1><h3 class="titlerest">Peter Sewell<sup>*</sup> &#X2003;&#X2003;Francesco Zappa Nardelli<sup>**</sup> &#X2003;&#X2003;Scott Owens <sup>*</sup> <br>
with Gilles Peskine<sup>*</sup>, Tom
Ridge<sup>*</sup>,<br>
Susmit Sarkar<sup>*</sup>, and Rok Strni&#X161;a<sup>*</sup><br>
 <sup>*</sup>University of Cambridge &#X2003;&#X2003;<sup>**</sup>INRIA</h3></td></tr>
</table><!--TOC section id="sec1" <span style="font-size:small">Contents</span>-->
<h2 id="sec1" class="section"><span style="font-size:small">Contents</span></h2><!--SEC END --><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec2"><span style="font-size:small">1&#X2003;Introduction</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec3"><span style="font-size:small">2&#X2003;Getting started with Ott (the README)</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec4"><span style="font-size:small">2.1&#X2003;Documentation</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec5"><span style="font-size:small">2.2&#X2003;Papers</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec6"><span style="font-size:small">2.3&#X2003;People</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec7"><span style="font-size:small">2.4&#X2003;To install and build</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec8"><span style="font-size:small">2.4.1&#X2003;With OPAM (released
version)</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec9"><span style="font-size:small">2.4.2&#X2003;With OPAM (github
checkout)</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec10"><span style="font-size:small">2.4.3&#X2003;Without OPAM</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec11"><span style="font-size:small">2.5&#X2003;To run</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec12"><span style="font-size:small">2.6&#X2003;Editor Plugins</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec13"><span style="font-size:small">2.6.1&#X2003;Emacs mode</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec14"><span style="font-size:small">2.6.2&#X2003;Visual Studio Code</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec15"><span style="font-size:small">2.7&#X2003;Mailing lists</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec16"><span style="font-size:small">2.8&#X2003;Bug Tracker</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec17"><span style="font-size:small">2.9&#X2003;Directory contents</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec18"><span style="font-size:small">2.10&#X2003;Examples</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec19"><span style="font-size:small">2.11&#X2003;Copyright information</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec20"><span style="font-size:small">3&#X2003;A minimal Ott source file: the untyped CBV lambda calculus</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec21"><span style="font-size:small">3.1&#X2003;Index variables</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec22"><span style="font-size:small">4&#X2003;Generating LaTeX</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec23"><span style="font-size:small">4.1&#X2003;Specifying LaTeX for productions</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec24"><span style="font-size:small">4.2&#X2003;Specifying LaTeX for grammar rules</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec25"><span style="font-size:small">4.3&#X2003;Using the LaTeX code</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec26"><span style="font-size:small">5&#X2003;Generating proof assistant definitions</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec27"><span style="font-size:small">5.1&#X2003;Proof assistant code for grammar rules</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec28"><span style="font-size:small">5.2&#X2003;Proof assistant code for inductive definitions</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec29"><span style="font-size:small">5.3&#X2003;Representation of binding</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec30"><span style="font-size:small">5.4&#X2003;Helper functions for free variable and substitution functions</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec31"><span style="font-size:small">5.5&#X2003;Correctness of the generated proof assistant code</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec32"><span style="font-size:small">5.6&#X2003;Using the generated proof assistant code</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec33"><span style="font-size:small">5.6.1&#X2003;Coq</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec34"><span style="font-size:small">5.6.2&#X2003;HOL</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec35"><span style="font-size:small">5.6.3&#X2003;Isabelle</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec36"><span style="font-size:small">6&#X2003;Judgments and formulae</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec37"><span style="font-size:small">6.1&#X2003;Naming of premises for the Coq backend</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec38"><span style="font-size:small">6.2&#X2003;In-line embedded prover code in premises</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec39"><span style="font-size:small">6.3&#X2003;User syntax</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec40"><span style="font-size:small">7&#X2003;Concrete terms and OCaml generation</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec41"><span style="font-size:small">8&#X2003;Filtering: Using Ott syntax within LaTeX, Coq, Isabelle,
HOL, or OCaml</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec42"><span style="font-size:small">8.1&#X2003;Filtering embedded code</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec43"><span style="font-size:small">8.2&#X2003;Filtering files</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec44"><span style="font-size:small">9&#X2003;Binding specifications</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec45"><span style="font-size:small">10&#X2003;Generating substitution and free variable functions</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec46"><span style="font-size:small">11&#X2003;Locally-nameless representation</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec47"><span style="font-size:small">12&#X2003;List forms</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec48"><span style="font-size:small">12.1&#X2003;List dot forms</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec49"><span style="font-size:small">12.2&#X2003;List comprehension forms</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec50"><span style="font-size:small">12.3&#X2003;Proof assistant code for list forms</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec51"><span style="font-size:small">12.3.1&#X2003;Types</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec52"><span style="font-size:small">12.3.2&#X2003;Terms (in inductive definition rules)</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec53"><span style="font-size:small">12.3.3&#X2003;List forms in homomorphisms</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec54"><span style="font-size:small">13&#X2003;Subrules</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec55"><span style="font-size:small">14&#X2003;Context rules</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec56"><span style="font-size:small">15&#X2003;Auxiliary Rules</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec57"><span style="font-size:small">16&#X2003;Functions</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec58"><span style="font-size:small">17&#X2003;Parsing Priorities</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec59"><span style="font-size:small">18&#X2003;Combining multiple source files</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec60"><span style="font-size:small">19&#X2003;Hom blocks</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec61"><span style="font-size:small">20&#X2003;Isabelle syntax support</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec62"><span style="font-size:small">21&#X2003;Isabelle code generation example</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec63"><span style="font-size:small">22&#X2003;Reference: Command-line usage</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec64"><span style="font-size:small">23&#X2003;Reference: The language of symbolic terms</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec65"><span style="font-size:small">24&#X2003;Reference: Generation of proof assistant definitions</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec66"><span style="font-size:small">24.1&#X2003;Generation of types</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec67"><span style="font-size:small">24.2&#X2003;Generation of functions</span></a><span style="font-size:small">
</span><ul class="toc"><li class="li-toc"><span style="font-size:small">
</span><a href="#sec68"><span style="font-size:small">24.2.1&#X2003;Subrule predicates</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec69"><span style="font-size:small">24.2.2&#X2003;Binding auxiliaries</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec70"><span style="font-size:small">24.2.3&#X2003;Free variables</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec71"><span style="font-size:small">24.2.4&#X2003;Substitutions</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec72"><span style="font-size:small">24.3&#X2003;Generation of relations</span></a><span style="font-size:small">
</span></li></ul><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec73"><span style="font-size:small">25&#X2003;Reference: Summary of homomorphisms</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec74"><span style="font-size:small">26&#X2003;Reference: The Ott source grammar</span></a><span style="font-size:small">
</span></li><li class="li-toc"><a href="#sec75"><span style="font-size:small">27&#X2003;Reference: Examples</span></a><span style="font-size:small">
</span></li></ul>
<!--TOC section id="sec2" Introduction-->
<h2 id="sec2" class="section">1&#X2003;Introduction</h2><!--SEC END --><p><a id="a1"></a>Ott is a tool for writing definitions of programming languages and
calculi. 
It takes as input a definition of a language syntax and semantics, in
a concise and readable ASCII notation that is close to what one would
write in informal mathematics. It generates output:
</p><ol class="enumerate" type=1><li class="li-enumerate">
a LaTeX source file that defines commands to build a typeset version of
the definition;
</li><li class="li-enumerate">a Coq version of the definition; 
</li><li class="li-enumerate">a HOL version of the definition;
</li><li class="li-enumerate">an Isabelle/HOL version of the definition; 
</li><li class="li-enumerate">a Lem version of the definition; 
</li><li class="li-enumerate">an OCaml version of the syntax of the definition.
</li></ol><p>
Additionally, it can be run as a filter, taking a
LaTeX/Coq/Isabelle/HOL/Lem/OCaml source file
with embedded (symbolic) terms of the defined language, parsing them and replacing
them by typeset terms.</p><p>This document is a user guide for the tool. The papers
</p><ul class="itemize"><li class="li-itemize">
<a href="http://www.cl.cam.ac.uk/users/pes20/ott/ott-jfp.pdf">Ott: Effective Tool Support for the Working Semanticist</a>. Peter Sewell, Francesco Zappa Nardelli, Scott Owens, Gilles
Peskine, Thomas Ridge, Susmit Sarkar, Rok Strni&#X161;a. 
Journal of Functional Programming 20(1):71-122, 2010 [<a href="#ott-jfp"></a>].</li><li class="li-itemize"><a href="http://www.cl.cam.ac.uk/users/pes20/ott/paper.pdf">Ott: Effective Tool Support for the Working Semanticist</a>. Peter Sewell, Francesco Zappa Nardelli, Scott Owens, Gilles
Peskine, Thomas Ridge, Susmit Sarkar, Rok Strni&#X161;a. 
ICFP&#X2019;07 [<a href="#ott-sub"></a>].</li></ul><p>
give an overview of the project, including discussion of motivation,
design decisions, and related work, and one should look at that together
with this manual. The project web page
</p><blockquote class="quotation">
<a href="http://www.cl.cam.ac.uk/users/pes20/ott/"><span style="font-family:monospace">http://www.cl.cam.ac.uk/users/pes20/ott/</span></a>
</blockquote><p>
links to the github source repository, with a
BSD-style licence. It also has a range of examples, including
untyped and simply typed CBV lambda calculus, ML polymorphism, various
first-order systems from Pierce&#X2019;s TAPL&#X2004;&#X200D;[<a href="#Pierce%3ATypeSystems"></a>], the
POPLmark F<sub>&lt;:</sub> language&#X2004;&#X200D;[<a href="#poplmark"></a>], a module system by
Leroy&#X2004;&#X200D;[<a href="#Leroy-generativity"></a>, &#XA7;4] (extended with a term language and an
operational semantics), the LJ Java fragment and LJAM Java module
system&#X2004;&#X200D;[<a href="#ljam-sub"></a>], and a substantial fragment of OCaml.</p><p>Our main goal is to support work on large programming language
definitions, where the scale makes it hard to keep a definition
internally consistent, and hard to keep a tight correspondence between a
definition and implementations.
We also wish to ease rapid prototyping work with smaller calculi,
and to make it easier to exchange definitions and definition fragments
between groups.
Most simply, the tool can be used to aid completely informal LaTeX mathematics.
Here it permits the definition, and terms within proofs and
exposition, to be written in a clear, editable, ASCII notation, without LaTeX
noise. It generates good-quality typeset output. 
By parsing (and so sort-checking) this input, it quickly catches a
range of simple errors, e.g.&#X2004;&#X200D;inconsistent use of judgement forms or
metavariable naming conventions. 
That same input, extended with some additional data, can be used to generate formal definitions for
Coq, HOL, Isabelle, and Lem. It should thereby enable a smooth transition
between use of informal and formal mathematics. Further, the
tool can automatically generate definitions of functions for free
variables, single and multiple substitutions, subgrammar checks
(e.g.&#X2004;&#X200D;for value subgrammars), and binding auxiliary functions.
Ott supports a &#X2018;fully concrete&#X2019; representation, sufficient
for many examples but not dealing with general alpha equivalence. 
An experimental Coq backend generates definitions in locally-nameless style for a subset of the Ott metalanguage.
The OCaml backend 
generates type definitions that may be useful for developing a complete
implementation of the language, together with the functions listed
above. It does not generate anything for inductively defined relations
(the various proof-assistant code extraction facilities can
sometimes be used for that).
Our focus here is on the problem of writing and editing language
definitions, not (directly) on aiding mechanized proof of metatheory. If one
is involved in hard proofs about a relatively stable small calculus
then it will aid only a small part of the work (and one might choose
instead to work just within a single proof assistant), but for larger
languages the definition is a more substantial problem &#X2014; so much so
that only a handful of full-scale languages have been given complete definitions. We
aim to make this more commonplace, less of a heroic task.</p><p><a id="ott"></p>
<!--TOC section id="sec3" Getting started with Ott (the README)-->
<h2 id="sec3" class="section">2&#X2003;Getting started with Ott (the README)</h2><!--SEC END --><p></a></p><p>Ott is a tool for writing definitions of programming languages and
calculi. It takes as input a definition of a language syntax and
semantics, in a concise and readable ASCII notation that is close to
what one would write in informal mathematics. With appropriate
annotations, it can then generate output:</p><ul class="itemize"><li class="li-itemize">
a LaTeX source file that defines commands to build a typeset version
of the definition;
</li><li class="li-itemize">a Coq version of the definition;
</li><li class="li-itemize">a HOL version of the definition;
</li><li class="li-itemize">an Isabelle/HOL version of the definition;
</li><li class="li-itemize">a Lem version of the definition;
</li><li class="li-itemize">an OCaml version of the syntax of the definition; and
</li><li class="li-itemize">(experimental) a menhir parser and crude pretty printer for the
syntax.
</li></ul><p>Additionally, it can be run as a filter, taking a
LaTeX/Coq/Isabelle/HOL/Lem/OCaml source file with embedded (symbolic)
terms of the defined language, parsing them and replacing them by
typeset terms.</p><p>Most simply, Ott can be used to aid informal LaTeX mathematics. Here it
permits the definition, and terms within proofs and exposition, to be
written in a clear, editable, ASCII notation, without LaTeX noise. It
generates good-quality typeset output. By parsing (and so sort-checking)
this input, it quickly catches a range of simple errors,
e.g.&#X2004;&#X200D;inconsistent use of judgement forms or metavariable naming
conventions.</p><p>That same input can be used to generate formal definitions, for Coq,
HOL, Isabelle, and Lem. It should thereby enable a smooth transition
between use of informal and formal mathematics. Additionally, the tool
can automatically generate definitions of functions for free variables,
single and multiple substitutions, subgrammar checks (e.g.&#X2004;&#X200D;for value
subgrammars), and binding auxiliary functions. At present only a fully
concrete representation of binding, without quotienting by alpha
equivalence, is fully supported. An experimental backend generates a
locally-nameless representation of terms for a subset of the Ott
metalanguage: details can be found at
http://moscova.inria.fr/~zappa/projects/ln_ott.</p><p>The distribution includes several examples, in varying levels of
completeness: untyped and simply typed lambda-calculus, a calculus with
ML polymorphism, the POPLmark Fsub with and without records, an ML
module system taken from (Leroy, JFP 1996) and equipped with an
operational semantics, and LJ, a lightweight Java fragment. More
substantially, Ott has been used for work on iJAM and LJAM, Java Module
Systems, by Rok Strnisa, and semantics for OCaml light, by Scott Owens.</p><p>As of 2020, Ott remains in continuous use.</p><p><a id="documentation"></p>
<!--TOC subsection id="sec4" Documentation-->
<h3 id="sec4" class="subsection">2.1&#X2003;Documentation</h3><!--SEC END --><p></a></p><ul class="itemize"><li class="li-itemize">
the manual is in the <a href="https://github.com/ott-lang/ott">Ott
github</a> built_doc directory, or
<a href="http://www.cl.cam.ac.uk/&#X2004;&#X200D;pes20/ott/top2.html">here (html)</a>
</li><li class="li-itemize"><a href="http://www.cl.cam.ac.uk/users/pes20/ott/bind-doc.pdf">Binding
and Substitution</a>. Susmit Sarkar, Peter Sewell, Francesco Zappa
Nardelli. Note, 2007.
</li><li class="li-itemize"><a href="http://moscova.inria.fr/&#X2004;&#X200D;zappa/projects/ln_ott">The experimental
Coq locally-nameless backend (html)</a>. Francesco Zappa Nardelli. Note,
2009.
</li></ul><p><a id="papers"></p>
<!--TOC subsection id="sec5" Papers-->
<h3 id="sec5" class="subsection">2.2&#X2003;Papers</h3><!--SEC END --><p></a></p><ul class="itemize"><li class="li-itemize">
<a href="http://www.cl.cam.ac.uk/users/pes20/ott-jfp.pdf">Ott: Effective
Tool Support for the Working Semanticist</a>. Peter Sewell, Francesco
Zappa Nardelli, Scott Owens, Gilles Peskine, Thomas Ridge, Susmit
Sarkar, Rok Strnisa.
<a href="http://journals.cambridge.org/repo_A71Keeig">Journal of
Functional Programming 20(1):71-122, 2010</a>
</li><li class="li-itemize"><a href="http://www.cl.cam.ac.uk/users/pes20/paper.pdf">Ott: Effective
Tool Support for the Working Semanticist</a>. Peter Sewell, Francesco
Zappa Nardelli, Scott Owens, Gilles Peskine, Thomas Ridge, Susmit
Sarkar, Rok Strnisa. In
<a href="http://www.informatik.uni-bonn.de/%7Eralf/icfp07.html">ICFP
2007</a>
</li><li class="li-itemize"><a href="http://www.cl.cam.ac.uk/users/pes20/wmm2010.pdf">Ott or Nott</a>.
Stephanie Weirich, Scott Owens, Peter Sewell, Francesco Zappa
Nardelli. In <a href="http://www.cis.upenn.edu/&#X2004;&#X200D;bcpierce/wmm/">WMM 2010</a>:
5th ACM SIGPLAN Workshop on Mechanizing Metatheory.
</li></ul><p><a id="people"></p>
<!--TOC subsection id="sec6" People-->
<h3 id="sec6" class="subsection">2.3&#X2003;People</h3><!--SEC END --><p></a></p><p>Ott has been principally developed by Peter Sewell, Francesco Zappa
Nardelli, and Scott Owens, with contributions from many others including
Joey Eremondi, Hannes Mehnert, Karl Palmskog, Matthew Parkinson, Thibaut
Perami, Gilles Peskine, Alastair Reid, Tom Ridge, Susmit Sarkar, Rok
Strnisa, Viktor Vafeiadis.</p><p><a id="to-install-and-build"></p>
<!--TOC subsection id="sec7" To install and build-->
<h3 id="sec7" class="subsection">2.4&#X2003;To install and build</h3><!--SEC END --><p></a></p><p>Ott is available as an <a href="https://opam.ocaml.org">opam</a> package and a
<a href="https://github.com/ott-lang/ott">github repo</a>.</p><p><a id="with-opam-released-version"></p>
<!--TOC subsubsection id="sec8" With OPAM (released
version)-->
<h4 id="sec8" class="subsubsection">2.4.1&#X2003;With OPAM (released
version)</h4><!--SEC END --><p></a></p><p>First, ensure you have opam (the OCaml package manager) installed,
version 2.0 or greater (opam 1 versions of ott are no longer supported).
You can use your system&#X2019;s package manager
e.g.&#X2004;&#X200D;<span style="font-family:monospace">sudo apt-get install opam</span> (e.g.&#X2004;&#X200D;on Ubuntu 20.04) or
follow the <a href="https://opam.ocaml.org/doc/Install.html">instructions
from the opam website</a>. On older Ubuntu versions you will not be able to
use their package manager&#X2019;s opam 1 version, and will need to install
opam 2 following the instructions on the opam website.</p><p>Then <span style="font-family:monospace">opam install ott</span> will install the latest Ott version.
The Emacs mode will be in
<span style="font-family:monospace">$(opam config var prefix)/share/emacs/site-lisp</span>, and
documentation in <span style="font-family:monospace">$(opam config var prefix)/doc/ott</span>.</p><p>If you want to use Ott with the Coq proof assistant, to install the Ott
auxiliary files for Coq, first activate the <span style="font-family:monospace">coq-released</span> OPAM
repository:</p><p><span style="font-family:monospace">opam repo add coq-released https://coq.inria.fr/opam/released</span></p><p>and then run <span style="font-family:monospace">opam install coq-ott</span>.</p><p><a id="with-opam-github-checkout"></p>
<!--TOC subsubsection id="sec9" With OPAM (github
checkout)-->
<h4 id="sec9" class="subsubsection">2.4.2&#X2003;With OPAM (github
checkout)</h4><!--SEC END --><p></a></p><p>In the checkout directory, run <span style="font-family:monospace">opam pin add ott .</span>.</p><p>To rebuild and reinstall after local changes, run
<span style="font-family:monospace">opam upgrade --working-dir ott</span> (or
<span style="font-family:monospace">opam upgrade -w ott</span>).</p><p><a id="without-opam"></p>
<!--TOC subsubsection id="sec10" Without OPAM-->
<h4 id="sec10" class="subsubsection">2.4.3&#X2003;Without OPAM</h4><!--SEC END --><p></a></p><p>Ott depends on OCaml version 4.07.0 or later and the ocamlgraph package.
It builds with (at least) OCaml 4.07.0 and 4.14.0, and ocamlgraph 1.8.8.</p><p>The command <span style="font-family:monospace">make</span> (<span style="font-family:monospace">make world</span>) builds the <span style="font-family:monospace">ott</span>
binary in the <span style="font-family:monospace">bin/</span> subdirectory.</p><p>This will compile Ott using <span style="font-family:monospace">ocamlopt</span>. To force it to compile
with <span style="font-family:monospace">ocamlc</span> (which may give significantly slower execution of
Ott), do <span style="font-family:monospace">make world.byt</span>.</p><p>To build the Ott auxiliary files for Coq, go to the <span style="font-family:monospace">coq/</span>
subdirectory and run <span style="font-family:monospace">make</span>. To install the resulting files in
Coq&#X2019;s <span style="font-family:monospace">user-contrib</span>, run <span style="font-family:monospace">make install</span>.</p><p><a id="to-run"></p>
<!--TOC subsection id="sec11" To run-->
<h3 id="sec11" class="subsection">2.5&#X2003;To run</h3><!--SEC END --><p></a></p><p>Ott runs as a command-line tool. Executing <span style="font-family:monospace">ott</span> shows the usage
and options. To run Ott on the test file <span style="font-family:monospace">tests/test10.ott</span>,
generating LaTeX in <span style="font-family:monospace">test10.tex</span> and Coq in <span style="font-family:monospace">test10.v</span>,
type:</p><p><span style="font-family:monospace">ott -i tests/test10.ott -o test10.tex -o test10.v</span></p><p>Isabelle, HOL, and Lem can be generated with options
<span style="font-family:monospace">-o test10.thy</span>, <span style="font-family:monospace">-o test10Script.sml</span>, and
<span style="font-family:monospace">-o test10.lem</span>, respectively.</p><p>The Makefile has various sample targets,
<span style="font-family:monospace">make tests/test10.out</span>, <span style="font-family:monospace">make test7</span>, etc. Typically
they generate:</p><p>


</p><blockquote class="table"><div class="center"><hr class="floatrule"></div><div class="center"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >
filename</td><td style="text-align:left;white-space:nowrap" >description</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">out.tex</span></td><td style="text-align:left;white-space:nowrap" >LaTeX source for a definition</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">out.ps</span></td><td style="text-align:left;white-space:nowrap" >the postscript built from that</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">out.v</span></td><td style="text-align:left;white-space:nowrap" >Coq source</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">outScript.sml</span></td><td style="text-align:left;white-space:nowrap" >HOL source</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">out.thy</span></td><td style="text-align:left;white-space:nowrap" >Isabelle source</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table>

</div><div class="center"><hr class="floatrule"></div></blockquote><p>from files <span style="font-family:monospace">test10.ott</span>, <span style="font-family:monospace">test8.ott</span>, etc., in
<span style="font-family:monospace">tests/</span>.</p><p><a id="editor-plugins"></p>
<!--TOC subsection id="sec12" Editor Plugins-->
<h3 id="sec12" class="subsection">2.6&#X2003;Editor Plugins</h3><!--SEC END --><p></a></p><p><a id="emacs-mode"></p>
<!--TOC subsubsection id="sec13" Emacs mode-->
<h4 id="sec13" class="subsubsection">2.6.1&#X2003;Emacs mode</h4><!--SEC END --><p></a></p><p>The file <span style="font-family:monospace">emacs/ott-mode.el</span> defines a very simple Emacs mode for
syntax highlighting of Ott source files. It can be used by, for example,
adding the following to your <span style="font-family:monospace">.emacs</span> file, replacing
<span style="font-family:monospace">PATH</span> by a path to your Ott Emacs directory.</p><pre class="verbatim">(setq load-path (cons (expand-file-name "PATH") load-path))
(require 'ott-mode)
</pre><p>For installations using OPAM on *nix systems, it is sufficient to use
the following code, which will call <span style="font-family:monospace">opam config var prefix</span>
at load-time.</p><pre class="verbatim">(setq opam-share (substring (shell-command-to-string "opam config var share") 0 -1))
(add-to-list 'load-path (concat opam-share "/emacs/site-lisp"))
(require 'ott-mode)
</pre><p><a id="visual-studio-code"></p>
<!--TOC subsubsection id="sec14" Visual Studio Code-->
<h4 id="sec14" class="subsubsection">2.6.2&#X2003;Visual Studio Code</h4><!--SEC END --><p></a></p><p>There is a
<a href="https://marketplace.visualstudio.com/items?itemName=JoeyEremondi.ott">plugin
for VSCode</a>, which features syntax highlighting and inline error
reporting.</p><p><a id="mailing-lists"></p>
<!--TOC subsection id="sec15" Mailing lists-->
<h3 id="sec15" class="subsection">2.7&#X2003;Mailing lists</h3><!--SEC END --><p></a></p><ul class="itemize"><li class="li-itemize">
<a href="https://lists.cam.ac.uk/mailman/listinfo/cl-ott-announce">cl-ott-announce
announcement mailing list</a>
</li><li class="li-itemize"><a href="https://lists.cam.ac.uk/mailman/listinfo/cl-ott-discuss">cl-ott-discuss
discussion mailing list</a>
</li></ul><p><a id="bug-tracker"></p>
<!--TOC subsection id="sec16" Bug Tracker-->
<h3 id="sec16" class="subsection">2.8&#X2003;Bug Tracker</h3><!--SEC END --><p></a></p><ul class="itemize"><li class="li-itemize">
Please now use the github issue tracker (though our resources for
fixing issues are very limited)
</li><li class="li-itemize">The previous issue tracker is here
</li></ul><p><a id="directory-contents"></p>
<!--TOC subsection id="sec17" Directory contents-->
<h3 id="sec17" class="subsection">2.9&#X2003;Directory contents</h3><!--SEC END --><p></a></p><p>


</p><blockquote class="table"><div class="center"><hr class="floatrule"></div><div class="center"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >
directory</td><td style="text-align:left;white-space:nowrap" >description</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">aux/</span></td><td style="text-align:left;white-space:nowrap" >auxiliary code (y2l) used to build the user
guide</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">bin/</span></td><td style="text-align:left;white-space:nowrap" >the Ott binary</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">built_doc/</span></td><td style="text-align:left;white-space:nowrap" >the user guide, in html, pdf, and
ps</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">coq/</span></td><td style="text-align:left;white-space:nowrap" >auxiliary files for Coq</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">doc/</span></td><td style="text-align:left;white-space:nowrap" >the user guide sources</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">emacs/</span></td><td style="text-align:left;white-space:nowrap" >an Ott Emacs mode</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">examples/</span></td><td style="text-align:left;white-space:nowrap" >some larger example Ott files</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">tex/</span></td><td style="text-align:left;white-space:nowrap" >auxiliary files for LaTeX</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">hol/</span></td><td style="text-align:left;white-space:nowrap" >auxiliary files for HOL</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">menhir/</span></td><td style="text-align:left;white-space:nowrap" >auxiliary files for menhir</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">ocamlgraph-1.7.tar.gz</span></td><td style="text-align:left;white-space:nowrap" >a copy of the ocamlgraph
library</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">regression/</span></td><td style="text-align:left;white-space:nowrap" >regression-test machinery</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">tests/</span></td><td style="text-align:left;white-space:nowrap" >various small example Ott files</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">src/</span></td><td style="text-align:left;white-space:nowrap" >the (OCaml) Ott sources</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">Makefile</span></td><td style="text-align:left;white-space:nowrap" >a Makefile for the examples</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">LICENCE</span></td><td style="text-align:left;white-space:nowrap" >the BSD-style licence terms</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">README.md</span></td><td style="text-align:left;white-space:nowrap" >this file (Section 2 of the user
guide)</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">revisionhistory.txt</span></td><td style="text-align:left;white-space:nowrap" >the revision history</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table>

</div><div class="center"><hr class="floatrule"></div></blockquote><p><a id="examples"></p>
<!--TOC subsection id="sec18" Examples-->
<h3 id="sec18" class="subsection">2.10&#X2003;Examples</h3><!--SEC END --><p></a></p><p>The following LaTeX, Coq, HOL, and Isabelle files, except the proof
scripts, are all automatically generated from the Ott sources.</p><p>System</p><p>Rules</p><p>Ott sources</p><p>Latex</p><p>Typeset</p><p>Dot</p><p>Coq</p><p>HOL</p><p>Isabelle</p><p>Defn</p><p>Proof</p><p>Defn</p><p>Proof</p><p>Defn</p><p>Proof</p><p>Untyped CBV lambda</p><p>3</p><p>test10.ott</p><p>test10.tex</p><p>(ps)</p><p>test10.v</p><p>test10Script.sml</p><p>test10.thy</p><p>Simply typed CBV lambda</p><p>6</p><p>test10st.ott</p><p>test10st.tex</p><p>(ps)</p><p>test10st.v</p><p>test10st_metatheory.v</p><p>test10stScript.sml</p><p>test10st_metatheoryScript.sml</p><p>test10st.thy</p><p>test10st_metatheory.thy</p><p>ML polymorphism</p><p>22</p><p>test8.ott</p><p>test8.tex</p><p>(ps)</p><p>test8.v</p><p>test8Script.sml</p><p>test8.thy</p><p>TAPL roughly-full-simple</p><p>63</p><p>(sources)</p><p>(ps)</p><p>(Coq (including records))</p><p>(HOL)</p><p>(script)</p><p>(Isabelle)</p><p>(script)</p><p>POPLmark Fsub (*)</p><p>48</p><p>(sources)</p><p>(latex)</p><p>(pdf) &#X2004;&#X200D; (ps)</p><p>Leroy JFP96 module system (*)</p><p>67</p><p>leroy-jfp96.ott</p><p>(latex)</p><p>(ps)</p><p>(HOL)</p><p>LJ: Lightweight Java</p><p>85</p><p>(sources)</p><p>(pdf)</p><p>(Isabelle)</p><p>(zip)</p><p>LJAM: Java Module System</p><p>163</p><p>(sources)</p><p>(pdf)</p><p>(Isabelle)</p><p>(zip)</p><p>OCaml light</p><p>310</p><p>(sources)</p><p>(ps)</p><p>(ps)</p><p>(Coq)</p><p>(HOL)</p><p>(scripts)</p><p>(Isabelle)</p><p>(*) These systems would need explicit alpha conversion in the rules to
capture the intended semantics using the fully concrete representation.</p><p><a id="copyright-information"></p>
<!--TOC subsection id="sec19" Copyright information-->
<h3 id="sec19" class="subsection">2.11&#X2003;Copyright information</h3><!--SEC END --><p></a></p><p>The ocamlgraph library is distributed under the LGPL (from
http://www.lri.fr/~filliatr/ftp/ocamlgraph/); we include
a snapshot for convenience. For its authorship and copyright information
see the files therein.</p><p>All other files are distributed under the BSD-style licence in LICENCE.
</p>
<!--TOC section id="sec20" A minimal Ott source file: the untyped CBV lambda calculus-->
<h2 id="sec20" class="section">3&#X2003;A minimal Ott source file: the untyped CBV lambda calculus</h2><!--SEC END --><p><a id="a51"></a>Fig.&#X2004;&#X200D;<a href="#a45">1</a> shows an Ott source file for an untyped call-by-value
(CBV) lambda calculus. This section explains the basic features that
appear there, while in the following sections we show what must be
added to generate typeset output, proof assistant definitions, and
other things.
</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre><span style="font-size:small">
% minimal
</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">metavar</span></span></span><span style="font-size:small"> termvar</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">,</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">  

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">grammar</span></span></span><span style="font-size:small">
t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;t_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">              
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> x            </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Var
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> t t&#X2019;         </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> App 
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> ( t )        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">S</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Paren
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small"> t / x </span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small"> t&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">M</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Tsub  

v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;v_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">              
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam 

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">subrules</span></span></span><span style="font-size:small">
  v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span></span><span style="font-size:small"> t

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defns</span></span></span><span style="font-size:small">
Jop </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">

 </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defn</span></span></span><span style="font-size:small">
 t1 --&gt; t2 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">reduce</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">&#X201D;  </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">by</span></span></span><span style="font-size:small">


</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------------------</span></span></span><span style="font-size:small">  :: ax_app
    (</span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">x.t12) v2 --&gt;  </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small">v2/x</span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small">t12

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_fun
    t1 t --&gt; t1&#X2019; t

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_arg
    v t1 --&gt; v t1&#X2019;
</span></pre><span style="font-size:small">

</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 1: Source: <span style="font-family:monospace">test10.0.ott</span><a id="a45"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><p>
The figure is colourised, with Ott keywords like <span style="color:#A51815"><span style="font-family:monospace">this</span></span> and Ott
symbols such as <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> and <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>. Other user-specific input
appears like <span style="font-family:monospace">this</span>. Any text between % and the next newline is
discarded as a comment.</p><p>At the top of the figure, the <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> declaration introduces
a sort of <em>metavariables</em> <span style="font-family:monospace">termvar</span> (with synonym <span style="font-family:monospace">x</span>), for term
variables.
The following <span style="color:#A51815"><span style="font-family:monospace">grammar</span></span> introduces two grammar rules, one for terms, with
<em>nonterminal root</em>
<span style="font-family:monospace">t</span>, and one for values <span style="font-family:monospace">v</span>.
This specifies the concrete syntax of object-language terms,
the abstract syntax representations for proof-assistant mathematics,
and the syntax of symbolic terms to be used in semantic rules.</p><p>Each rule has a rule name prefix (e.g.&#X2004;&#X200D;<span style="font-family:monospace">&#X2019;t_&#X2019;</span>) and then a list
of productions. Each production, e.g.
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam
</pre><p>
specifies a syntactic form as a list of elements, here &#X2018;<code class="verb">\</code>&#X2019;,
&#X2018;<code class="verb">x</code>&#X2019;, &#X2018;<code class="verb">.</code>&#X2019;, and &#X2018;<code class="verb">t</code>&#X2019;, each of which is either a
metavariable (the &#X2018;<code class="verb">x</code>&#X2019;), a nonterminal (the &#X2018;<code class="verb">t</code>&#X2019;), or a
terminal 
(<span style="font-family:monospace">\</span> <span style="font-family:monospace">.</span> <span style="font-family:monospace">(</span> <span style="font-family:monospace">)</span> <span style="font-family:monospace">{</span> <span style="font-family:monospace">}</span> <span style="font-family:monospace">/</span> <span style="font-family:monospace">--&gt;</span>). 
Within productions all elements must be whitespace-separated, so that
the tool can deduce which are terminals. In the symbolic terms in
the semantic rules below, however, whitespace is required only where necessary.
A few terminals have to be quoted (with <code class="verb">''</code>) if they appear in a grammar, e.g. to
use <span style="font-family:monospace">|</span> as an object-language token, as they are part of the Ott syntax, but they
do not have to be quoted at usage points. 
(If one accidentally omits inter-token whitespace in the grammar, the
output of Ott can be surprising. This is best diagnosed by looking at
the colourised ASCII or LaTeX output from Ott.)</p><p>Metavariables and nonterminals can be formed from the specified
metavariable and nonterminal roots by appending a suffix, e.g.&#X2004;&#X200D;the
nonterminal <code class="verb">t'</code> in the <code class="verb">App</code> and <code class="verb">Tsub</code> productions. </p><p>Between the <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>&#X2019;s is an optional meta flag <span style="color:#A51815"><span style="font-family:monospace">M</span></span> or <span style="color:#A51815"><span style="font-family:monospace">S</span></span>. Non-meta
productions give rise to clauses of datatype definitions in the
Isabelle/Coq/HOL output, whereas meta productions do not. Later, we
will see how the user can specify how meta syntax should be translated
away when generating proof assistant output. The two flags <span style="color:#A51815"><span style="font-family:monospace">M</span></span>
and <span style="color:#A51815"><span style="font-family:monospace">S</span></span> are identical except that productions with the latter are 
admitted when parsing example concrete terms; the <span style="color:#A51815"><span style="font-family:monospace">S</span></span> tag is thus
appropriate for lightweight syntactic sugar, such as productions for
parentheses. One can also use another flag, e.g.&#X2004;&#X200D;<span style="color:#A51815"><span style="font-family:monospace">X</span></span>, along with the command-line option <code class="verb">-tex_suppress_category</code>, to suppress 
productions in the generated LaTeX.</p><p>Each production has a production name (e.g.&#X2004;&#X200D;<code class="verb">t_Lam</code>), composed of
the rule name prefix (here&#X2004;&#X200D;<code class="verb">t_</code>) and the production name kernel
that follows the <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>&#X2019;s (here&#X2004;&#X200D;<code class="verb">Lam</code>). The production name is
used as a constructor name in the generated Isabelle/Coq/HOL. </p><p>The tool supports arbitrary context-free grammars, extended with
special constructs for list forms (c.f.&#X2004;&#X200D;&#XA7;<a href="#a61">12</a>). </p><p>Following the <span style="color:#A51815"><span style="font-family:monospace">grammar</span></span> in this example is a <span style="color:#A51815"><span style="font-family:monospace">subrule</span></span>
declaration
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">subrules</span></span>
    v <span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span> t
</pre><p>
declaring that the <code class="verb">v</code> grammar rule (of values) is a
subgrammar of the <code class="verb">t</code> rule (of terms). The tool checks that
there is in fact a subgrammar relationship, i.e.&#X2004;&#X200D;that for each
production of the lower rule there exists a production of the higher
rule with corresponding elements (up to the subrule relation). 
The subrule declaration means that, in the semantic rules below, we
will be able to use <code class="verb">v</code>&#X2019;s in places where the grammar specifies <code class="verb">t</code>&#X2019;s.
In the generated Isabelle/Coq/HOL for this example only one free
datatype will be generated, for the <code class="verb">t</code> rule, while for the <code class="verb">v</code>
rule we generate an <code class="verb">is_v</code> predicate over the <code class="verb">t</code> type. Usages of
<code class="verb">v</code> nonterminals in the semantic rules will have instances of this
predicate automatically inserted.</p><p>Finally, we give a collection of definitions of inductive relations.
In this example there is just one family of definitions (of
operational judgements), introduced by the <span style="color:#A51815"><span style="font-family:monospace">defns</span></span> <code class="verb">Jop</code>; it contains just one
definition of a relation, called <code class="verb">reduce</code>. 
In general there may be many <span style="color:#A51815"><span style="font-family:monospace">defns</span></span> blocks, each of which introduces a
mutually recursive collection of <span style="color:#A51815"><span style="font-family:monospace">defn</span></span>s. 
The relation definition
<span style="color:#A51815"><span style="font-family:monospace">defn</span></span><code class="verb"> ...</code>
also includes a grammar production specifying how elements of the
relation can be written and typeset, here
</p><pre class="verbatim">  t1 --&gt; t2
</pre><p>
As in the main grammar, the tokens of this syntax definition in the
header must be space-separated, but usages of the syntax generally
need not be.
Syntax rules for each family of
judgements, and for their union, are implicitly generated. 
The relation definition is given by a sequence of inference rules,
each with a horizontal line separating a number of premises from a
conclusion, for example as below.
</p><pre>
    t1 --&gt; t1&#X2019;
<span style="color:#007FFF"><span style="font-family:monospace">    -------------- ::</span></span> ctx_app_arg
    v t1 --&gt; v t1&#X2019;
</pre><p>
The conclusion must be a symbolic term of the form of the judgement being
defined.
In simple cases (as here) the premises can be symbolic terms of the
form of any of the defined judgements. More generally (see
&#XA7;<a href="#a53">6</a>) they can be symbolic terms of a user-defined
<span style="color:#A51815"><span style="font-family:monospace">formula</span></span> grammar, or in-line embedded prover code. 
Each rule
has a name, composed of a definition family prefix
(here empty), a definition prefix (here also empty) and a kernel
(the&#X2004;&#X200D;<code class="verb">ctx_app_arg</code>). 
</p><p>The symbolic terms in semantic rules are parsed with a scannerless parser, built
using parser combinators over character-list inputs. The parser
searches for all parses of the input. If none are found, the ASCII
and TeX output are annotated <span style="font-family:monospace">no parses</span>, with a copy of the
input with <span style="font-family:monospace">***</span> inserted at the point where the last token was
read. This is often at the point of the error (though if, for
example, a putative dot form is read but the two element lists cannot
be anti-unified, it will be after the point of the error). 
If multiple parses are found, the TeX output is annotated
<span style="font-family:monospace">multiple parses</span> and the different parses are output to the
console in detail during the Ott run. 
If the option <span style="font-family:monospace">picky_multiple_parses</span> is set to
<span style="font-family:monospace">true</span>, multiple parses are always reported. If it set to
<span style="font-family:monospace">false</span>, a symbolic term is considered ambiguous only if two
different parses compile to different strings (for a target).
The parser combinators use memoization and continuation-passing to
achieve reasonable performance on the small symbolic terms that are
typical in semantic rules. Their performance on large (whole-program
size) examples is untested.
To resolve ambiguity one can add metaproductions for parentheses (as
in Fig.&#X2004;&#X200D;<a href="#a45">1</a>), or 
production-name annotations in particular symbolic terms,
e.g.&#X2004;&#X200D;the <code class="verb">:t_tsub:</code> in the <code class="verb">AppAbs</code> rule of the POPLmark
example, 
<span style="font-family:monospace">test7.ott</span>. There is currently no support for precedence
or associativity.</p><p>This file is included in the distribution as
<span style="font-family:monospace">tests/test10.0.ott</span>. It can be processed by executing
</p><pre>
   bin/ott -i tests/test10.0.ott
</pre><p>
from the main directory. This simply reads in the file, checking that
it is well-formed. Adding options:
</p><pre>
   bin/ott -show_sort true -show_defns true -i tests/test10.0.ott
</pre><p>
it echos a colourised version to the screen,
with metavariables in red, nonterminals
in yellow, terminals in green, and object variables in white. 
The colourisation uses vt220 control codes; if they do not work on
your screen add <span style="font-family:monospace">-colour false</span> to the middle of the command
line. To suppress the echo of the definition, add
<span style="font-family:monospace">-show_sort false</span> and <span style="font-family:monospace">-show_defns false</span>.</p>
<!--TOC subsection id="sec21" Index variables-->
<h3 id="sec21" class="subsection">3.1&#X2003;Index variables</h3><!--SEC END --><p>
In addition to the <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> declarations above, the user can declare any number of distinguished <em>index</em>
metavariables, e.g. by:
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">indexvar</span></span> index<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> i<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> j<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> n<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> m <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> num <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> nat <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> num <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
</pre><p>
Given such a declaration, <code class="verb">index</code>, <code class="verb">i</code>, <code class="verb">j</code>, <code class="verb">n</code>
and <code class="verb">m</code> can be used in suffixes, e.g.&#X2004;&#X200D;in the production
</p><pre>
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  ( t1 , <span style="color:#007FFF"><span style="font-family:monospace">....</span></span> , tn )           <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Tuple
</pre><p>
There is a fixed ad-hoc language of suffixes, including numbers, primes, and index variables (see &#XA7;<a href="#a17">23</a>).
Index metavariables cannot themselves be suffixed.</p>
<!--TOC section id="sec22" Generating LaTeX-->
<h2 id="sec22" class="section">4&#X2003;Generating LaTeX</h2><!--SEC END --><p><a id="a58"></a>The example from the previous section can already be used to generate
LaTeX, for example by executing 
</p><pre>
   bin/ott -i tests/test10.0.ott -o out.tex 
</pre><p>
to produce a LaTeX file <span style="font-family:monospace">out.tex</span>. One often needs to
fine-tune the default typesetting, as illustrated in 
Figure&#X2004;&#X200D;<a href="#a46">2</a> (the Ott source) and Figure&#X2004;&#X200D;<a href="#a49">3</a>
(the resulting LaTeX). 
(The latter was built using the additional option <code class="verb">-tex_show_meta false</code>, to 
suppress display of the metaproductions.)
</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre><span style="font-size:small">
% minimal + latex + comments
</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">metavar</span></span></span><span style="font-size:small"> termvar</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">,</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">   
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">mathit</span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">termvar</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">grammar</span></span></span><span style="font-size:small">
t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;t_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">                               </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> term    </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> x            </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Var                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> variable</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> lambda  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> t t&#X2019;         </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> App                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> app     </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> ( t )        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">S</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Paren      
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small"> t / x </span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small"> t&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">M</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Tsub  

v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;v_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">                               </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> value   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> lambda  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">terminals</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;terminals_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">            </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> lambda  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">lambda </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> --&gt;          </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> red     </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">longrightarrow </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">subrules</span></span></span><span style="font-size:small">
  v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span></span><span style="font-size:small"> t

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defns</span></span></span><span style="font-size:small">
Jop </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">

 </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defn</span></span></span><span style="font-size:small">
 t1 --&gt; t2 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">reduce</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">&#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> $</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t1</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">$ reduces to $</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t2</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">$</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">by</span></span></span><span style="font-size:small">


</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------------------</span></span></span><span style="font-size:small">  :: ax_app
    (</span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">x.t12) v2 --&gt;  </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small">v2/x</span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small">t12

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_fun
    t1 t --&gt; t1&#X2019; t

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_arg
    v t1 --&gt; v t1&#X2019;
</span></pre><span style="font-size:small">

</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 2: Source: <span style="font-family:monospace">test10.2.ott</span><a id="a46"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><blockquote class="figure"><div class="center"><hr class="floatrule"></div>

<img src="top2001.png"><div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 3: Generated LaTeX: <span style="font-family:monospace">test10.2.tex</span><a id="a49"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><p>
The source file has three additions to the previous file. 
Firstly, the <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> declaration is annotated with a
specification of how metavariables should be translated to LaTeX:
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> termvar<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> x <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>   
    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>mathit<span style="font-family:monospace">{</span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>termvar<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="font-family:monospace">}</span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
Inside the <span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">tex</span></span><span style="font-family:monospace"> </span>&#X2026;<span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
is some LaTeX code
<span style="font-family:monospace">\</span><span style="font-family:monospace">mathit</span><span style="font-family:monospace">{</span><span style="font-family:monospace"><span style="color:#007FFF">$[[</span></span><span style="font-family:monospace">termvar</span><span style="font-family:monospace"><span style="color:#007FFF">]]$</span></span><span style="font-family:monospace">}</span> 
giving the translation of a <span style="font-family:monospace">termvar</span> or <span style="font-family:monospace">x</span>. Here they
are typeset in math italic (which in fact is also the default).
Within the translation, the metavariable itself can be mentioned
inside double square brackets <span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace"> </span>&#X2026;<span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span>.</p><p>Secondly, there is a grammar for a distinguished nonterminal root
<span style="color:#A51815"><span style="font-family:monospace">terminals</span></span>, with a 
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">tex</span></span><span style="font-family:monospace"> </span>&#X2026;<span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
translation for each, overriding the default typesetting of some
terminals. Note that the other terminals 
(<span style="font-family:monospace">.</span> <span style="font-family:monospace">(</span> <span style="font-family:monospace">)</span> <span style="font-family:monospace">{</span> <span style="font-family:monospace">}</span> <span style="font-family:monospace">/</span>)
are still given their default typesetting.
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">terminals</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;terminals_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span>            <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> lambda  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>lambda <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> --&gt;          <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> red     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>longrightarrow <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
Thirdly, the file has <span style="color:#A51815"><span style="font-family:monospace">com</span></span> comments, including
the 
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">com</span></span><span style="font-family:monospace"> term </span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
attached to a grammar rule, 
the 
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">com</span></span><span style="font-family:monospace"> variable</span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
attached to a production, and the
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">com</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">t1</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span><span style="font-family:monospace"> reduces to </span><span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">t2</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
attached to a semantic relation. These appear in the LaTeX output
as shown in Figure&#X2004;&#X200D;<a href="#a49">3</a>.</p>
<!--TOC subsection id="sec23" Specifying LaTeX for productions-->
<h3 id="sec23" class="subsection">4.1&#X2003;Specifying LaTeX for productions</h3><!--SEC END --><p>
One can also specify <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> translations for productions, overriding the default
LaTeX typesetting, e.g.&#X2004;&#X200D;as in this example of
a type abstraction production.
</p><pre>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  X &lt;: T . t   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> TLam   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>Lambda <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>X<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>&lt;:<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>T<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>. <span style="font-family:monospace">\</span>, <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
These <em>homomorphisms</em>, or <em>homs</em><sup><a id="text1" href="#note1">1</a></sup>, can refer to the metavariables and
nonterminals that occur in the production, e.g.&#X2004;&#X200D;the <span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">X</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span>,
<span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">T</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span>, and <span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">t</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span> in the <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> hom above,
interleaved with arbitrary strings and with typeset elements of the
<span style="color:#A51815"><span style="font-family:monospace">terminals</span></span> grammar, e.g.&#X2004;&#X200D;the <span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">&lt;:</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span>.</p><p>Homomorphisms are applied recursively down the structure of symbolic
terms. For example, an F<sub>&lt;:</sub> term
</p><pre class="verbatim">  (\X&lt;:T11.t12) [T2]
</pre><p>
would be LaTeX-pretty-printed, using the <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> clause above, as
</p><pre class="verbatim">( \, \Lambda  \mathit{X} &lt;: \mathit{T_{\mathrm{11}}} . \, \mathit{t_{\mathrm{12}}} \, )
 \, \, [ \, \mathit{T_{\mathrm{2}}} \, ]
</pre><p>
which is typeset as below.
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
<img src="top2002.png"></td></tr>
</table><p>
Note the <code class="verb">X</code>, <code class="verb">T11</code> and <code class="verb">t12</code> of the symbolic term are
used to instantiate the formal parameters <code class="verb">X</code>, <code class="verb">T</code> and
<code class="verb">t</code> of the homomorphism definition clause. 
If the <code class="verb">t</code> itself had compound term structure, e.g. as below
</p><pre class="verbatim">  (\X&lt;:T. \X'&lt;:T'.x)
</pre><p>
the homomorphism would be applied recursively, producing 
</p><pre class="verbatim">( \, \Lambda  \mathit{X} &lt;: \mathit{T} . \,  \Lambda  \mathit{X'} &lt;: \mathit{T'} 
. \,  \mathit{x} \,  \, )
</pre><p>
typeset as follows.
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
<img src="top2003.png"></td></tr>
</table><p>
Where there is no user-supplied homomorphism clause the LaTeX
pretty-printing defaults to a sequence of the individual items
separated by thin spaces (<code class="verb">\,</code>),
with reasonable default fonts and making use of the <code class="verb">terminals</code> grammar where appropriate.</p>
<!--TOC subsection id="sec24" Specifying LaTeX for grammar rules-->
<h3 id="sec24" class="subsection">4.2&#X2003;Specifying LaTeX for grammar rules</h3><!--SEC END --><p>
Grammar rules can include a <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> hom specifying how all the
nonterminal roots should be typeset, e.g.
</p><pre>
  type<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> t<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> s <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Typ_ <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>mathsf<span style="font-family:monospace">{</span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>type<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="font-family:monospace">}</span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
        <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> unit                  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> unit   
        <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> type * type&#X2019;          <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> pair   
        <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> type -&gt; type&#X2019;         <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> fun    
</pre><p>Alternatively, the individual nonterminal roots can have <span style="color:#A51815"><span style="font-family:monospace">tex</span></span>
homs specifying how they should be typeset:
</p><pre>
  G <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>Gamma <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">,</span></span> D <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>Delta <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;G_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> 
        <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> empty                 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> empty       
        <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> G , x : T             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> term        
</pre><p>
permitting the user to write <code class="verb">G'</code>, <code class="verb">D12</code> etc.&#X2004;&#X200D;in symbolic
terms, to be typeset as 

<img src="top2004.png">etc.</p>
<!--TOC subsection id="sec25" Using the LaTeX code-->
<h3 id="sec25" class="subsection">4.3&#X2003;Using the LaTeX code</h3><!--SEC END --><p><a id="a64"></a>The generated LaTeX code can be used in two main ways. 
By default, Ott generates a stand-alone LaTeX file, 
with a standard wrapper (including a <code class="verb">\documentclass</code>, various
macro definitions, and a main body),
that gives the complete system definition.</p><p>The default header can be overridden by writing
<code class="verb"> embed {{ tex-wrap-pre ... }} </code> and the default footer by
writing <code class="verb">embed {{ tex-wrap-post ... }} </code>. Alternatively, the
program option <code class="verb">-tex_wrap false</code> with the <code class="verb">-tex_wrap false</code>
command-line argument, one can generate a file that can be included in
other LaTeX files, that just defines macros to typeset various
parts of the system (<code class="verb">-tex_wrap false</code> overrides any
<code class="verb">tex-wrap-pre/tex-wrap-post</code> embeds).</p><p>The generated LaTeX output is factored into individual LaTeX
commands: for the metavariable declarations, each rule of the syntax
definition, the collected syntax (<code class="verb">\ottgrammar</code>), each rule of the inductive relation
definitions, the collected rules for each relation, the collected
rules for each <code class="verb">defns</code> block, the union of those
(<code class="verb">\ottdefns</code>) and the whole (<code class="verb">\ottall</code>). 
This makes it possible to quote individual parts of the definition,
possibly out-of-order, in a paper or technical report. </p><p>If one needs to include more than one system in a single LaTeX
document, the <code class="verb">ott</code> prefix can be replaced using the
<code class="verb">-tex_name_prefix</code> command-line argument. </p><p>The generated LaTeX is factored through some common style macros, 
e.g.&#X2004;&#X200D;to typeset a comment, a production, and a grammar. If necessary
these can be redefined in an <span style="color:#A51815"><span style="font-family:monospace">embed</span></span> block (see Section&#X2004;&#X200D;<a href="#a60">8.1</a>). 
For example, the file <code class="verb">tests/squishtex.ott</code>
</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">embed</span></span> 
 <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> tex-preamble
<span style="font-family:monospace">\</span>renewcommand<span style="font-family:monospace">{</span><span style="font-family:monospace">\</span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">TEX_NAME_PREFIX</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>grammartabular<span style="font-family:monospace">}</span>[1]
  <span style="font-family:monospace">{</span><span style="font-family:monospace">\</span>begin<span style="font-family:monospace">{</span>minipage<span style="font-family:monospace">}</span><span style="font-family:monospace">{</span><span style="font-family:monospace">\</span>columnwidth<span style="font-family:monospace">}</span><span style="font-family:monospace">\</span>begin<span style="font-family:monospace">{</span>tabular<span style="font-family:monospace">}</span><span style="font-family:monospace">{</span>ll<span style="font-family:monospace">}</span>#1<span style="font-family:monospace">\</span>end<span style="font-family:monospace">{</span>tabular<span style="font-family:monospace">}</span><span style="font-family:monospace">\</span>end<span style="font-family:monospace">{</span>minipage<span style="font-family:monospace">}</span> <span style="font-family:monospace">}</span>
<span style="font-family:monospace">\</span>renewcommand<span style="font-family:monospace">{</span><span style="font-family:monospace">\</span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">TEX_NAME_PREFIX</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>rulehead<span style="font-family:monospace">}</span>[3]
  <span style="font-family:monospace">{</span>$#1$  $#2$ &amp; $#3$<span style="font-family:monospace">}</span>
<span style="font-family:monospace">\</span>renewcommand<span style="font-family:monospace">{</span><span style="font-family:monospace">\</span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">TEX_NAME_PREFIX</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>prodline<span style="font-family:monospace">}</span>[6]
  <span style="font-family:monospace">{</span> <span style="font-family:monospace">\</span>quad $#1$ <span style="font-family:monospace">\</span> $#2$ &amp; <span style="font-family:monospace">\</span>quad $#3 #4$  $#5$  $#6$<span style="font-family:monospace">}</span>
<span style="font-family:monospace">\</span>renewcommand<span style="font-family:monospace">{</span><span style="font-family:monospace">\</span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">TEX_NAME_PREFIX</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>interrule<span style="font-family:monospace">}</span>
  <span style="font-family:monospace">{</span><span style="font-family:monospace">\</span><span style="font-family:monospace">\</span>[2.0mm]<span style="font-family:monospace">}</span>
 <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>

defines a more compact style for grammars. Note that the
<span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace"><span style="color:#A51815">TEX_NAME_PREFIX</span></span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span> is replaced by whatever prefix is in force,
so such style files can be reused in different contexts.</p><p>A more sophisticated LaTeX package <code class="verb">ottlayout.sty</code>, providing fine control of how
inference rules and grammars should be typeset, is contained in the
<code class="verb">tex</code> directory of the distribution. It is described in the
manual therein.</p>
<!--TOC section id="sec26" Generating proof assistant definitions-->
<h2 id="sec26" class="section">5&#X2003;Generating proof assistant definitions</h2><!--SEC END --><p><a id="a52"></a>To generate proof assistant definitions, for Coq, Isabelle, and HOL,
the minimal Ott source file of Section&#X2004;&#X200D;<a href="#a51">3</a>/Figure&#X2004;&#X200D;<a href="#a45">1</a> must
be extended with a modest amount of additional data, as shown in Figure&#X2004;&#X200D;<a href="#a47">4</a>.
Executing 
</p><pre>
   bin/ott  -i tests/test10.4.ott  -o out.v  -o out.thy  -o outScript.sml 
</pre><p>
generates Coq <span style="font-family:monospace">out.v</span>, Isabelle <span style="font-family:monospace">out.thy</span>, and HOL
<span style="font-family:monospace">outScript.sml</span>, shown in Figures&#X2004;&#X200D;<a href="#a6">5</a>, <a href="#a5">6</a>, and <a href="#a40">7</a>.
The additional data can be combined with the annotations for
LaTeX of the previous section, but those are omitted here. 
</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre><span style="font-size:small">
% minimal                    + binding + subst + coq/hol/isa
</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">metavar</span></span></span><span style="font-size:small"> termvar</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">,</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">  
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">isa</span></span></span><span style="font-size:small"> string</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">coq</span></span></span><span style="font-size:small"> nat</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">hol</span></span></span><span style="font-size:small"> string</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">grammar</span></span></span><span style="font-size:small">
t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;t_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">                               
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> x            </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Var                  
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam     </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(+</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">bind</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">in</span></span></span><span style="font-size:small"> t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">+)</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> t t&#X2019;         </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> App                  
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> ( t )        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">S</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Paren   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">icho</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> 
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small"> t / x </span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small"> t&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">M</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Tsub    </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">icho</span></span></span><span style="font-size:small"> (tsubst_t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">x</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t&#X2019;</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">)</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;v_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">                              
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam                

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">subrules</span></span></span><span style="font-size:small">
  v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span></span><span style="font-size:small"> t

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">substitutions</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">single</span></span></span><span style="font-size:small"> t x </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> tsubst 

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defns</span></span></span><span style="font-size:small">
Jop </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">

 </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defn</span></span></span><span style="font-size:small">
 t1 --&gt; t2 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">reduce</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">&#X201D;  </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">by</span></span></span><span style="font-size:small">


</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------------------</span></span></span><span style="font-size:small">  :: ax_app
    (</span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">x.t12) v2 --&gt;  </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small">v2/x</span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small">t12

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_fun
    t1 t --&gt; t1&#X2019; t

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_arg
    v t1 --&gt; v t1&#X2019;
</span></pre><span style="font-size:small">

</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 4: Source: <span style="font-family:monospace">test10.4.ott</span><a id="a47"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><p>
We add four things.
First, we specify proof assistant types to represent object-language
variables &#X2014; in this example, choosing the <span style="font-family:monospace">string</span> type of
Isabelle and HOL, and the <span style="font-family:monospace">nat</span> type for Coq:
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> termvar<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> x <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>  
  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> string<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> nat<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> string<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
For Coq output, one can specify <code class="verb">{{ coq-equality</code> <span style="font-style:italic">proof-script</span> <code class="verb">}}</code>
to build a decidable equality over the Coq representation type using
the proof <span style="font-style:italic">proof-script</span>. If the script is omitted, as in this
example, it defaults
to 
</p><pre class="verbatim">Proof.
  decide equality; auto with ott_coq_equality arith.
Defined.
</pre><p>
where the <code class="verb">ott_coq_equality</code> database contains the decidable
equalities of the representation types defined in the source. It is
possible to suppress type generation for specific metavariables or nonterminals, by adding the
declaration <code class="verb">{{ phantom }}</code>. This is useful in some cases, for
instance to avoid duplicate definitions of types already defined in an
imported library. Any type homs are taken into account when
the metavariable or nonterminal root is output as a type.</p><p>Second, we specify what the binding is in the object language, with
the <span style="font-family:monospace"><span style="color:#007FFF">(+</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">bind</span></span><span style="font-family:monospace"> x </span><span style="font-family:monospace"><span style="color:#A51815">in</span></span><span style="font-family:monospace"> t </span><span style="font-family:monospace"><span style="color:#007FFF">+)</span></span>
annotation on the <span style="font-family:monospace">Lam</span> production:
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam     <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> x <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span>
</pre><p>
Section&#X2004;&#X200D;<a href="#a62">9</a> describes the full language of binding specifications.</p><p>Third, we add a block
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">substitutions</span></span>
    <span style="color:#A51815"><span style="font-family:monospace">single</span></span> t x <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsubst 
</pre><p>
to cause Ott to generate Coq/Isabelle/HOL definitions of a substitution
function, with name root <span style="font-family:monospace">tsubst</span>, replacing metavariables <span style="font-family:monospace">x</span> by terms <span style="font-family:monospace">t</span>. This is for single
substitutions; multiple substitution functions (taking lists of
substitutand/substitutee pairs) can also be generated with the keyword
<span style="color:#A51815"><span style="font-family:monospace">multiple</span></span>. 
Substitution functions are generated for all rules of the grammar for
which they might be required &#X2014; here, just over <code class="verb">t</code>, with a
function named <code class="verb">tsubst_t</code>.</p><p>Finally, we specify translations for the metaproductions:
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( t )        <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">S</span></span><span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Paren   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> t / x <span style="font-family:monospace">}</span> t&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span><span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Tsub    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> (tsubst_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>)<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
These specify that <span style="font-family:monospace">(t)</span> should be translated into just the
translation of <span style="font-family:monospace">t</span>, whereas 
<span style="font-family:monospace">{</span><span style="font-family:monospace">t/x</span><span style="font-family:monospace">}</span><span style="font-family:monospace">t&#X2019;</span> should be translated into the
proof-assistant application of <span style="font-family:monospace">tsubst_t</span> to the translations
of <span style="font-family:monospace">t</span>, <span style="font-family:monospace">x</span>, and <span style="font-family:monospace">t&#X2019;</span>.
The (admittedly terse) <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> specifies that these translations should be
done uniformly for Isabelle, Coq, HOL, and OCaml output. One can also
specify just one of these, writing
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">coq</span></span><span style="font-family:monospace"> </span>&#X2026;<span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>, 
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">hol</span></span><span style="font-family:monospace"> </span>&#X2026;<span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>, 
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">isa</span></span><span style="font-family:monospace"> </span>&#X2026;<span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>, or 
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">ocaml</span></span><span style="font-family:monospace"> </span>&#X2026;<span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>,
or include several, with different translations for each.
There are also abbreviated forms <span style="color:#A51815"><span style="font-family:monospace">ich</span></span>, <span style="color:#A51815"><span style="font-family:monospace">ic</span></span>, <span style="color:#A51815"><span style="font-family:monospace">ch</span></span>, and <span style="color:#A51815"><span style="font-family:monospace">ih</span></span>.
The body of a proof assistant hom should normally include outer
parentheses, as in the <span style="font-family:monospace">Tsub</span> hom above, so that it is
parsed correctly by the proof assistant in all contexts.</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre class="verbatim"><span style="font-size:small">(* generated by Ott 0.33 from: ../tests/test10.ott ../tests/non_super_tabular.ott *)

Require Import Arith.
Require Import Bool.
Require Import List.
Require Import Ott.ott_list_core.


Definition var : Set := nat. (*r term variable *)
Lemma eq_var: forall (x y : var), {x = y} + {x &lt;&gt; y}.
Proof.
  decide equality; auto with ott_coq_equality arith.
Defined.
Hint Resolve eq_var : ott_coq_equality.

Inductive term : Set :=  (*r term *)
 | t_var (x:var) (*r variable *)
 | t_lam (x:var) (t:term) (*r lambda *)
 | t_app (t:term) (t':term) (*r app *).

(** subrules *)
Definition is_val_of_term (t5:term) : bool :=
  match t5 with
  | (t_var x) =&gt; false
  | (t_lam x t) =&gt; (true)
  | (t_app t t') =&gt; false
end.

(** library functions *)
Fixpoint list_mem A (eq:forall a b:A,{a=b}+{a&lt;&gt;b}) (x:A) (l:list A) {struct l} : bool :=
  match l with
  | nil =&gt; false
  | cons h t =&gt; if eq h x then true else list_mem A eq x t
end.
Arguments list_mem [A] _ _ _.


(** substitutions *)
Fixpoint tsubst_term (t5:term) (x5:var) (t_6:term) {struct t_6} : term :=
  match t_6 with
  | (t_var x) =&gt; (if eq_var x x5 then t5 else (t_var x))
  | (t_lam x t) =&gt; t_lam x (if list_mem eq_var x5 (cons x nil) then t else (tsubst_term t5 x5 t))
  | (t_app t t') =&gt; t_app (tsubst_term t5 x5 t) (tsubst_term t5 x5 t')
end.

(** definitions *)

(* defns Jop *)
Inductive reduce : term -&gt; term -&gt; Prop :=    (* defn reduce *)
 | ax_app : forall (x:var) (t1 v2:term),
     Is_true (is_val_of_term v2) -&gt;
     reduce (t_app  (t_lam x t1)  v2)  (tsubst_term  v2   x   t1 ) 
 | ctx_app_fun : forall (t1 t t1':term),
     reduce t1 t1' -&gt;
     reduce (t_app t1 t) (t_app t1' t)
 | ctx_app_arg : forall (v t1 t1':term),
     Is_true (is_val_of_term v) -&gt;
     reduce t1 t1' -&gt;
     reduce (t_app v t1) (t_app v t1').


</span></pre><span style="font-size:small">
</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 5: Generated Coq:<span style="font-family:monospace">test10.v</span><a id="a6"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre class="verbatim"><span style="font-size:small">(* generated by Ott 0.33 from: ../tests/test10.ott ../tests/non_super_tabular.ott *)
theory test10
imports Main
begin

type_synonym "var" = "string" \&lt;comment&gt; \&lt;open&gt;term variable\&lt;close&gt;
datatype "term" =  \&lt;comment&gt; \&lt;open&gt;term\&lt;close&gt;
   t_var "var"   \&lt;comment&gt; \&lt;open&gt;variable\&lt;close&gt;
 | t_lam "var" "term"   \&lt;comment&gt; \&lt;open&gt;lambda\&lt;close&gt;
 | t_app "term" "term"   \&lt;comment&gt; \&lt;open&gt;app\&lt;close&gt;


(** subrules *)
primrec
is_val_of_term :: "term =&gt; bool"
where
"is_val_of_term (t_var x) = (False)"
| "is_val_of_term (t_lam x t) = ((True))"
| "is_val_of_term (t_app t t') = (False)"


(** substitutions *)
primrec
tsubst_term :: "term =&gt; var =&gt; term =&gt; term"
where
"tsubst_term t5 x5 (t_var x) = ((if x=x5 then t5 else (t_var x)))"
| "tsubst_term t5 x5 (t_lam x t) = (t_lam x (if x5 : set [x] then t else (tsubst_term t5 x5 t)))"
| "tsubst_term t5 x5 (t_app t t') = (t_app (tsubst_term t5 x5 t) (tsubst_term t5 x5 t'))"

(** definitions *)
(* defns Jop *)
inductive reduce :: "term \&lt;Rightarrow&gt; term \&lt;Rightarrow&gt; bool"
where
(* defn reduce *)

ax_appI: "\&lt;lbrakk&gt;is_val_of_term v2\&lt;rbrakk&gt; \&lt;Longrightarrow&gt;
reduce ((t_app  (t_lam x t1)  v2)) ( (tsubst_term  v2   x   t1 ) )"

| ctx_app_funI: "\&lt;lbrakk&gt;reduce (t1) (t1')\&lt;rbrakk&gt; \&lt;Longrightarrow&gt;
reduce ((t_app t1 t)) ((t_app t1' t))"

| ctx_app_argI: "\&lt;lbrakk&gt;is_val_of_term v ;
reduce (t1) (t1')\&lt;rbrakk&gt; \&lt;Longrightarrow&gt;
reduce ((t_app v t1)) ((t_app v t1'))"

end



</span></pre><span style="font-size:small">
</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 6: Generated Isabelle:<span style="font-family:monospace">test10.thy</span><a id="a5"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre class="verbatim"><span style="font-size:small">(* generated by Ott 0.33 from: ../tests/test10.ott ../tests/non_super_tabular.ott *)
(* to compile: Holmake test10Theory.uo   *)
(* for interactive use:
  app load ["pred_setTheory","finite_mapTheory","stringTheory","containerTheory","ottLib"];
*)

open HolKernel boolLib Parse bossLib ottLib;
infix THEN THENC |-&gt; ## ;
local open arithmeticTheory stringTheory containerTheory pred_setTheory listTheory 
  finite_mapTheory in end;

val _ = new_theory "test10";


val _ = type_abbrev("var", ``:string``); (* term variable *)
val _ = Hol_datatype ` 
term =  (* term *)
   t_var of var (* variable *)
 | t_lam of var =&gt; term (* lambda *)
 | t_app of term =&gt; term (* app *)
`;

(** subrules *)
val _ = ottDefine "is_val_of_term" `
    ( is_val_of_term (t_var x) = F)
/\  ( is_val_of_term (t_lam x t) = (T))
/\  ( is_val_of_term (t_app t t') = F)
`;

(** substitutions *)
val _ = ottDefine "tsubst_term" `
    ( tsubst_term t5 x5 (t_var x) = (if x=x5 then t5 else (t_var x)))
/\  ( tsubst_term t5 x5 (t_lam x t) = t_lam x (if MEM x5 [x] then t else (tsubst_term t5 x5 t)))
/\  ( tsubst_term t5 x5 (t_app t t') = t_app (tsubst_term t5 x5 t) (tsubst_term t5 x5 t'))
`;
(** definitions *)
(* defns Jop *)

val (Jop_rules, Jop_ind, Jop_cases) = Hol_reln`
(* defn reduce *)

( (* ax_app *) ! (x:var) (t1:term) (v2:term) . (clause_name "ax_app") /\
((is_val_of_term v2))
 ==&gt; 
( ( reduce (t_app  (t_lam x t1)  v2)  (tsubst_term  v2   x   t1 )  )))

/\ ( (* ctx_app_fun *) ! (t1:term) (t:term) (t1':term) . (clause_name "ctx_app_fun") /\
(( ( reduce t1 t1' )))
 ==&gt; 
( ( reduce (t_app t1 t) (t_app t1' t) )))

/\ ( (* ctx_app_arg *) ! (v:term) (t1:term) (t1':term) . (clause_name "ctx_app_arg") /\
((is_val_of_term v) /\
( ( reduce t1 t1' )))
 ==&gt; 
( ( reduce (t_app v t1) (t_app v t1') )))

`;

val _ = export_theory ();



</span></pre><span style="font-size:small">
</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 7: Generated HOL:<span style="font-family:monospace">test10Script.sml</span><a id="a40"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote>
<!--TOC subsection id="sec27" Proof assistant code for grammar rules-->
<h3 id="sec27" class="subsection">5.1&#X2003;Proof assistant code for grammar rules</h3><!--SEC END --><p>
The normal behaviour is to generate a free proof assistant type for
each (non-subrule, non-phantom) grammar rule. 
For example, the Coq compilation for <span style="font-family:monospace">t</span> here generates a free type with three
constructors:
</p><pre class="verbatim">  Inductive term : Set := 
   | t_var (x:var)
   | t_lam (x:var) (t:term)
   | t_app (t:term) (t':term).
</pre><p>
(note that the metaproductions do not give rise to constructors). </p><p>Remark: prior to version 0.20.2, the free type generated for Coq was 
</p><pre class="verbatim">  Inductive term : Set := 
   | t_var : var -&gt; term
   | t_lam : var -&gt; term -&gt; term
   | t_app : term -&gt; term -&gt; term.
</pre><p>
but we found that trying to preserve the names specified by the user
is helpful later, when doing proofs. Whenever a clash is detected, or
for list forms, the wildcard <span style="font-family:monospace">_</span> is used. The old behaviour
can be obtained via the top-level option
<span style="font-family:monospace">-coq_names_in_rules false</span>.</p><p>By default the order of the arguments to those constructors follows
the order in which they appear in the production. That can be
overridden with an <span style="font-family:monospace">order</span> hom. For example, if for some
reason (perhaps compatibility with other Coq code) one wished the
arguments to <code class="verb">t_Lam</code> to be reversed:
</p><pre class="verbatim">   | t_Lam : t -&gt; termvar -&gt; t
</pre><p>
one could add an <span style="color:#A51815"><span style="font-family:monospace">order</span></span> hom as below.
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">order</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>Instead of using the generated free type, one can specify an arbitrary proof assistant representation type,
annotating the grammar rule with a <span style="color:#A51815"><span style="font-family:monospace">coq</span></span>, <span style="color:#A51815"><span style="font-family:monospace">isa</span></span>, <span style="color:#A51815"><span style="font-family:monospace">hol</span></span>, or <span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span> hom &#X2014;
for example, in the following grammar for substitutions.
</p><pre>
  s <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>sigma <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;S_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> multiple subst <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> (termvar*t) list <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
       <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> [ x |-&gt; t ]            <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> singleton   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> [ (<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>,<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>) ]  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
       <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> s1 , <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , sn           <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> list        <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> List.concat <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>s1 <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> sn<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
Here the <span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">isa</span></span><span style="font-family:monospace"> (termvar*t) list </span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span> hom specifies that in
Isabelle output this type be represented as an Isabelle
<code class="verb">(termvar*t) list</code> instead of the default free inductive type;
all the productions are metaproductions (tagged <span style="color:#A51815"><span style="font-family:monospace">M</span></span>); and <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> homs for each production specify how they should be translated into that Isabelle type.
This feature must be used with care, as any Ott-generated functions, e.g.&#X2004;&#X200D;substitution functions, cannot recurse through such user-defined types. </p><p>Grammar rules (whether free or non-free) can also include a <span style="color:#A51815"><span style="font-family:monospace">coq equality</span></span> hom, instructing
the Coq code generator to derive a decidable equality for the Coq
representation type. For example, the ML polymorphism Ott source of
<span style="font-family:monospace">test8.ott</span> includes the following.
</p><pre>
  typvar <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> TV_ <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span> decide equality. apply eq_value_name_t. <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
       <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> &#X2019; ident                <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> ident
</pre><p>The Coq/HOL/Isabelle/OCaml type name for a grammar rule, or for a
metavariable declaration, is normally
taken to be just its primary nonterminal root. 
Occasionally it is useful to work around a clash between a
metavar or nonterminal primary root and a proof assistant symbol,
e.g.&#X2004;&#X200D;<span style="font-family:monospace">T</span> in HOL or <span style="font-family:monospace">value</span> in Isabelle. 
For this, one can add a <span style="color:#A51815"><span style="font-family:monospace">coq</span></span>, <span style="color:#A51815"><span style="font-family:monospace">hol</span></span>, <span style="color:#A51815"><span style="font-family:monospace">isa</span></span>, or
<span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span> hom to the primary nonterminal root. In the example
below, the user can write <span style="font-family:monospace">T</span>, <span style="font-family:monospace">T&#X2019;</span> etc. in their Ott
source, but the generated HOL type is <span style="font-family:monospace">Typ</span>.
</p><pre>
T <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> Typ <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">,</span></span> S<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> U <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;T_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> type  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> T -&gt; T&#X2019;                          <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Fun          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> type of functions <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>The grammar rules within each <span style="color:#A51815"><span style="font-family:monospace">grammar</span></span> block of a syntax definition may depend on each other arbitrarily.
When generating Isabelle/Coq/HOL/OCaml representation types, however, they are
topologically sorted, to simplify the resulting induction
principles.</p>
<!--TOC subsection id="sec28" Proof assistant code for inductive definitions-->
<h3 id="sec28" class="subsection">5.2&#X2003;Proof assistant code for inductive definitions</h3><!--SEC END --><p>
The semantic relations are defined
with the proof-assistant inductive relations packages, 
<code class="verb">Inductive</code>, <code class="verb">Hol_reln</code>, and <code class="verb">inductive_set</code> or <code class="verb">inductive</code>, respectively.
Each <span style="color:#A51815"><span style="font-family:monospace">defns</span></span> block gives rise to a potentially mutually
recursive definition of each <span style="color:#A51815"><span style="font-family:monospace">defn</span></span> inside it
(it seems clearer not to do a topological sort here).
Definition rules are expressed internally with symbolic terms. 
We give a simplified grammar thereof in Fig.&#X2004;&#X200D;<a href="#a19">17</a>, omitting the
symbolic terms for list forms. 
A symbolic term <span style="font-style:italic">st</span> for a nonterminal root is either an explicit nonterminal or a
node, the latter labelled with a production name and containing a list of
<span style="font-style:italic">symterm</span><span style="font-style:italic">_</span><span style="font-style:italic">element</span>s, which in turn are either symbolic terms,
metavariables, or variables.
Each definition rule 
gives rise to an implicational clause, essentially
that the premises (Ott symbolic terms of the <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> grammar)
imply the conclusion (an Ott symbolic term of whichever judgement is
being defined). 
Symbolic terms are compiled in several different ways:
</p><ul class="itemize"><li class="li-itemize">
Nodes of non-meta productions are output as applications of the appropriate proof-assistant constructor (and, for a subrule, promoted to the corresponding constructor of a maximal rule).
</li><li class="li-itemize">Nodes of meta productions are transformed with the user-specified homomorphism.
</li><li class="li-itemize">Nodes of judgement forms are represented as applications of the defined relation in Coq and HOL, and as set-membership assertions in Isabelle.
</li><li class="li-itemize">Lists of formulae (the <code class="verb">formula_dots</code> production, c.f.&#XA7;<a href="#a61">12</a>) are
special-cased to proof-assistant conjunctions.
</li></ul><p>
Further, for each nonterminal of a non-free grammar rule,
e.g.&#X2004;&#X200D;a usage of <code class="verb">v'</code> where <code class="verb">v&lt;::t</code>, an additional premise
invoking the generated subrule predicate for the non-free rule is added, e.g.&#X2004;&#X200D;<code class="verb">is_v v'</code>.
For Coq and HOL, explicit quantifiers are introduced for all variables
mentioned in the rule.
For HOL, rules are tagged with their rule name (using <code class="verb">clause_name</code>).</p>
<!--TOC subsection id="sec29" Representation of binding-->
<h3 id="sec29" class="subsection">5.3&#X2003;Representation of binding</h3><!--SEC END --><p>
At present the generated Isabelle/Coq/HOL uses fully concrete
representations of variables in terms, without any notion of alpha
equivalence, as one can see in Fig.&#X2004;&#X200D;<a href="#a5">6</a>:
see the <code class="verb">t</code> datatype of terms and the <code class="verb">tsubst_t</code>
substitution function there. 
An experimental Coq backend generates definitions in locally-nameless style for a subset of the Ott metalanguage. This is work-in-progress, and it is extensively documented in <a href="http://moscova.inria.fr/~zappa/projects/ln_ott/"><span style="font-family:monospace">http://moscova.inria.fr/~zappa/projects/ln_ott/</span></a>.
We intend in future to generate other representations, and in some
circumstances homs can be used to implement other representations directly.
For a reasonably wide variety of
languages, however, one can capture the intended semantics of whole programs in
this idiom, subject only to the condition that standard library
identifiers are not shadowed within the program, as the operational
semantics does not involve reduction under binders &#X2014; so any
substitutions are of terms which (except for standard library
identifiers) are closed. This includes the ML polymorphism example of
<span style="font-family:monospace">test8.ott</span>. For languages which require a type
environment with internal dependencies, however, for example F<sub>&lt;:</sub>, this is
no longer the case. The POPLmark F<sub>&lt;:</sub> example given in <span style="font-family:monospace">test7.ott</span>
has a type system which disallows all shadowing, a property that is
not preserved by reduction. However, a correct translation of F<sub>&lt;:</sub> is generated by the Coq locally-nameless backend, and can be found in <a href="http://moscova.inria.fr/~zappa/projects/ln_ott/"><span style="font-family:monospace">http://moscova.inria.fr/~zappa/projects/ln_ott/</span></a>.</p><p>Further discussion of binding representations is in the Ott ICFP 2007
paper and in a working draft 
</p><blockquote class="quotation">Binding and Substitition. Susmit Sarkar, Peter Sewell, and Francesco
Zappa Nardelli. August 2007.
</blockquote><p>
available from the Ott web page.</p>
<!--TOC subsection id="sec30" Helper functions for free variable and substitution functions-->
<h3 id="sec30" class="subsection">5.4&#X2003;Helper functions for free variable and substitution functions</h3><!--SEC END --><p>The generated free variable and substitution functions in the Coq output 
(e.g., in Figure&#X2004;&#X200D;<a href="#a6">5</a>) often rely on a few standard library functions: 
<code class="verb">list_mem</code>, <code class="verb">list_assoc</code>, <code class="verb">list_minus</code>, <code class="verb">list_minus2</code>.
In order to avoid dependencies on external libraries for defining those
functions, by default Ott generates the definitions for any such functions it
uses. It is possible to turn off the generation of definitions for 
these such functions by writing the following directive early on in the source file: </p><pre>
<span style="color:#A51815"><span style="font-family:monospace">embed</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq-lib</span></span> list_mem list_minus <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>This instructs Ott to avoid generating definition for <code class="verb">list_mem</code> and
<code class="verb">list_minus</code>, but to continue generating definitions for other functions
such as <code class="verb">list_assoc</code> and <code class="verb">list_minus2</code>.</p><p><span style="font-weight:bold">Note about </span><code class="verb">list_minus2</code><span style="font-weight:bold">:</span> 
Instead of using the function <code class="verb">list_minus2</code>, earlier versions of Ott
generated equivalent code based on <code class="verb">list_filter</code>, which was more
difficult to reason about. For backwards compatibility, however, we provide the
command-line option <code class="verb">-coq_use_filter_fn</code> for generating a definition using
the older code pattern.</p>
<!--TOC subsection id="sec31" Correctness of the generated proof assistant code-->
<h3 id="sec31" class="subsection">5.5&#X2003;Correctness of the generated proof assistant code</h3><!--SEC END --><p>
We have attempted to ensure that the proof assistant definitions
generated by Ott are well-formed and what the user would intend. This
is not guaranteed, however, for several reasons: (1) There may be name
clashes between Ott-generated identifiers and proof assistant built-in
identifiers (or, in pathological cases, even among different
Ott-generated identifiers). (2) In some cases we depend on automatic
proof procedures, e.g.&#X2004;&#X200D;for HOL definitions. These work in our test
cases, but it is hard to ensure that they will in all cases. More
importantly, (3) the generation process is complex, so it is quite
possible that there is either a bug in Ott or a mismatch between the
user expectation and what the tool actually does. Ultimately one has
to read the generated proof assistant definitions to check that they
are as intended &#X2014; but typically one would do this in any case, many
times over, in the process of proving metatheoretic results, so we do
not consider it a major issue.</p>
<!--TOC subsection id="sec32" Using the generated proof assistant code-->
<h3 id="sec32" class="subsection">5.6&#X2003;Using the generated proof assistant code</h3><!--SEC END --><p>
Note added 2017-11-30: the following is out of date. </p><p>Ott builds code for </p><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >Coq 8.3</td><td style="text-align:left;white-space:nowrap" ><a href="http://coq.inria.fr/"><span style="font-family:monospace">http://coq.inria.fr/</span></a> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >HOL 4 (the current svn version)</td><td style="text-align:left;white-space:nowrap" ><a href="http://hol.sourceforge.net/"><span style="font-family:monospace">http://hol.sourceforge.net/</span></a></td></tr>
<tr><td style="text-align:left;white-space:nowrap" >Isabelle/HOL (Isabelle 2011)</td><td style="text-align:left;white-space:nowrap" ><a href="http://isabelle.in.tum.de/"><span style="font-family:monospace">http://isabelle.in.tum.de/</span></a>
</td></tr>
</table><p>Given proof assistant files in the top-level directory of the
distribution, as produced at the start of this section
(Coq <span style="font-family:monospace">out.v</span>, Isabelle <span style="font-family:monospace">out.thy</span>, and HOL
<span style="font-family:monospace">outScript.sml</span>), the various proof assistants can be invoked as follows.</p>
<!--TOC subsubsection id="sec33" Coq-->
<h4 id="sec33" class="subsubsection">5.6.1&#X2003;Coq</h4><!--SEC END --><p>
First run 
</p><pre class="verbatim">  make
</pre><p>
in the <span style="font-family:monospace">coq</span> directory of the distribution, to build the auxiliary files.
These include a core file (<code class="verb">ott_list_core</code>) of definitions that
are used in Ott-generated output. 
At present these are only required when Coq native lists are used. 
There are also various lemmas (in
<code class="verb">ott_list.v</code>) which may be useful; they can be made available with
<code class="verb">Require Import ott_list.</code> </p><p>For batch mode run
</p><pre class="verbatim">  coqc -I coq  out.v
</pre><p>
where <code class="verb">coq</code> is the path to the <code class="verb">coq</code> directory of the distribution.</p><p>The experimental locally-nameless backend requires the <code class="verb">Metatheory</code> library by Arthur Chargueraud, available from the project web page.</p>
<!--TOC subsubsection id="sec34" HOL-->
<h4 id="sec34" class="subsubsection">5.6.2&#X2003;HOL</h4><!--SEC END --><p>
First run 
</p><pre class="verbatim">  Holmake
</pre><p>
in the <span style="font-family:monospace">hol</span> directory of the distribution, to build the auxiliary files.</p><p>For
batch mode run
</p><pre class="verbatim">  Holmake -I hol  outTheory.uo
</pre><p>
where <code class="verb">hol</code> is the path to the <code class="verb">hol</code> directory of the distribution.
For interactive mode, run 
</p><pre class="verbatim">  hol -I hol
</pre><p>
inside an editor window (where the second <code class="verb">hol</code> is again the path
to the <code class="verb">hol</code> directory of the distribution), and in
another window view the <code class="verb">outScript.sml</code> file. First
paste in the <code class="verb">app load</code> command from a comment at the top of the
file, then paste in the remainder.</p>
<!--TOC subsubsection id="sec35" Isabelle-->
<h4 id="sec35" class="subsubsection">5.6.3&#X2003;Isabelle</h4><!--SEC END --><p>
For batch mode:
</p><pre class="verbatim">  echo 'ML_command {* (use_thy "Tmp"; OS.Process.exit OS.Process.success) handle e =&gt; (OS.Process.exit OS.Process.failure); *}' | /usr/local/Isabelle/bin/isabelle tty 
</pre><p>
Interactively, using Proof General:
</p><pre class="verbatim">  isabelle emacs out.thy
</pre>
<!--TOC section id="sec36" Judgments and formulae-->
<h2 id="sec36" class="section">6&#X2003;Judgments and formulae</h2><!--SEC END --><p><a id="a53"></a>In a semantic rule, for example
</p><pre>
    t1 --&gt; t1&#X2019;
<span style="color:#007FFF"><span style="font-family:monospace">    -------------- ::</span></span> ctx_app_arg
    v t1 --&gt; v t1&#X2019;
</pre><p>
the conclusion must be a symbolic term of the form of the judgement being
defined, but in general the premises may be symbolic terms
of a <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> grammar or in-line embedded prover code.
By default the formula grammar includes all the defined judgement forms: for the
running example Ott will synthesise grammars as below.</p><p><img src="top2005.png"></p><p>The user can also define an explicit formula grammar, to let other
forms (not just judgements) appear as rule premises. Below is a
fragment of the formula grammar from the LJ example on the Ott web page.
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> formula_ <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>  
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  judgement                       <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> judgement
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  formula1 <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> formulan            <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> dots
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  not <span style="color:#A51815"><span style="font-family:monospace">formula</span></span>                     <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> not
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>neg <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> <span style="font-family:monospace">\</span>&lt;not&gt; (<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>) <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  ( <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> )                     <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> brackets
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> (<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="font-family:monospace">\</span>!) <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>  
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> <span style="font-family:monospace">\</span>/ <span style="color:#A51815"><span style="font-family:monospace">formula</span></span>&#X2019;             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> or
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="font-family:monospace">\</span>vee <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span>&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="font-family:monospace">\</span>&lt;or&gt; <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span>&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> /<span style="font-family:monospace">\</span> <span style="color:#A51815"><span style="font-family:monospace">formula</span></span>&#X2019;             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> and
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="font-family:monospace">\</span>wedge <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span>&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="font-family:monospace">\</span>&lt;and&gt; <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span><span style="color:#A51815"><span style="font-family:monospace">formula</span></span>&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  x = x&#X2019;                          <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> xali
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> = <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  X = X&#X2019;                          <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Xali
          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>X<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> = <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>X&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
This example adds (to the judgement forms) syntax for parenthesised
formulae, negation, and, or, and equality testing on two sorts. For
each, <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> and <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> homs specify how they should be
typeset and be translated into Isabelle.</p><p>If the user defines a <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> grammar then (as here) the production
name prefix must be <span style="font-family:monospace">formula_</span> and the name for the
<span style="font-family:monospace">judgement</span> production must be <span style="font-family:monospace">judgement</span>.</p>
<!--TOC subsection id="sec37" Naming of premises for the Coq backend-->
<h3 id="sec37" class="subsection">6.1&#X2003;Naming of premises for the Coq backend</h3><!--SEC END --><p>
It is possible to specify the names of premises of inductive
predicates; these names are then used by the Coq backend, and are
often useful in proofs. For instance, we can call <span style="font-family:monospace">RED</span> the hypothesis in the rule below
</p><pre>
    t1 --&gt; t1&#X2019;  [[:RED]]
<span style="color:#007FFF"><span style="font-family:monospace">    -------------- ::</span></span> ctx_app_arg
    v t1 --&gt; v t1&#X2019;
</pre><p>
which will then generate the following Coq code:
</p><pre>
| ctx_app_arg : forall (v t1 t1&#X2019;:term)
    (RED: reduce t1 t1&#X2019;),
    is_val_of_term v -&gt;
    reduce (t_app v t1) (t_app v t1&#X2019;).
</pre><p>
Names of rules cannot contain spaces or other non alpha-numerical
characters, and must begin with a letter. The name annotation must at
the rightmost place on the hypothesis line, and must be enclosed
(without spaces) between the <span style="font-family:monospace">[[:</span> and <span style="font-family:monospace">]]</span> parentheses.</p>
<!--TOC subsection id="sec38" In-line embedded prover code in premises-->
<h3 id="sec38" class="subsection">6.2&#X2003;In-line embedded prover code in premises</h3><!--SEC END --><p>
Instead of adding a formula production, one can directly embed prover
code as a premise, delimited as below by <span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span> and
<span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>. Within that, text will be echoed
directly to a prover (or given a default L<sup>A</sup>T<sub>E</sub>X typesetting) except that symbolic terms enclosed within
<span style="font-family:monospace"><span style="color:#007FFF">[[</span></span> and <span style="font-family:monospace"><span style="color:#007FFF">]]</span></span> will be processed as in an
<span style="color:#A51815"><span style="font-family:monospace">embed</span></span> section. 
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> type_to_chunk (<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>typeof e1<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>) = Some <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>c<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">----------------------------------------------------------- ::</span></span> Assign1
  e1=e2 . k |env   --tau--&gt;    lval(e1) . [__=c e2] . k |env
</pre>
<!--TOC subsection id="sec39" User syntax-->
<h3 id="sec39" class="subsection">6.3&#X2003;User syntax</h3><!--SEC END --><p>
The tool also synthesises a <span style="font-family:monospace">user_syntax</span> grammar of all the
user syntax, for example:</p><p><img src="top2006.png"></p><p>This is used for parsing top-level strings, for example when filtering
embedded code (&#XA7;<a href="#a54">8</a>).</p>
<!--TOC section id="sec40" Concrete terms and OCaml generation-->
<h2 id="sec40" class="section">7&#X2003;Concrete terms and OCaml generation</h2><!--SEC END --><p><a id="a57"></a>In semantic definitions, one typically never uses concrete variables,
only metavariables that range over them. 
In examples, however, one may need either a mix of concrete variables
and metavariables, or, for strictly concrete terms, to restrict to
just the former (and also to prohibit symbolic nonterminals).</p><p>Figure&#X2004;&#X200D;<a href="#a46">2</a> combines the LaTeX and proof assistant
annotations of Sections <a href="#a51">3</a> and <a href="#a58">4</a>, adding a
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">lex</span></span><span style="font-family:monospace"> alphanum</span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
hom
to the <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> declaration to specify the lexical form of
concrete variables of this sort. 
At present a <span style="color:#A51815"><span style="font-family:monospace">lex</span></span> homomorphism must have body either
<span style="color:#A51815"><span style="font-family:monospace">Alphanum</span></span> (standing for <code class="verb">[A-Z]([A-Z]|[a-z]|[0-9]|'|_)*</code>),
<span style="color:#A51815"><span style="font-family:monospace">alphanum</span></span> (for <code class="verb">([A-Z]|[a-z])([A-Z]|[a-z]|[0-9]|'|_)*</code>),
<span style="color:#A51815"><span style="font-family:monospace">alphanum0</span></span> (for <code class="verb">[a-z]([A-Z]|[a-z]|[0-9]|'|_)*</code>), or
<span style="color:#A51815"><span style="font-family:monospace">numeral</span></span> (for <code class="verb">[0-9][0-9]*</code>); more general regular expressions are not supported.
An identifier that can be ambiguously lexed as either a concrete or
symbolic metavariable, e.g.&#X2004;&#X200D;<span style="font-family:monospace">x</span> in the scope of the above
declaration, will be taken to be symbolic. 
To restrict the parser to strictly concrete terms only, one can add a
<span style="color:#A51815"><span style="font-family:monospace">:concrete:</span></span> prefix, as shown in Figure&#X2004;&#X200D;<a href="#a56">10</a>.</p><p>One can also specify how concrete variables should be LaTeX&#X2019;d or
translated into a proof assistant, e.g.&#X2004;&#X200D;with
homomorphisms 
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">texvar</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace">\</span><span style="font-family:monospace">mathrm</span><span style="font-family:monospace">{</span><span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">termvar</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
and
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">isavar</span></span><span style="font-family:monospace"> &#X2019;&#X2019;</span><span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">termvar</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span><span style="font-family:monospace">&#X2019;&#X2019;</span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>
(and similarly <span style="color:#A51815"><span style="font-family:monospace">coqvar</span></span>, <span style="color:#A51815"><span style="font-family:monospace">holvar</span></span>, and <span style="color:#A51815"><span style="font-family:monospace">ocamlvar</span></span>).</p><p>Figure&#X2004;&#X200D;<a href="#a46">2</a> also specifies an OCaml representation type for
variables, with the <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> hom
<span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"><span style="color:#007FFF">{</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="color:#A51815">ocaml</span></span><span style="font-family:monospace"> int</span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span><span style="font-family:monospace"><span style="color:#007FFF">}</span></span>.
Executing 
</p><pre>
   bin/ott -i tests/test10.ott -o test10.ml  
</pre><p>
produces the OCaml code shown in Figure&#X2004;&#X200D;<a href="#a59">9</a>, including OCaml
types to represent the abstract syntax, and auxiliary functions for
subrules and substitutions. This does not implement the semantic
rules. In some cases the various proof assistant code extraction
facilities can be used &#X2014; see Section&#X2004;&#X200D;<a href="#a22">21</a>.</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre><span style="font-size:small">
% all
</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">metavar</span></span></span><span style="font-size:small"> termvar</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">,</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small">  term variable </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> 
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">isa</span></span></span><span style="font-size:small"> string</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">coq</span></span></span><span style="font-size:small"> nat</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">hol</span></span></span><span style="font-size:small"> string</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span></span><span style="font-size:small"> int</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">lex</span></span></span><span style="font-size:small"> alphanum</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">mathit</span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">termvar</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">grammar</span></span></span><span style="font-size:small">
t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;t_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">                               </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> term    </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> x            </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Var                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> variable</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(+</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">bind</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">in</span></span></span><span style="font-size:small"> t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">+)</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> lambda  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> t t&#X2019;         </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> App                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> app     </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> ( t )        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">S</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Paren                 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">icho</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> 
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small"> t / x </span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small"> t&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">M</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Tsub  
                        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">icho</span></span></span><span style="font-size:small"> (tsubst_t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">x</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t&#X2019;</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">)</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;v_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">                               </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> value   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small"> x . t      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Lam                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> lambda  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">terminals</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X2019;terminals_&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">            </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> lambda  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">lambda </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> --&gt;          </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> red     </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">longrightarrow </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">subrules</span></span></span><span style="font-size:small">
  v </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span></span><span style="font-size:small"> t

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">substitutions</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">single</span></span></span><span style="font-size:small"> t x </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> tsubst 

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defns</span></span></span><span style="font-size:small">
Jop </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">

 </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defn</span></span></span><span style="font-size:small">
 t1 --&gt; t2 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">reduce</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">&#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> $</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t1</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">$ reduces to $</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span></span><span style="font-size:small">t2</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">]]</span></span></span><span style="font-size:small">$</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">by</span></span></span><span style="font-size:small">


</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------------------</span></span></span><span style="font-size:small">  :: ax_app
    (</span><span style="font-size:small"><span style="font-family:monospace">\</span></span><span style="font-size:small">x.t12) v2 --&gt;  </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small">v2/x</span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small">t12

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_fun
    t1 t --&gt; t1&#X2019; t

    t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span></span><span style="font-size:small"> :: ctx_app_arg
    v t1 --&gt; v t1&#X2019;
</span></pre><span style="font-size:small">

</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 8: Source: <span style="font-family:monospace">test10.7.ott</span><a id="a68"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage"><span style="font-size:small">
</span><pre class="verbatim"><span style="font-size:small">(* generated by Ott 0.33 from: ../tests/test10.ott ../tests/non_super_tabular.ott *)

type var = int (* term variable *)

type 
term =  (* term *)
   T_var of var (* variable *)
 | T_lam of var * term (* lambda *)
 | T_app of term * term (* app *)


(** subrules *)
let is_val_of_term (t5:term) : bool =
  match t5 with
  | (T_var x) -&gt; false
  | (T_lam (x,t)) -&gt; (true)
  | (T_app (t,t')) -&gt; false



(** substitutions *)
let rec tsubst_term (t5:term) (x5:var) (t_6:term) : term =
  match t_6 with
  | (T_var x) -&gt; (if x=x5 then t5 else (T_var x))
  | (T_lam (x,t)) -&gt; T_lam (x,(if List.mem x5 ([x]) then t else (tsubst_term t5 x5 t)))
  | (T_app (t,t')) -&gt; T_app ((tsubst_term t5 x5 t),(tsubst_term t5 x5 t'))


(** definitions *)


</span></pre><span style="font-size:small">
</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 9: Generated OCaml code: <span style="font-family:monospace">test10.ml</span><a id="a59"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote>
<!--TOC section id="sec41" Filtering: Using Ott syntax within LaTeX, Coq, Isabelle,
HOL, or OCaml-->
<h2 id="sec41" class="section">8&#X2003;Filtering: Using Ott syntax within LaTeX, Coq, Isabelle,
HOL, or OCaml</h2><!--SEC END --><p><a id="a54"></a></p>
<!--TOC subsection id="sec42" Filtering embedded code-->
<h3 id="sec42" class="subsection">8.1&#X2003;Filtering embedded code</h3><!--SEC END --><p><a id="a60"></a>It is possible to embed arbitrary code in
the Ott source using an <span style="color:#A51815"><span style="font-family:monospace">embed</span></span> block, which can contain
<span style="color:#A51815"><span style="font-family:monospace">tex</span></span>, 
<span style="color:#A51815"><span style="font-family:monospace">coq</span></span>, 
<span style="color:#A51815"><span style="font-family:monospace">hol</span></span>, 
<span style="color:#A51815"><span style="font-family:monospace">isa</span></span>, or
<span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span> homomorphisms, the
bodies of which will appear in the respective output. 
The <code class="verb">embed</code> keyword should be on a line by itself). For
example, 
<code class="verb">test8.ott</code> contains the following to
define Coq and HOL <code class="verb">remove_duplicates</code> functions.
</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">embed</span></span>
<span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span>
Fixpoint remove_duplicates (l:list typvar_t) : list typvar_t :=
  match l with
  | nil =&gt; nil
  | cons h t =&gt; if (list_mem eq_typvar_t h t)  then remove_duplicates t
                else cons h (remove_duplicates t)
end. <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

<span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span>
val _ = Define &#X2018;
  (remove_duplicates [] = []) /<span style="font-family:monospace">\</span>
  (remove_duplicates (x::xs) = if (MEM x xs) then remove_duplicates xs 
                               else x::(remove_duplicates xs))
&#X2018;; <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
Within the body of an <span style="color:#A51815"><span style="font-family:monospace">embed</span></span> homomorphism, any text between 
<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span> and <span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> will be parsed as a symbolic term (of the
<code class="verb">user_syntax</code> grammar) and pretty printed, so one can use user
syntax within LaTeX or proof assistant code. An Isabelle example
is below, defining an Isabelle function to calculate the order of a
type with productions <code class="verb">unit</code>, <code class="verb">t*t'</code>, and <code class="verb">t-&gt;t'</code>.
</p><pre>
<span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span>
consts
order :: "type =&gt; nat"
primrec
"order <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>unit<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> = 0"
"order <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t*t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> = max (order <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>) (order <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>)"
"order <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t-&gt;t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> = max (1+order <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>) (order <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>)"

<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
It is often useful to define a proof assistant function, in an
<span style="color:#A51815"><span style="font-family:monospace">embed</span></span> section, together with a production of the <span style="color:#A51815"><span style="font-family:monospace">formula</span></span>
grammar with a proof assistant hom that uses that function, thereby
introducing syntax that lets the function be used in semantic rules. </p><p>Ott also permits embed blocks with <span style="color:#A51815"><span style="font-family:monospace">tex-preamble</span></span>,
homs, whose
contents appear in the generated L<sup>A</sup>T<sub>E</sub>X preamble.
Any definitions of L<sup>A</sup>T<sub>E</sub>X commands must appear in such a
<span style="color:#A51815"><span style="font-family:monospace">tex-preamble</span></span> section.
</p>
<!--TOC subsection id="sec43" Filtering files-->
<h3 id="sec43" class="subsection">8.2&#X2003;Filtering files</h3><!--SEC END --><p>
Similar processing can be carried out on separate files, using the
command-line options <code class="verb">tex_filter</code>, <code class="verb">isa_filter</code>, etc.
Each of these takes two arguments, a source filename and a destination
filename. In processing the source file, 
any text between 
<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span> and <span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> will be parsed as a symbolic term (of the
<code class="verb">user_syntax</code> grammar) and pretty printed in the appropriate
style. All other text is simply echoed.
</p><p>Typical usage for LaTeX would be something like this (from the <code class="verb">Makefile</code>
used to produce this document):
</p><pre class="verbatim">test7.tex: ../src/ott ../tests/test7.ott ../tests/test7tt.mng
         cd ../src; make tmp_test7_clean.ott
         ../src/ott                                        \
                -i ../src/tmp_test7_clean.ott              \
                -o test7.tex                               \
                -tex_show_meta false                       \
                -tex_wrap false                            \
                -tex_name_prefix testSeven                 \
                -tex_filter ../tests/test7tt.mng test7tt.tex 
</pre><p>
The <code class="verb">-tex_wrap false</code> turns off output of the default LaTeX
document preamble, so the generated file <code class="verb">test7.tex</code> just contains
LaTeX definitions. 
The <code class="verb">-tex_name_prefix testSeven</code> sets a prefix for the generated
LaTeX commands
(so the LaTeX definitions from multiple Ott source files can be
included in a single LaTeX document).
The <code class="verb">-tex_filter</code> argument takes two
filenames, a source and a destination. It filters the source file,
(roughly) replacing any string found within <code class="verb">[[</code> <code class="verb">]]</code> by
the tex pretty-print of its parse. This parsing is done w.r.t.&#X2004;&#X200D;the generated nonterminal 
<code class="verb">user_syntax</code> which is a union of all the user&#X2019;s grammar. </p><p>At present munged strings are not automatically
put within <code class="verb">$</code> <code class="verb">$</code>, and there is no analogue of the
<code class="verb">&lt;[</code> <code class="verb">]&gt;</code> of our previous munger. </p><p>The lexing 
turns any sequence of <code class="verb">[</code> (resp. of <code class="verb">]</code>) of
length <span style="font-style:italic">n</span>+1 for <span style="font-style:italic">n</span>&gt;2 into a literal sequence of length <span style="font-style:italic">n</span>.</p><p>Figures&#X2004;&#X200D;<a href="#a56">10</a> and <a href="#a55">11</a> show a source file (<span style="font-family:monospace">test7tt.mng</span>) that uses terms of the F<sub>&lt;:</sub>
definition of <span style="font-family:monospace">test7.ott</span>, and the result of filtering it.</p><p>Similar filtering can be performed on Coq, Isabelle, HOL, and OCaml files.</p><p>To filter files with respect to a relatively stable
system definition, without having to re-process the Ott source files of
that system definition each time, there are command-line options
</p><pre class="verbatim">  -writesys &lt;filename&gt;                Output system definition
  -readsys &lt;filename&gt;                 Input system definition
</pre><p>
to first write the system definition (generated from some source files) to a file, and
then to read one back in (instead of re-reading the Ott source files). 
The saved system definitions are in an internal format, produced using
the OCaml marshaller, and contain OCaml closures. They therefore will
not be compatible between different Ott versions. They may also be
quite large. </p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<pre>
We can TeX-typeset symbolic terms of the language, e.g.
<span style="font-family:monospace">\</span>[ <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span> (<span style="font-family:monospace">\</span>X&lt;:Top. <span style="font-family:monospace">\</span>x:X.x) [Top-&gt;Top] <span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="font-family:monospace">\</span>]
and concrete terms
<span style="font-family:monospace">\</span>[ <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span> <span style="color:#A51815"><span style="font-family:monospace">:concrete:</span></span> <span style="font-family:monospace">\</span>Z1&lt;:Top. <span style="font-family:monospace">\</span>x:Z1.x <span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="font-family:monospace">\</span>]
and similarly judgements etc, e.g.
<span style="font-family:monospace">\</span>[ <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>G |- t : T <span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="font-family:monospace">\</span>]
   
Here is an extract of the syntax:

<span style="font-family:monospace">\</span>testSevengrammartabular<span style="font-family:monospace">{</span><span style="font-family:monospace">\</span>testSevent<span style="font-family:monospace">\</span>testSevenafterlastrule<span style="font-family:monospace">}</span>

and a single semantic rule:

<span style="font-family:monospace">\</span>[<span style="font-family:monospace">\</span>testSevendruletinXXTwo<span style="font-family:monospace">{</span><span style="font-family:monospace">}</span><span style="font-family:monospace">\</span>]

and a judgement definition:

<span style="font-family:monospace">\</span>testSevendefnSA

One can also include a &#X2018;defns&#X2019; collection of judgements, or the complete definition.
% <span style="font-family:monospace">\</span>section<span style="font-family:monospace">{</span>Full Definition<span style="font-family:monospace">}</span>
% <span style="font-family:monospace">\</span>testSevenmetavars<span style="font-family:monospace">\</span><span style="font-family:monospace">\</span>[0pt]
% <span style="font-family:monospace">\</span>testSevengrammar<span style="font-family:monospace">\</span><span style="font-family:monospace">\</span>[0pt]
% <span style="font-family:monospace">\</span>testSevendefnss
%
% <span style="font-family:monospace">\</span>testSevenall


</pre>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 10: F<sub>&lt;:</sub> Extracts: LaTeX source file to be filtered (<span style="font-family:monospace">test7tt.mng</span>)<a id="a56"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<img src="top2007.png"><div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 11: F<sub>&lt;:</sub> Extracts: the filtered output (<span style="font-family:monospace">test7tt.tex</span>)<a id="a55"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote>
<!--TOC section id="sec44" Binding specifications-->
<h2 id="sec44" class="section">9&#X2003;Binding specifications</h2><!--SEC END --><p><a id="a62"></a></p><p>Our first example involved a production with a single binder:

</p><p><img src="top2008.png"></p><p>specified by the source shown in Figure&#X2004;&#X200D;<a href="#a47">4</a>:
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam     <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> x <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span>
</pre><p>
in which a single variable binds in a single subterm.
Realistic programming languages often have much more complex binding
structures, e.g.&#X2004;&#X200D;structured patterns, multiple mutually recursive <span style="font-family:monospace">let</span> definitions,
comprehensions, or-patterns, and dependent record patterns.</p><p>Ott has a flexible metalanguage for specifying binding structures,
expressive enough to cover these.
It comprises two forms of annotation on productions.
The first, 

<img src="top2009.png">lets one specify that variables bind in nonterminals of the
production, as in the <span style="font-family:monospace">Lam</span> production above.
Here 

<img src="top2010.png">is a <em>metavariable set expression</em>,
e.g.&#X2004;&#X200D;in that lambda production just the singleton
metavariable 

<img src="top2011.png">of the production.
A variable can bind in multiple nonterminals, as in the example of
a simple recursive <span style="font-family:monospace">let</span> below.</p><p><img src="top2012.png"></p><p>More complex examples require one to collect together sets of
variables. For example, the grammar below (shown in Ott source and the
generated LaTeX) has structured patterns,
with a 
<img src="top2013.png">production in which all the binders of the pattern 

<img src="top2014.png">bind in the continuation 

<img src="top2015.png"></p><pre><span style="font-size:small">
t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> E_ </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> x                        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> ident
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> ( t1 , t2 )              </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> pair
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> let p = t in t&#X2019;          </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> letrec      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(+</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">bind</span></span></span><span style="font-size:small"> binders</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(</span></span></span><span style="font-size:small">p</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">)</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">in</span></span></span><span style="font-size:small"> t&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">+)</span></span></span><span style="font-size:small">


p </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> P_ </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> _                        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> wildcard    </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(+</span></span></span><span style="font-size:small"> binders </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">=</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">+)</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> x                        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> ident       </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(+</span></span></span><span style="font-size:small"> binders </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">=</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">+)</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> ( p1 , p2 )              </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> pair        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(+</span></span></span><span style="font-size:small"> binders </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">=</span></span></span><span style="font-size:small"> binders</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(</span></span></span><span style="font-size:small">p1</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">)</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">union</span></span></span><span style="font-size:small"> binders</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(</span></span></span><span style="font-size:small">p2</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">)</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">+)</span></span></span><span style="font-size:small">
</span></pre><p><img src="top2016.png"></p><p>This is expressed with the second form of annotation: user-defined
<em>auxiliary functions</em> such as the 
binders above. This is an auxiliary function defined over the

<img src="top2017.png">grammar that identifies a set of variables to be
used in the <span style="font-family:sans-serif">bind</span> annotation on the 
<img src="top2018.png">production. There can be any number of such auxiliary functions;
binders is not a distinguished keyword.</p><p>The syntax of a precise fragment of the binding metalanguage is given in
Fig.&#X2004;&#X200D;<a href="#a13">12</a>,

</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<img src="top2019.png"><div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 12: Mini-Ott in Ott: the binding specification metalanguage<a id="a13"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><p>where we have used Ott to define part of the Ott
metalanguage. A simple type system (not shown) enforces sanity properties,
e.g.&#X2004;&#X200D;that each auxiliary function is only applied to nonterminals that
it is defined over, and that metavariable set expressions are
well-sorted.</p><p>Further to that fragment, the tool supports binding for the list forms
of &#XA7;<a href="#a61">12</a>. 
Metavariable set expressions can include lists of metavariables
and auxiliary functions applied to lists of nonterminals, e.g.&#X2004;&#X200D;as in
the record patterns below.
</p><p><img src="top2020.png"></p><p>This suffices to express the binding structure of almost all the
natural examples we have come across, including definitions of
mutually recursive functions with multiple clauses for each, Join
calculus definitions&#X2004;&#X200D;[<a href="#FGLMR96"></a>], dependent record patterns, and many others.</p>
<!--TOC section id="sec45" Generating substitution and free variable functions-->
<h2 id="sec45" class="section">10&#X2003;Generating substitution and free variable functions</h2><!--SEC END --><p><a id="a67"></a>The tool can generate Isabelle/Coq/HOL/OCaml code for both single and multiple
substitution functions. For example, the ML polymorphism Ott source
of <span style="font-family:monospace">test8.ott</span> includes the following.
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">substitutions</span></span>
    <span style="color:#A51815"><span style="font-family:monospace">single</span></span>   expr value_name <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> subst  
    <span style="color:#A51815"><span style="font-family:monospace">multiple</span></span> typexpr typvar  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsubst 
</pre><p>
This causes the generation of two families of substitution
functions, one replacing a single <code class="verb">value_name</code> by a <code class="verb">expr</code>,
the other replacing multiple <code class="verb">typvar</code>s by <code class="verb">typexpr</code>s. </p><p>Each family contains a function for each datatype for which it is
required, so in that example there are functions
<code class="verb">subst_expr</code> for the first and <code class="verb">tsubst_typexpr</code>,
<code class="verb">tsubst_typscheme</code> and <code class="verb">tsubst_G</code> for the second. </p><p>The functions for substitutions declared by
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">substitutions</span></span>
    <span style="color:#A51815"><span style="font-family:monospace">single</span></span>   this that <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> name1 
    <span style="color:#A51815"><span style="font-family:monospace">multiple</span></span> this that <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> name2 
</pre><p>
replaces terms of productions consisting just of a single <code class="verb">that</code> by a
<code class="verb">this</code>.
Here <code class="verb">this</code> must be a nonterminal root, while <code class="verb">that</code> can be
either a metavariable root or a nonterminal root (the latter
possibility allows substitution for compound identifiers, though it is
not clear that this is generally useful enough to be included). 
Substitution functions are generated for each member of each (mutually recursive)
block of grammar rules which either contain such a production or (indirectly)
refer to one that does. </p><p>At present multiple substitutions are represented by Isabelle/Coq/HOL/OCaml
lists, so for the example above we have Isabelle
</p><pre class="verbatim">  tsubst_typexpr :: "(typvar*typexpr) list =&gt; typexpr =&gt; typexpr"
  tsubst_typscheme :: "(typvar*typexpr) list =&gt; typscheme =&gt; typscheme"
  tsubst_G :: "(typvar*typexpr) list =&gt; G =&gt; G"
</pre><p>
The generated functions do not substitute bound things, and recursive
calls under binders are filtered to remove the bound things.</p><p>Similarly, the tool can generate Isabelle/Coq/HOL/OCaml to calculate the free
variables of terms. For example, the ML polymorphism Ott source
of <span style="font-family:monospace">test8.ott</span> includes the following.
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">freevars</span></span>
    typexpr typvar <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> ftv
</pre><p>
This causes Isabelle functions as below to be generated, calculating
the free <span style="font-family:monospace">typvar</span>s that occur in singleton productions in the
<span style="font-family:monospace">typexpr</span> grammar, within terms of all types.
</p><pre class="verbatim">  ftv_typexpr :: "typexpr =&gt; typvar list"
  ftv_typscheme :: "typscheme =&gt; typvar list"
  ftv_G :: "G =&gt; typvar list"
</pre>
<!--TOC section id="sec46" Locally-nameless representation-->
<h2 id="sec46" class="section">11&#X2003;Locally-nameless representation</h2><!--SEC END --><p>The Coq backend of Ott includes experimental support for a
locally-nameless representation (and co-finite quantification). </p><p>The user must specify which metavariables require a locally-nameless
representation via the <span style="font-family:monospace"><span style="color:#A51815">repr-locally-nameless</span></span> hom,
e.g.:</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> x <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">repr-locally-nameless</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span>  term variable  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
</pre><p>As usual, metavariables can be bound in productions, using the
bindspec language, as in the <span style="font-family:monospace">lam</span> production below:
</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">grammar</span></span>
  t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;t_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                                         <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> term <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> x                   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Var                     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> variable <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>         
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam  <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> x <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> abstraction <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>      
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> t t&#X2019;                <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> App                     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> application <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>      
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( t )               <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">S</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> paren   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> t / x <span style="font-family:monospace">}</span> t&#X2019;        <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsub    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> (t_subst_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x  t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>) <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>This definition gives rise to the datatype term below (here with option <span style="font-family:monospace">-coq_names_in_rules false</span>):
</p><pre>
Inductive term : Set := 
| term_var_b : nat -&gt; term 
| term_var_f : var -&gt; term 
| term_lam : term -&gt; term 
| term_app : term -&gt; term -&gt; term.
</pre><p>Remarks:
</p><ol class="enumerate" type=1><li class="li-enumerate">
Productions containing metavariables susceptible to be bound
(e.g., <span style="font-family:monospace">term_var</span>) give rise to two distinct constructors, one
(<span style="font-family:monospace">term_var_b</span>) for de Bruijn indices to be used when the metavariable
is bound, one (<span style="font-family:monospace">term_var_f</span>) for "free" variables. The type <span style="font-family:monospace">var</span>,
together with decidable equality and several useful lemmas and
functions, is defined in the Metatheory library.<p>In the current implementation, metavariables susceptible to be bound
in a symbolic term (eg. the <span style="font-family:monospace">x</span> in the <span style="font-family:monospace">term_var</span>
production) must be the only element of the production.</p></li><li class="li-enumerate">Binder metavariables are erased from productions
(eg. <span style="font-family:monospace">term_lam</span>), as in de Bruijn representation.
</li></ol><p>Ott automatically generates the appropriate <span style="font-family:monospace">open</span> functions
and <span style="font-family:monospace">lc</span> predicates to test if terms are locally-closed. The
other support functions for substitutions and free-variables
(<span style="font-family:monospace">subst</span> and <span style="font-family:monospace">fv</span>) are generated once the user declares
the relevant substitutions and freevars sections.</p><p>Ott automatically compiles the symbolic terms that appear in rule
definitions into the appropriate terms in locally-nameless style. For
instance, the typing rule for the simply-typed lambda-calculus:</p><pre>
    E,x:S |- t : T
<span style="color:#007FFF"><span style="font-family:monospace">    ------------------</span></span> :: lambda
    E |- <span style="font-family:monospace">\</span>x.t : S-&gt;T
</pre><p>
is compiled into its locally-nameless representation:
</p><pre>
Inductive typing : env -&gt; term -&gt; type -&gt; Prop := (* defn typing *) 
| ... 
| typing_lambda : forall (L:vars) (E:env) (t:term) (S T:type), 
   (forall x, x <span style="font-family:monospace">\</span>notin L -&gt; typing (E &amp; x ~ S) (open_term_wrt_term t (term_var_f x)) T) -&gt; 
   typing E (term_lam t) (type_arrow S T).
</pre><p>For that, Ott follows the algorithm below. For each rule,
</p><ol class="enumerate" type=1><li class="li-enumerate">
for each nonterminal that appears in the rule, compute the
maximal set of binders under which it appears: for example, in the
rule lambda above, the maximal set of binders for the nonterminal <span style="font-family:monospace">t</span>
is the singleton <span style="font-family:monospace">x</span>, and it is empty for all the other nonterminals;
</li><li class="li-enumerate">for each pair nonterminal / maximal binder set collected in
phase 1., go over all the occurrences of the nonterminal in the rule
and open them with respect to all the variables in the maximal
binding set except those under which this particular occurrence is
bound. In the example, this amounts to opening the occurrence of <span style="font-family:monospace">t</span>
in the premise with respect to the metavariable <span style="font-family:monospace">x</span>;
</li><li class="li-enumerate">quantify using cofinite-quantification each metavariable that
has been used to open a nonterminal;
</li><li class="li-enumerate">add hypothesis about local-closure to guarantee the invariant
that if a derivation holds, then the top-level terms involved are
locally-closed.
</li></ol><p>
In some cases the user may want a finer control on which nonterminals
are opened and with respect to which metavariables. Consider for
instance the CBV beta-reduction rule:
</p><pre>
<span style="color:#007FFF"><span style="font-family:monospace">    --------------------------</span></span>  :: ax_app
    (<span style="font-family:monospace">\</span>x.t1) v2 --&gt;  <span style="font-family:monospace">{</span>v2/x<span style="font-family:monospace">}</span>t1
</pre><p>
A naive application of the algorithm described above would open the
right hand side occurrence of <span style="font-family:monospace">t1</span> with respect to a
cofinitely-quantified <span style="font-family:monospace">x</span>. Substitution should then be used to replace
the occurrences of <span style="font-family:monospace">x</span> with <span style="font-family:monospace">v2</span>, resulting in the awkward term
</p><pre>
reduce (term_app (term_lam t1) v2) (subst_term v2 x (open_term_wrt_term t1 (term_var_f x)))
</pre><p>Instead, an idiomatic translation of CBV beta-reduction rule would
directly rely on the open function to substitute <span style="font-family:monospace">v2</span> for the
bound occurrences of <span style="font-family:monospace">x</span> in <span style="font-family:monospace">t1</span>, as in:
</p><pre>
reduce (term_app (term_lam t1) v2) (open_term_wrt_term t1 v2)
</pre><p>A special syntax for production homomorphisms allow the user to specify this translation:
</p><pre>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> t / x <span style="font-family:monospace">}</span> t&#X2019;        <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsub    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> (t_subst_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>) <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
In the homomorphism the nonterminal <span style="font-family:monospace">t&#X2019;</span> is referred to with
<span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">x t&#X2019;</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span> instead of the usual
<span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">t&#X2019;</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span>: the prefixed <span style="font-family:monospace">x</span> specifies
that occurrences of <span style="font-family:monospace">t&#X2019;</span> should not be opened with respect to
the metavariable <span style="font-family:monospace">x</span>. If this homomorphism is specified, then
the translation of the <span style="font-family:monospace">ax_app</span> rule is exactly idiomatic Coq
shown above.</p><p><span style="font-style:italic">Current limitations: support for single binders only, no auxfn, Coq only.</span></p><p><span style="font-style:italic">Disclaimer: to compile rule definitions, Ott applies blindly the algorithm described above. Although in most of the cases, this generates a correct and idiomatic representation of the language, some language constructs might not be faithfully translated. Please, let us know if you find one of these cases.
</span></p><p>If Ott is invoked with the <span style="font-family:monospace">-coq_lngen</span> option, then the
generated locally-nameless Coq code is compatible with Aydemir&#X2019;s
<span style="font-style:italic">lngen</span> tool (<a href="http://www.cis.upenn.edu/&#X2004;&#X200D;sweirich/papers/lngen/"><span style="font-family:monospace">http://www.cis.upenn.edu/&#X2004;&#X200D;sweirich/papers/lngen/</span></a>).</p>
<!--TOC section id="sec47" List forms-->
<h2 id="sec47" class="section">12&#X2003;List forms</h2><!--SEC END --><p><a id="a61"></a>Ott has direct support for lists, both as <em>dot forms</em> such as 

<img src="top2021.png">and as <em>list comprehensions</em> such as 

<img src="top2022.png">.
Figure&#X2004;&#X200D;<a href="#a63">13</a> shows an example semantic rule taken from our OCaml
fragment semantics, as both the generated LaTeX and its Ott
source, that involves several dot forms.
Other types commonly used in semantics, e.g.&#X2004;&#X200D;finite maps or sets, can
often be described with this list syntax in conjunction with type and
metaproduction homs to specify the proof assistant representation.
When using list forms, one usually also wants to add a list-of-formula
production to the <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> grammar, e.g. (as in
<code class="verb">test17.10.ott</code>):
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> formula_ <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>  
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  judgement                       <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> judgement
   <span style="color:#007FFF"><span style="font-family:monospace">|</span></span>  formula1 <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> formulan            <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> dots
</pre><p>
The proof assistant code generation for such a production (which must
be named <code class="verb">formula_dots</code>) is special-cased to a list conjunction.</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span style="font-size:small"><img src="top2023.png"></span><pre><span style="font-size:small">
 E |- e1 : t1 ... E |- en : tn
 E |- field_name1 : t-&gt;t1 ... E |- field_namen : t-&gt;tn
 t = (t1&#X2019;, ..., tl&#X2019;) typeconstr_name
 E |- typeconstr_name gives typeconstr_name:kind </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small">field_name1&#X2019;; ...; field_namem&#X2019;</span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small">
 field_name1...field_namen PERMUTES field_name1&#X2019;...field_namem&#X2019;
 length (e1)...(en)&gt;=1
 -------------------------------------------------------------------------- :: record_constr
 E |- </span><span style="font-size:small"><span style="font-family:monospace">{</span></span><span style="font-size:small">field_name1=e1; ...; field_namen=en</span><span style="font-size:small"><span style="font-family:monospace">}</span></span><span style="font-size:small"> : t
</span></pre><div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" ><span style="font-size:small">Figure 13: A sample OCaml semantic rule, in LaTeX and Ott
source forms</span><a id="a63"></a></td></tr>
</table></div><div class="center"><hr class="floatrule"></div></blockquote>
<!--TOC subsection id="sec48" List dot forms-->
<h3 id="sec48" class="subsection">12.1&#X2003;List dot forms</h3><!--SEC END --><p><a id="a66"></a>Example productions for 
record types, record terms, and record
patterns are shown below, in both Ott source and LaTeX, taken
from our F<sub>&lt;:</sub> example.
</p><pre>
T<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> S<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> U <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;T_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                                               <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> type  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> l1 : T1 , <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , ln : Tn <span style="font-family:monospace">}</span>      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Rec                       <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> record <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>           

t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;t_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                                                     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span>  term  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> l1 = t1 ,  <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , ln = tn <span style="font-family:monospace">}</span>     <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Rec                       <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> record <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> let p = t in t&#X2019;                 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Let <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> b<span style="color:#007FFF"><span style="font-family:monospace">(</span></span>p<span style="color:#007FFF"><span style="font-family:monospace">)</span></span> <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> pattern binding<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

p <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;P_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                                                     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span>  pattern <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> x : T                           <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Var <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> b <span style="color:#007FFF"><span style="font-family:monospace">=</span></span> x  <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span>          <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> variable pattern <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> l1 = p1 , <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , ln = pn <span style="font-family:monospace">}</span>      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Rec <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> b <span style="color:#007FFF"><span style="font-family:monospace">=</span></span> b<span style="color:#007FFF"><span style="font-family:monospace">(</span></span>p1 <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> pn<span style="color:#007FFF"><span style="font-family:monospace">)</span></span> <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span>  record pattern  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

</pre><p>
<img src="top2024.png"></p><p>Dot forms can be used in symbolic terms in semantic rules:</p><p>
<img src="top2025.png"></p><p>Individually indexed projections from dot forms can be mentioned, eg
the <span style="font-style:italic">l</span><sub><span style="font-style:italic">j</span></sub> below:</p><p>
<img src="top2026.png"></p><p>Symbolic terms can also include concatenations of two dot forms with a
singleton in between:</p><p>
<img src="top2027.png"></p><p>Multiple dot forms within the same semantic rule can share bounds (e.g.&#X2004;&#X200D;1..<span style="font-style:italic">m</span>):</p><p>
<img src="top2028.png"></p><p>In more detail, productions can have dot tokens interspersed between the elements. 
Dot tokens consist of two, three or four consecutive dots (<span style="color:#007FFF"><span style="font-family:monospace">..</span></span>,
<span style="color:#007FFF"><span style="font-family:monospace">...</span></span>, or <span style="color:#007FFF"><span style="font-family:monospace">....</span></span>), indicating lists with minimum lengths 0,
1, and 2 respectively (these length minimums are respected
only when parsing concrete lists; they are not present in Isabelle/Coq/HOL
output). 
The tool identifies the maximal sequence of elements on either side of
the dots that are identical modulo anti-unification of some
index. Optionally, there may also be a single terminal on either side
of the dot token, separating instances of the repeated unit.
For example, in the <span style="font-family:monospace">test7.ott</span> production
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> l1 = t1 ,  <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , ln = tn <span style="font-family:monospace">}</span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Rec                     
</pre><p>
there is such a terminal (the &#X2018;<code class="verb">,</code>&#X2019;). The tool identifies
that <code class="verb">l1 = t1</code> and <code class="verb">ln = tn</code> can be anti-unified as 
(roughly) <code class="verb">l_ = t_</code>, taking <code class="verb">_</code> to be the bounds <code class="verb">1</code> and <code class="verb">n</code>.
A single production may contain multiple dot forms, but they must not overlap;
nested dot forms (including those with multiple changing indices) are not currently
supported. </p><p>Homomorphisms and binding specifications are generalised to match: an <code class="verb">mse</code> can
involve a dot form of metavariables; 
a dot form of nonterminals; or an auxiliary function applied to a dot
form
of nonterminals (e.g.&#X2004;&#X200D;the
b(<span style="font-style:italic">p</span><sub>1</sub>..<span style="font-style:italic">p</span><sub><span style="font-style:italic">n</span></sub>) above).
Dot forms on the right of a <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> are not currently supported.</p><p>LaTeX homomorphisms should not refer to dot forms, as either an error
or bad output will be generated. (For LaTeX, there should really be
some means to specify
a homomorphism for the repeated expression, and also data on how any
list separators should be typeset. This would require more
special-case treatment, which is not currently supported.)</p>
<!--TOC subsection id="sec49" List comprehension forms-->
<h3 id="sec49" class="subsection">12.2&#X2003;List comprehension forms</h3><!--SEC END --><p><a id="a44"></a>Lists can also be expressed as explicit list comprehensions, 
for more concise typesetting.
Three different styles are supported, with no bounds, an upper bound,
or a lower and upper bound. For example, in a symbolic
term, instead of the dot form 
</p><pre><span style="font-size:small">
  G |- t1:T1  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small">  G |- tn:Tn
 </span></pre><p><span style="font-size:small">
</span>
one can write any of the following
</p><pre><span style="font-size:small">
   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> G |- ti:Ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i           </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small">
   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> G |- ti:Ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> n      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small">
   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> G |- ti:Ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> 1 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small"> n </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small">
 </span></pre><p><span style="font-size:small">
</span>
Similar comprehensions can be used in productions, for example lines
2&#X2013;4 below. In addition, comprehensions in productions can specify a
terminal to be used as a separator in concrete lists, as in lines 5&#X2013;7 below.
(These examples are taken from <code class="verb">test17.10.ott</code>.)
</p><pre><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> l1 = t1 ,  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small"> , ln = tn </span><span style="font-size:small">           </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Rec              </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> dots </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li = ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i           </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small">      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Rec_comp_none    </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> comp </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li = ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> n      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small">      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Rec_comp_u_none  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> compu </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> 
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li = ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> 1 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small"> n </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small">      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Rec_comp_lu_none </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> complu </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">  
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li = ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> , </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i           </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Rec_comp_some    </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> comp with terminal </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li = ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> , </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> n      </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Rec_comp_u_some  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> compu with terminal </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> 
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li = ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> , </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> 1 </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small"> n </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Rec_comp_lu_some </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> complu with terminal </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">  
 </span></pre><p><span style="font-size:small">
</span>
In Coq, HOL or Isabelle output, list dot forms and the
various list comprehension forms are treated almost identically.
In LaTeX output, comprension forms are default-typeset with overbars. 
For example, the rules below
</p><pre><span style="font-size:small">
 G|- t:</span><span style="font-size:small">l1:T1,</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small">,ln:Tn</span><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace"> ----------------------- :: </span></span></span><span style="font-size:small">Proj_dotform
 G|- t.lj : Tj

 G|- t: </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li:Ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace"> ---------------------------------- ::</span></span></span><span style="font-size:small"> Proj_comp
 G|- t.lj : Tj

 G|- t: </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li:Ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> n</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace"> ---------------------------------- ::</span></span></span><span style="font-size:small"> Proj_comp_u
 G|- t.lj : Tj

 G|- t: </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li:Ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> 1</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small">n</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace"> ---------------------------------- ::</span></span></span><span style="font-size:small"> Proj_comp_lu
 G|- t.lj : Tj
 </span></pre><p><span style="font-size:small">
</span>
are typeset as follows.</p><p>
<img src="top2029.png"></p><p>Upper bounds of the form <span style="font-style:italic">n</span>&#X2212;1 are also permitted, e.g. with
</p><pre><span style="font-size:small">
 G|- t:</span><span style="font-size:small">l0:T0,</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small">,ln-1:Tn-1</span><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace"> ----------------------- ::</span></span></span><span style="font-size:small"> Proj_dotform_minus
 G|- t.lj : Tj

 G|- t: </span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">&lt;/</span></span></span><span style="font-size:small"> li:Ti </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">//</span></span></span><span style="font-size:small"> i </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">IN</span></span></span><span style="font-size:small"> 0</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">..</span></span></span><span style="font-size:small">n-1</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">/&gt;</span></span></span><span style="font-size:small"> </span><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace"> ---------------------------------- ::</span></span></span><span style="font-size:small"> Proj_comp_lu_minus
 G|- t.lj : Tj
 </span></pre><p><span style="font-size:small">
</span>
typeset as below. More complex arithmetic expressions are not
currently supported.</p><p>
<img src="top2030.png"></p><p>A list form used in a symbolic term does not have to be in the same
style as that in the corresponding production. 
However, if a metavariable or nonterminal occurs in multiple different
list forms in the same inference rule, they must all be in the same style and
with the same bounds. Moreover, in a production, a list form in a bindspec or
homomorphism must be in the same style and with the same bounds as the
corresponding list form in the elements of the production. </p><p>The comprehension form without an upper bound, 
e.g.&#X2004;&#X200D;<span style="font-family:monospace"><span style="color:#007FFF">&lt;/</span></span><span style="font-family:monospace"> G |- ti:Ti </span><span style="font-family:monospace"><span style="color:#007FFF">//</span></span><span style="font-family:monospace"> i </span><span style="font-family:monospace"><span style="color:#007FFF">/&gt;</span></span>, 
typeset as 
<img src="top2031.png">is not standard
notation, but is often very useful. Many semantic rules involve lists
of matched length, e.g.&#X2004;&#X200D;of the 
<img src="top2032.png">and
<img src="top2033.png">here, but do not need to introduce an
identifier for that length; omitting it keeps them concise.</p><p>The default visual style for typesetting list comprehensions can be
overridden by redefining the LaTeX commands <code class="verb">\ottcomp</code>,
<code class="verb">\ottcompu</code>, and <code class="verb">\ottcomplu</code> in an <span style="color:#A51815"><span style="font-family:monospace">embed</span></span> section, as
in Section&#X2004;&#X200D;<a href="#a64">4.3</a>.</p><p>In some cases one could make the typeset notation even less noisy, by
either omitting the superscript <span style="font-style:italic">i</span> or omitting both the superscript <span style="font-style:italic">i</span> and
the subscript <span style="font-style:italic">i</span>&#X2019;s on <span style="font-style:italic">t</span> and <span style="font-style:italic">T</span>. The first is unambiguous if there
is at most one index on each element in the comprehension; the second
if all the elements are indexed by the same thing (not the case for
this example, but common for comprehensions of single elements,
e.g. <code class="verb">&lt;&lt; Ti // i&gt;&gt;</code> for <span style="text-decoration:overline"><span style="font-style:italic">T</span></span>). It is arguable that that
should be automated in future Ott releases, though it would bring the typeset and ASCII
versions out of step.</p><p>List comprehension forms can also be used in bindspecs and in
homomorphisms. </p>
<!--TOC subsection id="sec50" Proof assistant code for list forms-->
<h3 id="sec50" class="subsection">12.3&#X2003;Proof assistant code for list forms</h3><!--SEC END --><p><a id="a65"></a></p>
<!--TOC subsubsection id="sec51" Types-->
<h4 id="sec51" class="subsubsection">12.3.1&#X2003;Types</h4><!--SEC END --><p>
We have to choose proof assistant representations for productions involving list
forms. For example, for a language with records one might write 
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> label<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> l <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> string <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> nat <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#A51815"><span style="font-family:monospace">indexvar</span></span> index<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> n <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> num <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> nat <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
  <span style="color:#A51815"><span style="font-family:monospace">grammar</span></span>
  term<span style="color:#007FFF"><span style="font-family:monospace">,</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;t_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> l1 = t1 ,  <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , ln = tn <span style="font-family:monospace">}</span>      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> record
</pre><p>

In HOL and Isabelle we represent these simply with contructors whose
argument types involve proof-assistant native list types, e.g.
the HOL list of pairs of a <code class="verb">label</code> and a <code class="verb">t</code>:
</p><pre class="verbatim"><span style="font-size:small">  val _ = Hol_datatype ` 
  t = E_record of (label#t) list  `;
</span></pre><p><span style="font-size:small">
</span>For Coq we provide two alternatives: one can either use
native lists, or lists can be translated away, depending on taste.
The choice is determined by the <code class="verb">-coq_expand_list_types</code>
command-line option.
In the former case we generate an appropriate induction principle
using nested fixpoints, as
the default principle produced by Coq is too weak to be useful.
In the latter case we
synthesise an additional type for each type of lists-of-tuples that
arises in the grammar. 
In the example, we need a type of lists of
pairs of a <span style="font-family:monospace">label</span> and a <span style="font-family:monospace">t</span>:
</p><pre class="verbatim"><span style="font-size:small">Inductive 
list_label_t : Set := 
   Nil_list_label_t : list_label_t
 | Cons_list_label_t : label -&gt; t -&gt; list_label_t 
     -&gt; list_label_t

with t : Set := 
   E_record : list_label_t -&gt; t .
</span></pre><p><span style="font-size:small">
</span>These are included in the grammar topological sort, and utility functions, e.g.&#X2004;&#X200D;to 
make and unmake lists, are synthesised. 
</p>
<!--TOC subsubsection id="sec52" Terms (in inductive definition rules)-->
<h4 id="sec52" class="subsubsection">12.3.2&#X2003;Terms (in inductive definition rules)</h4><!--SEC END --><p>
Supporting list forms in the rules of an inductive definition requires some additional analysis. For example,
consider the record typing rule below.</p><p><img src="top2034.png">
We analyse the symbolic terms in the premises and conclusion to
identify lists of nonterminals and metavariables with the same bounds &#X2014; here <span style="font-style:italic">t</span><sub>0</sub> .. <span style="font-style:italic">t</span><sub><span style="font-style:italic">n</span>&#X2212;1</sub>, <span style="font-style:italic">T</span><sub>0</sub> .. <span style="font-style:italic">T</span><sub><span style="font-style:italic">n</span>&#X2212;1</sub>, and <span style="font-style:italic">l</span><sub>0</sub> .. <span style="font-style:italic">l</span><sub><span style="font-style:italic">n</span>&#X2212;1</sub>
all have bounds 0..<span style="font-style:italic">n</span>&#X2212;1.
To make the fact that they have the same length immediate in the
generated code, we introduce a single proof assistant
variable for each such collection, with appropriate projections and
list maps/foralls at the usage points.
For example, the HOL for the above is essentially as follows, with
an <code class="verb">l_t_Typ_list : (label#t#Typ) list</code>.
</p><pre class="verbatim"><span style="font-size:small">(* Ty_Rcd *)  !(l_t_Typ_list:(label#t#Typ) list) (G:G) . 
(EVERY (\b.b) 
  (MAP (\(l_,t_,Typ_). (Ty G t_ Typ_)) l_t_Typ_list))
 ==&gt; 
(Ty 
  G 
  (E_record (MAP (\(l_,t_,Typ_). (l_,t_)) l_t_Typ_list))
  (T_Rec    (MAP (\(l_,t_,Typ_). (l_,Typ_)) l_t_Typ_list)))
</span></pre><p><span style="font-size:small">
</span>This seems to be a better idiom for later proof development than the
alternative of three different list variables coupled with assertions
that they have the same length. </p><p>With direct support for lists, we need also direct support for 
symbolic terms involving list projection and concatenation.
For example, the rule
</p><p><img src="top2035.png">
gives rise to HOL code as below &#X2014; note the list-lifted usage of the
<code class="verb">is_v_of_t</code> predicate, and the list appends (<span style="font-family:monospace">++</span>) in the conclusion.
</p><pre class="verbatim"><span style="font-size:small">(* reduce_Rec *)  !(l'_t'_list:(label#t) list) 
       (l_v_list:(label#t) list) (l:label) (t:t) (t':t) . 
((EVERY (\(l_,v_). is_v_of_t v_) l_v_list) /\
(( reduce t t' )))
 ==&gt; 
(( reduce (t_Rec (l_v_list ++ [(l,t)] ++ l'_t'_list)) 
          (t_Rec (l_v_list ++ [(l,t')] ++ l'_t'_list))))
</span></pre><p><span style="font-size:small">
</span>For the <span style="font-family:monospace">Proj</span> typing rule </p><p><img src="top2036.png">
we need a specific projection (the
HOL <code class="verb">EL</code>) to
pick out the <span style="font-style:italic">j</span>&#X2019;th element:
</p><pre class="verbatim"><span style="font-size:small">(* Ty_Proj *)  !(l_Typ_list:(label#Typ) list) 
       (j:index) (G:G) (t:t) . 
((( Ty G t (T_Rec (l_Typ_list)) )))
 ==&gt; 
(( Ty 
     G 
     (t_Proj t  ((\ (l_,Typ_) . l_) (EL j l_Typ_list)))  
     ((\ (l_,Typ_) . Typ_) (EL  j l_Typ_list))))
</span></pre><p><span style="font-size:small">
</span>For Coq, when translating away lists, we have to introduce 
yet more list types for 
these proof assistant variables, in addition to the obvious
translation of symbolic terms, and, more substantially, to introduce additional inductive relation
definitions to induct over them.</p><p>For similar examples in Isabelle, the generated Isabelle for the first
three rules of &#XA7;<a href="#a66">12.1</a> is
shown below (lightly hand-edited for format). The first involves an
Isabelle variable <code class="verb">l_t_T_list</code>, and list maps and projections
thereof.
</p><pre class="verbatim"><span style="font-size:small">Ty_RcdI: "
  [|(formula_formuladots ((List.map (%(l_,t_,T_).( ( G , t_ , T_ ) : Ty)) l_t_T_list)))|] 
  ==&gt; 
  ( G , 
    (t_Rec ((List.map (%(l_,t_,T_).(l_,t_)) l_t_T_list))) , 
    (T_Rec ((List.map (%(l_,t_,T_).(l_,T_)) l_t_T_list))) 
  ) : Ty"

Ty_ProjI: "
  [| ( G , t , (T_Rec (l_T_list)) ) : Ty|] ==&gt; 
  ( G , 
    (t_Proj t (%(l_,T_).l_) (List.nth l_T_list (j - 1))) , 
    (%(l_,T_).T_) (List.nth l_T_list (j - 1)) 
  ) : Ty"

E_Ctx_recordI: "
[| List.list_all (%(l_,v_).is_v v_) l_v_list ;
   ( t , t' ) : E|] 
==&gt; 
 ( (t_Rec (l_v_list @ [(l,t)] @ l_'t_'list)) , 
   (t_Rec (l_v_list @ [(l,t')] @ l_'t_'list)) 
 ) : E"
</span></pre><p><span style="font-size:small">
</span>
The generated code for substitutions and free variables takes account of such list structure.</p><p>Note that at present the generated Isabelle code for these functions
does not always build without change, in particular if tuples of size
3 or more are required in patterns.</p>
<!--TOC subsubsection id="sec53" List forms in homomorphisms-->
<h4 id="sec53" class="subsubsection">12.3.3&#X2003;List forms in homomorphisms</h4><!--SEC END --><p>Proof assistant homomorphisms in productions can refer to dot-form
metavariables and nonterminals. For example, the second production
below (taken from <code class="verb">test17.9</code>) mentions <span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">x1 t1 </span><span style="font-family:monospace"><span style="color:#007FFF">...</span></span><span style="font-family:monospace"> xn tn</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span> in the <span style="color:#A51815"><span style="font-family:monospace">isa</span></span>
homomorphism. This must exactly match the dot form in the production
except that all terminals must be omitted &#X2014; the metavariables and
nonterminals must occur in the same order as in the production, and
the bounds must be the same. </p><pre>
    E <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;E_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> ( ident * t ) list  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> &lt; x1 : t1 , <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , xn : tn &gt; <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> 2  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span>  List.rev <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x1 t1 <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> xn tn<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#A51815"><span style="font-family:monospace">formula</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> formula_ <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>          
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> judgement              <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> judgement
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> formula1 <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> formulan   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> dots
</pre><p>
The generated Isabelle code for symbolic
terms mentioning this production will involve a list of pairs. For
example, the rules
</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">defn</span></span>
|- E  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Eok <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Eok_ <span style="color:#A51815"><span style="font-family:monospace">by</span></span>

<span style="color:#007FFF"><span style="font-family:monospace">----------------------------</span></span> :: 2
|- &lt;x1:t1,..,xn:tn&gt; 

|- t1:K1  .. |- tn:Kn
<span style="color:#007FFF"><span style="font-family:monospace">----------------------------</span></span> :: 3
|- &lt;x1:t1,..,xn:tn&gt; 
</pre><p>
generate
</p><pre class="verbatim"><span style="font-size:small">consts
  Eok :: "E set"
inductive Eok tK
intros

(* defn Eok *)

Eok_2I: " ( List.rev  (x_t_list) ) : Eok"

Eok_3I: "[|
(List.list_all (\&lt;lambda&gt; b . b) (  ((List.map (%(x_,t_,K_). ( t_ , K_ ) : tK) x_t_K_list))  ) )|]
 ==&gt; 
 ( List.rev  ((List.map (%(x_,t_,K_).(x_,t_)) x_t_K_list)) ) : Eok"
 </span></pre><p><span style="font-size:small">
</span>
Note that in the second the list of pairs is projected out from the
<code class="verb">x_t_K_list</code> list of triples that is quantified over in the rule.</p>
<!--TOC section id="sec54" Subrules-->
<h2 id="sec54" class="section">13&#X2003;Subrules</h2><!--SEC END --><p><a id="a14"></a>Subrule declarations have the form
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">subrules</span></span>
    nt1 <span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span> nt2
</pre><p>
where <span style="font-family:monospace">nt1</span> and <span style="font-family:monospace">nt2</span> are nonterminal roots. </p><p>Subrules can be chained, i.e.&#X2004;&#X200D;there can be a pair of
subrule declarations <span style="font-family:monospace">nt1 </span><span style="font-family:monospace"><span style="color:#007FFF">&lt;::</span></span><span style="font-family:monospace"> nt2</span> and <span style="font-family:monospace">nt2 </span><span style="font-family:monospace"><span style="color:#007FFF">&lt;::</span></span><span style="font-family:monospace"> nt3</span>,
and they can form a directed acyclic graph, e.g.&#X2004;&#X200D;with 
<span style="font-family:monospace">nt0 </span><span style="font-family:monospace"><span style="color:#007FFF">&lt;::</span></span><span style="font-family:monospace"> nt1</span>, <span style="font-family:monospace">nt0 </span><span style="font-family:monospace"><span style="color:#007FFF">&lt;::</span></span><span style="font-family:monospace"> nt2</span>,
<span style="font-family:monospace">nt1 </span><span style="font-family:monospace"><span style="color:#007FFF">&lt;::</span></span><span style="font-family:monospace"> nt3</span>, and <span style="font-family:monospace">nt2 </span><span style="font-family:monospace"><span style="color:#007FFF">&lt;::</span></span><span style="font-family:monospace"> nt3</span>. However, there cannot be
cycles, or nonterminal roots for which there are multiple upper bounds. 
Subrule declarations should not involve nonterminal roots for which
proof-assistant type homs are specified. </p><p>We support the case in which the upper rule is also
non-free, i.e.&#X2004;&#X200D;it contains productions that mention nonterminals that
occur on the left of a subrule declaration. In the example below
(<span style="font-family:monospace">test11.ott</span>) the
<span style="font-family:monospace">t</span> rule contains a production <span style="font-family:monospace">Foo v</span>.
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> termvar <span style="color:#007FFF"><span style="font-family:monospace">,</span></span> x <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> string <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> nat <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> string <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span> int <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

  <span style="color:#A51815"><span style="font-family:monospace">grammar</span></span>
    t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;t_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                                         
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> x                   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Var                   
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam  <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> x <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span>
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> t t&#X2019;                <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> App                   
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> Foo v               <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Foo

    v <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;v_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                        
      <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam   

  <span style="color:#A51815"><span style="font-family:monospace">subrules</span></span>
    v <span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span> t

  <span style="color:#A51815"><span style="font-family:monospace">defns</span></span>
    Jb <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X201D; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>

      <span style="color:#A51815"><span style="font-family:monospace">defn</span></span>
      Baz t , v <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Baz <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X201D;       <span style="color:#A51815"><span style="font-family:monospace">by</span></span> 

      
<span style="color:#007FFF"><span style="font-family:monospace">      ---------</span></span> :: ax
      Baz t , v
</pre><p>

In this case generated Isabelle/Coq/HOL/OCaml will define a single type and both <span style="font-family:monospace">is_v</span>
and <span style="font-family:monospace">is_t</span> predicates, and the generated inductive definition
clause for <span style="font-family:monospace">ax</span> uses both predicates. The Isabelle clause is below.
</p><pre class="verbatim">  axI: "[|is_t t ; is_v v|] ==&gt;  ( t , v ) : Baz"
</pre>
<!--TOC section id="sec55" Context rules-->
<h2 id="sec55" class="section">14&#X2003;Context rules</h2><!--SEC END --><p><a id="a69"></a>The system supports the definition of single-hole contexts, e.g.&#X2004;&#X200D;for
evaluation contexts. For example, suppose one has a term grammar as below:
</p><pre>
t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;t_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                               <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> term    <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> x                  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Var                   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> variable<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t            <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> x <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> lambda  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> t t&#X2019;               <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> App                   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> app     <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( t1 , <span style="color:#007FFF"><span style="font-family:monospace">....</span></span> , tn ) <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Tuple                 <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> tuple <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( t )              <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">S</span></span><span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Paren                 <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> t / x <span style="font-family:monospace">}</span> t&#X2019;       <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span><span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Tsub  
                        <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> (tsubst_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>)<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> E . t              <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span><span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Ctx  
                        <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> (appctx_E_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>E<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>)<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
                        <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>E<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="font-family:monospace">\</span>cdot <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
A context grammar is declared as a normal grammar but with a single
occurrence of the terminal <code class="verb">__</code> in each production, e.g. as in
the grammar for <span style="font-family:monospace">E</span> below (a rather strange evaluation
strategy, admittedly).
</p><pre>
E <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;E_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                               <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> evaluation context <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> __ t         <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> AppL                   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> app L    <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> v __         <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> AppR                   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> app R    <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . __     <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam                    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> reduce under lambda <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( t1 ( __  t2 ) ) <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Nested              <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> hole nested <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( v1 , <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , vm , __ , t1 , <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , tn ) <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Tuple <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> tuple <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
A <span style="color:#A51815"><span style="font-family:monospace">contextrules</span></span> declaration:
</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">contextrules</span></span>
  E <span style="color:#007FFF"><span style="font-family:monospace">_::</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> t
</pre><p>
causes Ott to (a) check that each production of the <span style="font-family:monospace">E</span> grammar
is indeed a context for the <span style="font-family:monospace">t</span> grammar, and (b) generates
proof assistant functions, e.g.&#X2004;&#X200D;<code class="verb">appctx_E_t</code>, to apply a context
to a term:
</p><pre class="verbatim">(** context application *)
Definition appctx_E_t (E5:E) (t_6:t) : t :=
  match E5 with
  | (E_AppL t5) =&gt; (t_App t_6 t5)
  | (E_AppR v5) =&gt; (t_App v5 t_6)
  | (E_Lam x) =&gt; (t_Lam x t_6)
  | (E_Nested t1 t2) =&gt;  (t_App t1  (t_App t_6 t2) )
  | (E_Tuple v_list t_list) =&gt; (t_Tuple ((app_list_t v_list
     (app_list_t (Cons_list_t t_6 Nil_list_t) (app_list_t t_list Nil_list_t)))))
</pre><p>
As the <span style="font-family:monospace">Nested</span> production shows, context productions can
involve nested term structure.</p><p>Note also that here the <span style="font-family:monospace">E</span> grammar is not free (it mentions the
subrule nonterminal <span style="font-family:monospace">v</span>) so an isvalue predicate
<code class="verb">is_E_of_E</code> is also generated.</p><p>In general, context rule declarations have the form
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">contextrules</span></span>
    ntE <span style="color:#007FFF"><span style="font-family:monospace">_::</span></span> nt1 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> nt2
</pre><p>
where <span style="font-family:monospace">ntE</span>, <span style="font-family:monospace">nt1</span>, and <span style="font-family:monospace">nt2</span> are nonterminal
roots. This declares contexts <span style="font-family:monospace">ntE</span> for the <span style="font-family:monospace">nt1</span>
grammar, with holes in <span style="font-family:monospace">nt2</span> positions.</p><p>Just as for substitutions, the context application function is
typically used by adding a metaproduction to the term grammar. 
Here we add a production <span style="font-family:monospace">E.t</span> to the <span style="font-family:monospace">t</span> grammar with
an <span style="font-family:monospace">icho</span> hom that uses <code class="verb">appctx_E_t</code>.
</p><pre>
t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;t_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>                               <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> term    <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  ...
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> E . t              <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span><span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Ctx  
                        <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> (appctx_E_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>E<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>)<span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
                        <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>E<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="font-family:monospace">\</span>cdot <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
That can then be used in relations:
</p><pre>
    t --&gt; t&#X2019;
<span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span> :: ctx
    E.t --&gt; E.t&#X2019;
</pre><p>One would typically also define a <span style="font-family:monospace">terminals</span> production for
the hole terminal <code class="verb">__</code>, e.g.&#X2004;&#X200D;here we typeset the hole as [&#XB7;].
</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">terminals</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;terminals_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> __           <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> hole    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> [<span style="font-family:monospace">\</span>cdot] <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre>
<!--TOC section id="sec56" Auxiliary Rules-->
<h2 id="sec56" class="section">15&#X2003;Auxiliary Rules</h2><!--SEC END --><p>
We permit an <span style="font-family:monospace">aux</span> hom on grammar rules. For any rule with such a hom,
we transform that rule by appending an <span style="font-family:monospace">_aux</span> to its primary nonterminal
root name. We then add a synthesised rule with the original nonterminal
root name and a single production, with a shape described by the body of 
the aux hom, which must be of the form 
</p><pre class="verbatim">  {{ aux  foo1 foo2 _ bar1 bar2 bar3 }}
</pre><p>
with a single <span style="font-family:monospace">_</span> and any number of strings <span style="font-family:monospace">fooi</span> and <span style="font-family:monospace">barj</span> before and
after. The <span style="font-family:monospace">_</span> is replaced by the original
nonterminal root name. </p><p>For example, given a grammar or metavariable <span style="font-family:monospace">l</span> of source locations, one
might say 
</p><pre class="verbatim">ntr :: 'NTR_'  ::=  {{ aux _ l }}
 | ...
</pre><p>
to synthesise grammars <span style="font-family:monospace">ntr_aux</span> and <span style="font-family:monospace">ntr</span> of unannotated and location-annotated 
terms, the first with all the original productions and the second with a 
single production 
</p><pre class="verbatim"> | ntr l :: :: NTR_aux. 
</pre><p>
If the rule has an empty production name wrapper (eg with <span style="font-family:monospace">&#X2019;&#X2019;</span> in place
of <span style="font-family:monospace">&#X2019;NTR_&#X2019;</span>) then the production name is based on the original
nonterminal root, capitalised and with <span style="font-family:monospace">_aux</span> appended (eg <span style="font-family:monospace">Ntr_aux</span>), to
avoid spurious conflicts.</p><p>An additional <span style="font-family:monospace">auxparams</span> hom on rules lets the user add type
parameters to the generated OCaml output. </p><p>Generation of aux rules is controlled by a command-line option
<span style="font-family:monospace">-generate_aux_rules</span>, which one might (eg) set to false
for latex output and true for OCaml output.</p>
<!--TOC section id="sec57" Functions-->
<h2 id="sec57" class="section">16&#X2003;Functions</h2><!--SEC END --><p>Ott includes experimental support for writing function definitions.
As a simple example, consider the Ott file below:</p><pre>
    <span style="color:#A51815"><span style="font-family:monospace">grammar</span></span>
     n <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;n_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>
       | 0       <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Zero
       | S n     <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Succ

    <span style="color:#A51815"><span style="font-family:monospace">funs</span></span>
      Add <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> hol-proof ...  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#A51815"><span style="font-family:monospace">fun</span></span>
      n1 + n2 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> n <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> add    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> com a function of type num -&gt; num -&gt; num <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#A51815"><span style="font-family:monospace">by</span></span>
      0 + n2 <span style="color:#007FFF"><span style="font-family:monospace">===</span></span> n2
      S n1 + n2 <span style="color:#007FFF"><span style="font-family:monospace">===</span></span> n1 + S n2
</pre><p>Here the <code class="verb">add</code> function is compiled into the following Coq code:</p><pre>
    Fixpoint add (x1:num) (x2:num) : num:=
      match x1,x2 with
      | n_zero , n2 =&gt; n2
      | (n_succ n1) , n2 =&gt;  (add n1 (n_succ n2) ) 
    end.
</pre><p>More in detail, the 
<span style="color:#A51815"><span style="font-family:monospace">fun</span></span>
n1 + n2 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> n <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> add
<span style="color:#A51815"><span style="font-family:monospace">by</span></span>
declaration specifies:
</p><ul class="itemize"><li class="li-itemize">
the name of the function: <code class="verb">add</code>
</li><li class="li-itemize">the symbolic term that defines the lhs: <code class="verb">n1 + n2</code>
</li><li class="li-itemize">the non-terminal that defines the rhs: <code class="verb">n</code>
</li></ul><p>The type of the arguments of the function is defined by the
non-terminals appearing in the lhs, the return type by the rhs
non-terminal (so <code class="verb">num</code> &#X2192; <code class="verb">num</code> &#X2192; <code class="verb">num</code> in the
above example). As side-effect, whenever a function of type
<code class="verb">symb_term</code> &#X2192; <code class="verb">nt</code> is defined, a production
<code class="verb">nt ::= symb_term</code> is added to the definition of the
non-terminal <code class="verb">nt</code> (in the above example, the production
<code class="verb">n1 + n2</code> is added to the grammar of <code class="verb">num</code>).</p><p>Functions are then defined by case analysis, where the lhs and the rhs
are separated by the reserved symbol <span style="color:#007FFF"><span style="font-family:monospace">===</span></span>.</p><p>The <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <code class="verb">hol-proof</code> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> hom
allows the specification of a termination proof, which is required by
Hol. Mutually recursive functions can be defined in the same
<span style="color:#A51815"><span style="font-family:monospace">funs</span></span> block, analogously to mutually recursive rule
definitions.</p><p><em>Disclaimer:</em> the different treatment of partial functions by the
different provers can result in a function definition being compiled
correctly to one prover but not to others.</p>
<!--TOC section id="sec58" Parsing Priorities-->
<h2 id="sec58" class="section">17&#X2003;Parsing Priorities</h2><!--SEC END --><p>Symbolic terms that can have more than one parse tree are typically considered
erroneous; however, certain classes of parse trees are ignored in order to
support common idioms that are ambiguous. For example, the production 
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">&#X393;&#X2004;::=&#X2004;&#X393;<sub>1</sub>,&#X2004;..,&#X2004;&#X393;<sub><span style="font-style:italic">n</span></sub></td></tr>
</table><p>
might be used to allow a list of typing contexts to be appended together, but
it is highly ambiguous. The following restrictions forbid many unwanted parses
that could otherwise occur.
</p><ul class="itemize"><li class="li-itemize">
All parses in which a nonterminal derives itself without consuming any input
are ignored. For example, in the production above, the list could otherwise be
of length one so that &#X393; directly derives &#X393; giving rise to a
vacuous cycle, and an infinite forest of parse trees. This restriction
ensures that only the tree without the vacuous cycle is considered.
</li><li class="li-itemize">The parser for a list form ignores parses that unnecessarily break up the list
due to (direct or indirect) self reference. For example,
&#X393;<sub>1</sub>,&#X393;<sub>2</sub>,&#X393;<sub>3</sub>,&#X393;<sub>4</sub> will not parse as a two element sequence
of two element sequences (&#X393;<sub>1</sub>,&#X393;<sub>2</sub>),(&#X393;<sub>3</sub>,&#X393;<sub>4</sub>) given the
production above.
</li><li class="li-itemize">User supplied priority annotations in a <span style="color:#A51815"><span style="font-family:monospace">parsing</span></span> section rule out certain
trees as follows:
<ul class="itemize"><li class="li-itemize">
<span style="font-style:italic">prodname</span><sub>1</sub> <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> <span style="font-style:italic">prodname</span><sub>2</sub>: Parse trees where a
<span style="font-style:italic">prodname</span><sub>1</sub> node is a child of a <span style="font-style:italic">prodname</span><sub>2</sub> node are
ignored.
</li><li class="li-itemize"><span style="font-style:italic">prodname</span><sub>1</sub>&#X2004;&#X200D;<span style="color:#A51815"><span style="font-family:monospace">right</span></span>&#X2004;&#X200D;<span style="font-style:italic">prodname</span><sub>2</sub>: Parse trees where a
<span style="font-style:italic">prodname</span><sub>1</sub> node is the leftmost child of a <span style="font-style:italic">prodname</span><sub>1</sub>
node are ignored.
</li><li class="li-itemize"><span style="font-style:italic">prodname</span><sub>1</sub>&#X2004;&#X200D;<span style="color:#A51815"><span style="font-family:monospace">left</span></span>&#X2004;&#X200D;<span style="font-style:italic">prodname</span><sub>2</sub>: Parse trees where a
<span style="font-style:italic">prodname</span><sub>2</sub> node is the rightmost child of a <span style="font-style:italic">prodname</span><sub>1</sub>
node are ignored.
</li></ul>
In addition to immediate children, these priority annotations also prohibit
parse trees where the forbidden child node occurs underneath a chain of
derivations from the specified parent when the chain does not consume any
input.
Figure&#X2004;&#X200D;<a href="#parsing_figure">17</a> demonstrates a typical use of a <span style="color:#A51815"><span style="font-family:monospace">parsing</span></span>
section; the declarations have effect as follows:
<ul class="itemize"><li class="li-itemize">
Line #1: <code class="verb">n + n + n</code> parses as <code class="verb">(n + n) + n</code>, but not <code class="verb">n + (n + n)</code>;
</li><li class="li-itemize">Line #3: <code class="verb">n + n - n</code> parses as <code class="verb">(n + n) - n</code>, but not <code class="verb">n + (n - n)</code>;
</li><li class="li-itemize">Line #9: <code class="verb">-n + n</code> parses as <code class="verb">(-n) + n</code>, but not <code class="verb">-(n + n)</code>;
</li><li class="li-itemize">Line #15: <code class="verb">n + n n</code> parses as <code class="verb">n + (n n)</code>, but not <code class="verb">(n + n) n</code>;
<code class="verb">n n + n</code> parses as <code class="verb">(n n) + n</code>, but not <code class="verb">n (n + n)</code>;
</li><li class="li-itemize">Line #20: <code class="verb">n, n n, n</code> parses as <code class="verb">n, (n n), n</code>, but not <code class="verb">(n, n) (n, n)</code>.
</li></ul>
Currently, the <span style="color:#A51815"><span style="font-family:monospace">parsing</span></span> section supports only these relatively low level
and verbose declarations.
</li></ul><blockquote class="figure"><div class="center"><hr class="floatrule"></div><pre>
<pre>
<span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> n <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>

<span style="color:#A51815"><span style="font-family:monospace">grammar</span></span>

e <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> e_ <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> 
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> n             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> num
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> - e           <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> neg
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> e1 + e2       <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> add
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> e1 - e2       <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> sub
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> e1 e2         <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> mul
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> e1 / e2       <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> div
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> e1 , <span style="color:#007FFF"><span style="font-family:monospace">..</span></span> , e2  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tup
<span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( e )         <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> par <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">icho</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>e<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

<span style="color:#A51815"><span style="font-family:monospace">parsing</span></span>

e_add <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_add   % #1
e_sub <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_sub
e_add <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_sub   % #3
e_sub <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_add

e_mul <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_mul
e_div <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_div
e_mul <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_div
e_div <span style="color:#A51815"><span style="font-family:monospace">left</span></span> e_mul

e_neg <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_add     % #9
e_neg <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_sub
e_neg <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_mul
e_neg <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_div
e_neg <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_tup

e_add <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_div
e_add <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_mul     % #15
e_add <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_tup
e_sub <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_div
e_sub <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_mul
e_sub <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_tup

e_mul <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_tup     % #20
e_div <span style="color:#007FFF"><span style="font-family:monospace">&lt;=</span></span> e_tup

</pre>

<a id="parsing_figure"></a>
</pre><div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 14: An Ott source file for basic arithmetic using the typical parsing priorities</td></tr>
</table></div><div class="center"><hr class="floatrule"></div></blockquote>
<!--TOC section id="sec59" Combining multiple source files-->
<h2 id="sec59" class="section">18&#X2003;Combining multiple source files</h2><!--SEC END --><p>
Ott can be invoked with multiple source files.
Input filenames with extensions <span style="font-family:monospace">.tex</span>, <span style="font-family:monospace">.v</span>,
<span style="font-family:monospace">.thy</span>, <span style="font-family:monospace">.sml</span>, or <span style="font-family:monospace">ml</span> are simply copied into
the relevant output (L<sup>A</sup>T<sub>E</sub>X, Coq, Isabelle, HOL, or OCaml). 
By default the source-file and command-line order of blocks is preserved, for grammar,
embeds, and inductive definitions.</p><p>The prover output can be split into multiple output files: each prover
output file specified with <span style="font-family:monospace">-o &lt;filename&gt;</span> will contain the material
from the previous input files specified with <span style="font-family:monospace">-i</span> (since the last <span style="font-family:monospace">-o</span>
for the same prover).</p><p>Alternatively, one can add a <span style="font-family:monospace">-merge true</span> command-line option,
in which case
the productions of multiple grammars that share the same header
are merged into a single grammar, and the rules of multiple
inductive definitions that share the same header are merged into a
single inductive definition. 
This rudimentary form of modularity can be very useful, either to
split a language definition into separate features, or to define
reusable Ott components to define standard formulae, LaTeX pretty
printing of terminals, or LaTeX styles. 
For example, Figure&#X2004;&#X200D;<a href="#a12">15</a> shows the Ott source file for a
<span style="font-family:monospace">let</span> feature in isolation, taken from our Ott development of
some languages from Pierce&#X2019;s TAPL&#X2004;&#X200D;[<a href="#Pierce%3ATypeSystems"></a>].
</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox">&#X2004;<div class="minipage">
<pre><span style="font-size:small">
</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">grammar</span></span></span><span style="font-size:small">
t </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Tm </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small">                                        </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> terms: </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">
  </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">|</span></span></span><span style="font-size:small"> let x = t in t&#X2019;                   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small">   </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> Let </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">(+</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">bind</span></span></span><span style="font-size:small"> x </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">in</span></span></span><span style="font-size:small"> t&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">+)</span></span></span><span style="font-size:small">     </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> let binding </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small">


</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defns</span></span></span><span style="font-size:small"> 
Jop </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small"> 

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defn</span></span></span><span style="font-size:small"> 
t --&gt; t&#X2019; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> red </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> E_ </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> Evaluation </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">by</span></span></span><span style="font-size:small">

</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">-----------------------------</span></span></span><span style="font-size:small"> :: LetV
let x=v1 in t2 --&gt; [x|-&gt;v1]t2 

t1 --&gt; t1&#X2019;
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">----------------------------------</span></span></span><span style="font-size:small"> :: Let
let x=t1 in t2 --&gt; let x=t1&#X2019; in t2


</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defns</span></span></span><span style="font-size:small">
Jtype </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> &#X201D; </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></span><span style="font-size:small"> 

</span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">defn</span></span></span><span style="font-size:small">
G |- t : T </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> typing </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">::</span></span></span><span style="font-size:small"> T_ </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">{</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">com</span></span></span><span style="font-size:small"> Typing </span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">}</span></span></span><span style="font-size:small"> </span><span style="font-size:small"><span style="color:#A51815"><span style="font-family:monospace">by</span></span></span><span style="font-size:small">

G |- t1:T1
G,x:T1 |- t2:T2
</span><span style="font-size:small"><span style="color:#007FFF"><span style="font-family:monospace">------------------------</span></span></span><span style="font-size:small"> :: Let
G |- let x=t1 in t2 : T2
</span></pre><span style="font-size:small">
</span></div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 15: An <span style="font-family:monospace">ott</span> source file for the <span style="font-family:monospace">let</span> fragment of TAPL<a id="a12"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><p>
The original TAPL languages were produced using
TinkerType&#X2004;&#X200D;[<a href="#LevinPierce99"></a>] to compose features and check for
conflicts. 
In <span style="font-family:monospace">examples/tapl</span> we build a system, similar to the TinkerType
<span style="font-family:monospace">sys-fullsimple</span>, from <span style="font-family:monospace">ott</span> source files that
correspond roughly to the various TinkerType components, each with
syntax and semantic rules for a single feature. </p>
<!--TOC section id="sec60" Hom blocks-->
<h2 id="sec60" class="section">19&#X2003;Hom blocks</h2><!--SEC END --><p>
Bindspecs and homomorphisms for productions, and any homomorphisms
for definitions, can appear in an Ott source file either 
attached to the production or definition, as we have shown earlier, or
in separate hom blocks.
For example, one can write
</p><pre>
<span style="color:#A51815"><span style="font-family:monospace">homs</span></span> &#X2019;t_&#X2019;
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam  <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> x <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span>  

<span style="color:#A51815"><span style="font-family:monospace">homs</span></span> &#X2019;t_&#X2019;
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Var     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> variable <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>         
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> abstraction <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>      
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> App     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> application <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>      
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> paren   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">ich</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsub    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">ich</span></span> ( tsubst_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> ) <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

<span style="color:#A51815"><span style="font-family:monospace">homs</span></span> &#X201D;
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> reduce  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t1<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> reduces to <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t2<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
</pre><p>
Each of these begins with a prefix and then has a sequence of
production name or definition name kernels, each followed by a
sequence of bindspecs and then a sequence of homomorphisms.</p><p>The <code class="verb">test10_homs.ott</code> example, in Fig.&#X2004;&#X200D;<a href="#a38">16</a>, shows this. It
is semantically equivalent to the <code class="verb">test10.ott</code> example of
Fig.&#X2004;&#X200D;<a href="#a68">8</a>, but the homs have been moved into <span style="font-family:monospace">hom</span>
blocks.
</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<span class="lrbox framebox"><div class="minipage">
<pre>
<span style="color:#A51815"><span style="font-family:monospace">metavar</span></span> termvar <span style="color:#007FFF"><span style="font-family:monospace">,</span></span> x <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span> 
  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> string <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> nat <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> string <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">lex</span></span> alphanum <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>mathit<span style="font-family:monospace">{</span><span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>termvar<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="font-family:monospace">}</span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span>  term variable  <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 

<span style="color:#A51815"><span style="font-family:monospace">grammar</span></span>
  t <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;t_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> term <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> x                   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Var   
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam  
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> t t&#X2019;                <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> App  
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> ( t )               <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">S</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> paren 
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">{</span> t / x <span style="font-family:monospace">}</span> t&#X2019;        <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#A51815"><span style="font-family:monospace">M</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsub  

  v <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;v_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span>  value <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam   

  <span style="color:#A51815"><span style="font-family:monospace">terminals</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;terminals_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span>                   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> lambda  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>lambda <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> --&gt;                 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> red     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>longrightarrow <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>


<span style="color:#A51815"><span style="font-family:monospace">homs</span></span> &#X2019;t_&#X2019;
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam  <span style="color:#007FFF"><span style="font-family:monospace">(+</span></span> <span style="color:#A51815"><span style="font-family:monospace">bind</span></span> x <span style="color:#A51815"><span style="font-family:monospace">in</span></span> t <span style="color:#007FFF"><span style="font-family:monospace">+)</span></span>  

<span style="color:#A51815"><span style="font-family:monospace">homs</span></span> &#X2019;t_&#X2019;
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Var     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> variable <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>         
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> abstraction <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>      
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> App     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> application <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>      
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> paren   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">ich</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsub    <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">ich</span></span> ( tsubst_t <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>x<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> ) <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>

<span style="color:#A51815"><span style="font-family:monospace">homs</span></span> &#X201D;
  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> reduce  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">com</span></span> $<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t1<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>$ reduces to $<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t2<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span>$ <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> 


<span style="color:#A51815"><span style="font-family:monospace">subrules</span></span>
  v <span style="color:#007FFF"><span style="font-family:monospace">&lt;::</span></span> t

<span style="color:#A51815"><span style="font-family:monospace">substitutions</span></span>
  <span style="color:#A51815"><span style="font-family:monospace">single</span></span> t x <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> tsubst 

<span style="color:#A51815"><span style="font-family:monospace">defns</span></span>
  Jop <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X201D; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>

    <span style="color:#A51815"><span style="font-family:monospace">defn</span></span>
    t1 --&gt; t2 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> reduce <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X201D; <span style="color:#A51815"><span style="font-family:monospace">by</span></span> 


<span style="color:#007FFF"><span style="font-family:monospace">    --------------------------</span></span>  :: ax_app
    (<span style="font-family:monospace">\</span>x.t12) v2 --&gt;  <span style="font-family:monospace">{</span>v2/x<span style="font-family:monospace">}</span>t12

    t1 --&gt; t1&#X2019;
<span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span> :: ctx_app_fun
    t1 t --&gt; t1&#X2019; t

    t1 --&gt; t1&#X2019;
<span style="color:#007FFF"><span style="font-family:monospace">    --------------</span></span> :: ctx_app_arg
    v t1 --&gt; v t1&#X2019;

</pre>

</div></span>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 16: Hom Sections: <span style="font-family:monospace">test10_homs.ott</span><a id="a38"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote>
<!--TOC section id="sec61" Isabelle syntax support-->
<h2 id="sec61" class="section">20&#X2003;Isabelle syntax support</h2><!--SEC END --><p><a id="a39"></a>Ott has limited facilities to allow the Isabelle mixfix syntax support
and xsymbol to be used. The example <code class="verb">test10_isasyn.ott</code> shows
this in use. 
</p><p>Non-meta productions can be annotated with
<span style="color:#A51815"><span style="font-family:monospace">isasyn</span></span> and/or <span style="color:#A51815"><span style="font-family:monospace">isaprec</span></span> homomorphisms. 
For example, <code class="verb">test10_isasyn.ott</code> contains the production
</p><pre>
  <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> t t&#X2019;      <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> App   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isasyn</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span><span style="font-family:monospace">\</span>&lt;bullet&gt;<span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t&#X2019;<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isaprec</span></span> 50 <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
The two homs are used to output the Isabelle syntax annotation in the
<code class="verb">t_App</code> clause of the datatype definition below.
</p><pre class="verbatim"><span style="font-size:small">t = 
   t_Var "termvar"  
 | t_Lam "termvar" "t"  ("\&lt;lambda&gt; _ . _" 60)
 | t_App "t" "t"  ("_\&lt;bullet&gt;_" 50)
</span></pre><p><span style="font-size:small">
</span>
Definitions can be annotated with
<span style="color:#A51815"><span style="font-family:monospace">isasyn</span></span> and/or <span style="color:#A51815"><span style="font-family:monospace">isaprec</span></span> homomorphisms similarly, e.g.&#X2004;&#X200D;as below.
</p><pre>
    <span style="color:#A51815"><span style="font-family:monospace">defn</span></span>
    t1 --&gt; t2 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> reduce <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X201D; <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isasyn</span></span> <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t1<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> ---&gt; <span style="color:#007FFF"><span style="font-family:monospace">[[</span></span>t2<span style="color:#007FFF"><span style="font-family:monospace">]]</span></span> <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>  <span style="color:#A51815"><span style="font-family:monospace">by</span></span> 
</pre><p>
This generates <code class="verb">syntax</code> and <code class="verb">translations</code> blocks as below.
</p><pre class="verbatim"><span style="font-size:small">inductive_set reduce :: "(t*t) set"
and  "reduce'" :: "t =&gt; t =&gt;  bool" ("_ ---&gt; _" 50)
where "(t1 ---&gt; t2) ==  ( t1 , t2 ) : reduce"
</span></pre><p><span style="font-size:small">
</span>
Symbolic terms in definitions are printed using any production or
definition syntax. This (especially with xsymbol turned on) makes the
current goal state during Isabelle proof development much more
readable. </p><p>Further, there is a command line option <code class="verb">-isa_syntax true</code>. If
this is set then the tool generates Isabelle syntax annotations from
the source syntax. For example, the source file production for the
<code class="verb">t_Lam</code> clause is
</p><pre>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span> x . t             <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> Lam   <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isaprec</span></span> 60 <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
and the <code class="verb">terminals</code> grammar contains a mapping from <code class="verb">\</code> to <code class="verb">\&lt;lambda&gt;</code>:
</p><pre>
  <span style="color:#A51815"><span style="font-family:monospace">terminals</span></span> <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> &#X2019;terminals_&#X2019; <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> <span style="font-family:monospace">\</span>                   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> lambda  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>lambda <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>  <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> <span style="font-family:monospace">\</span>&lt;lambda&gt; <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
    <span style="color:#007FFF"><span style="font-family:monospace">|</span></span> --&gt;                 <span style="color:#007FFF"><span style="font-family:monospace">::</span></span>   <span style="color:#007FFF"><span style="font-family:monospace">::</span></span> red     <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">tex</span></span> <span style="font-family:monospace">\</span>longrightarrow <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span> <span style="color:#007FFF"><span style="font-family:monospace">{</span></span><span style="color:#007FFF"><span style="font-family:monospace">{</span></span> <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> ---&gt; <span style="color:#007FFF"><span style="font-family:monospace">}</span></span><span style="color:#007FFF"><span style="font-family:monospace">}</span></span>
</pre><p>
This is used (just as for LaTeX homs) to generate the <code class="verb">("\&lt;lambda&gt; _ . _" 60)</code>
in the datatype definition above.</p><p>This functionality is limited in various ways:
(1) the full range of Isabelle precedence and associativity
specifications are not supported;
(2) the automatically generated syntax annotations are somewhat crude,
especially w.r.t.&#X2004;&#X200D;spacing and parenthesisation;
(3) syntax annotation on meta productions is not propertly supported;
and
(4) it would be desirable to have more fine-grain control of whether
to automatically generate annotations: per-production, per-rule, and
per-file.</p>
<!--TOC section id="sec62" Isabelle code generation example-->
<h2 id="sec62" class="section">21&#X2003;Isabelle code generation example</h2><!--SEC END --><p><a id="a22"></a>The Isabelle/Coq/HOL code generation facilities can be sometimes used to
generate (variously) OCaml and SML code from the Isabelle/Coq/HOL
definitions produced by Ott.</p><p>For example, the <code class="verb">test10st_codegen.thy</code> file uses Isabelle
code generation to produce SML code to calculate the possible
reductions of terms in the <code class="verb">test10st.ott</code> simply typed lambda
calculus.</p><pre class="verbatim">theory test10st_codegen 
imports test10st_snapshot_out Executable_Set
begin

ML "reset Codegen.quiet_mode"

(* Code generation for the test10st simply typed lambda calculus. *)

constdefs
 ta :: t
"ta == (t_App (t_Lam ''z'' (t_Var ''z''))) (t_Lam ''y'' (t_Var ''y''))"
;

code_module Test10st_codegen file "test10st_codegen.ml" contains 
(*is_v
tsubst_T
tsubst_t*)
reduce_ta  = "(ta,_):reduce"


(* ...to build and demo the resulting test10st_codegen.ml code...

Isabelle test10st_codegen.thy
...`use' that...

...in a shell...
isabelle
use "test10st_codegen.ml";
open Test10st_codegen;

...a test term...
ta;
val it = t_App (t_Lam (["z"], t_Var ["z"]), t_Lam (["y"], t_Var ["y"]))

...a sample reduction...
DSeq.hd(reducep__1 ta);
val it = t_Lam (["y"], t_Var ["y"]) : Test10st_codegen.t 

*)

end
</pre>
<!--TOC section id="sec63" Reference: Command-line usage-->
<h2 id="sec63" class="section">22&#X2003;Reference: Command-line usage</h2><!--SEC END --><p><a id="a32"></a>A good place to get started is one of the test
<span style="font-family:monospace">make</span> targets in the <span style="font-family:monospace">ott</span> directory, e.g.
</p><pre class="verbatim">test10: tests/test10.ott
           bin/ott                                                \
                  -i tests/test10.ott                             \ 
                  -o out.thy -o out.v -o outScript.sml            \
                  -o out.tex                                      \
                  -parse ":t:  (\z.z z) y"                        \                  
           &amp;&amp; ($(LATEX) out; $(DVIPS) out -o)
</pre><p>
When <code class="verb">make test10</code> is executed, <span style="font-family:monospace">ott</span>:
</p><ul class="itemize"><li class="li-itemize">
reads the source file <code class="verb">tests/test10.ott</code>
</li><li class="li-itemize">(if one also specifies <span style="font-family:monospace">-show_sort true</span> and <span style="font-family:monospace">-show_defns
true</span>) prints on standard output various diagnostic information,
including ASCII versions of the grammar and
inductive definitions.
By default these are coloured (using
<code class="verb">vt220</code> control codes) with metavariables in red, nonterminals
in yellow, terminals in green, and object variables in white.
Scanning over this output quickly picks up some common errors.
</li><li class="li-itemize">parses the symbolic term <code class="verb">(\z.z z) y</code> using the <code class="verb">t</code>
grammar and prints the result to standard output
</li><li class="li-itemize">generates Isabelle definitions in the file <code class="verb">out.thy</code>
</li><li class="li-itemize">generates Coq definitions in the file <code class="verb">out.v</code>
</li><li class="li-itemize">generates HOL definitions in the file <code class="verb">outScript.sml</code>
</li><li class="li-itemize">generates a LaTeX document in the file <code class="verb">out.tex</code>, with a
standard document preamble to make it self-contained.
</li></ul><p>
That LaTeX document is then compiled and converted to postscript. </p><p>For convenience, input files can also be listed at the end of the command line:
</p><pre class="verbatim">  ott [options] &lt;file1&gt; ... &lt;filen&gt;
</pre><p>
is equivalent to
</p><pre class="verbatim">  ott -i &lt;file1&gt; ... -i &lt;filen&gt; [options]
</pre><p>The&#X2004;&#X200D;<code class="verb">%.out</code> <code class="verb">Makefile</code> target runs <code class="verb">ott</code> with common
defaults on the file&#X2004;&#X200D;<code class="verb">%.ott</code>, so for example executing <code class="verb">make tests/test10.out</code>
runs <code class="verb">ott</code> on <code class="verb">tests/test10.ott</code>, generating all outputs. There are
also targets &#X2004;&#X200D;<code class="verb">%.coq.out</code>, &#X2004;&#X200D;<code class="verb">%.hol.out</code>, and
&#X2004;&#X200D;<code class="verb">%.isa.out</code>, to generate just LaTeX and the code for one proof
assistant, and &#X2004;&#X200D;<code class="verb">%.tex.out</code>, to generate just LaTeX.</p><p>The <span style="font-family:monospace">ott</span> command-line options (with default values where applicable) are
shown below. 
</p><pre class="verbatim">Ott version 0.33   distribution of Mon 16 Jan 15:32:01 GMT 2023

usage: ott &lt;options&gt; &lt;filename1&gt; .. &lt;filenamen&gt; 
  (use "OCAMLRUNPARAM=p  ott ..." to show the ocamlyacc trace)
  (ott &lt;options&gt; &lt;filename1&gt; .. &lt;filenamen&gt;    is equivalent to
   ott -i &lt;filename1&gt; .. -i &lt;filenamen&gt; &lt;options&gt;)

  -i &lt;filename&gt;                      Input file (can be used multiple times)
  -o &lt;filename&gt;                      Output file (can be used multiple times)
  -writesys &lt;filename&gt;               Output system definition
  -readsys &lt;filename&gt;                Input system definition
  -tex_filter &lt;src&gt;&lt;dst&gt;             Files to TeX filter
  -coq_filter &lt;src&gt;&lt;dst&gt;             Files to Coq filter
  -hol_filter &lt;src&gt;&lt;dst&gt;             Files to HOL filter
  -lem_filter &lt;src&gt;&lt;dst&gt;             Files to HOL filter
  -isa_filter &lt;src&gt;&lt;dst&gt;             Files to Isabelle filter
  -ocaml_filter &lt;src&gt;&lt;dst&gt;           Files to OCaml filter
  -merge &lt;false&gt;                     merge grammar and definition rules
  -parse &lt;string&gt;                    Test parse symterm,eg ":nontermroot: term"
  -fast_parse &lt;false&gt;                do not parse :rulename: pseudoterminals
  -signal_parse_errors &lt;false&gt;       return &gt;0 if there are bad defns
  -picky_multiple_parses &lt;false&gt;     Picky about multiple parses
  -quotient_rules &lt;true&gt;             Quotient rules, as per {{ quotient-with ntr }} homs
  -generate_aux_rules &lt;true&gt;         Generate auxiliary rules or constructor arguments from {{ aux ... }} homs
  -aux_style_rules &lt;true&gt;            Auxiliary rules (true) vs constructor arguments (false)
  -output_source_locations &lt;0&gt;       Include source location info in output (0=none, 1=drules, 2=grammar+drules)
  -colour &lt;true&gt;                     Use (vt220) colour for ASCII pretty print
  -show_sort &lt;false&gt;                 Show ASCII pretty print of syntax
  -show_defns &lt;false&gt;                Show ASCII pretty print defns
  -tex_show_meta &lt;true&gt;              Include meta prods and rules in TeX output
  -tex_show_categories &lt;false&gt;       Signal production flags in TeX output
  -tex_suppress_category &lt;[]&gt;        Suppress productions and rules with this category in TeX output
  -tex_suppress_ntr &lt;[]&gt;             Suppress nonterminal root in TeX output
  -tex_colour &lt;true&gt;                 Colour parse errors in TeX output
  -tex_wrap &lt;true&gt;                   Wrap TeX output in document pre/postamble
  -tex_name_prefix &lt;string&gt;          Prefix for tex commands (default "ott")
  -isabelle_primrec &lt;true&gt;           Use "primrec" instead of "fun"
                                       for functions
  -isabelle_inductive &lt;true&gt;         Use "inductive" instead of "inductive_set"
                                       for relations
  -isa_syntax &lt;false&gt;                Use fancy syntax in Isabelle output
  -isa_generate_lemmas &lt;false&gt;       Lemmas for collapsed functions in Isabelle
  -coq_avoid &lt;1&gt;                     coq type-name avoidance
                                       (0=nothing, 1=avoid, 2=secondaryify)
  -coq_expand_list_types &lt;false&gt;     Expand list types in Coq output
  -coq_lngen &lt;false&gt;                 lngen compatibility
  -coq_names_in_rules &lt;true&gt;         Copy user names in rule definitions
  -coq_use_filter_fn &lt;false&gt;         Use list_filter instead of list_minus2 in substitutions
  -ocaml_include_terminals &lt;false&gt;   Include terminals in OCaml output (experimental!)
  -ocaml_pp                          &lt;target.ml filename&gt; generate OCaml AST pretty printer files (experimental!) (also included in .mly target)
  -ocaml_pp_ast_module               override default OCaml module name for AST module (experimental!)
  -ocaml_pp_json &lt;false&gt;             Include JSON output in pretty printer (experimental)
  -pp_grammar                        (debug) print term grammar
  -dot &lt;filename&gt;                    (debug) dot graph of syntax dependencies
  -alltt &lt;filename&gt;                  (debug) alltt output of single source file
  -sort &lt;true&gt;                       (debug) do topological sort
  -process_defns &lt;true&gt;              (debug) process inductive reln definitions
  -showraw &lt;false&gt;                   (debug) show raw grammar
  -ugly &lt;false&gt;                      (debug) use ugly ASCII output
  -no_rbcatn &lt;true&gt;                  (debug) remove relevant bind clauses
  -lem_debug                         (debug) print lem debug locations
  -help                              Display this list of options
  --help                             Display this list of options
</pre>
<!--TOC section id="sec64" Reference: The language of symbolic terms-->
<h2 id="sec64" class="section">23&#X2003;Reference: The language of symbolic terms</h2><!--SEC END --><p><a id="a17"></a>A syntax definition conceptually defines two different languages: that
of concrete terms of the object language, and that of symbolic terms
over the object language. 
The former includes concrete variables (if nontrivial <code class="verb">lex</code> homs
have been specified for metavariables). 
The latter includes the former but also
allows symbolic metavariables and nonterminals.
Symbolic terms may also include the production-name
annotations mentioned in &#XA7;<a href="#a51">3</a>.
For a syntax definition with list forms (c.f.&#X2004;&#X200D;&#XA7;<a href="#a61">12</a>) symbolic
terms also include various list constructs.
A simplified abstract syntax of symbolic terms is shown in
Figure&#X2004;&#X200D;<a href="#a19">17</a>, omitting list forms. In this section we give an
informal definition of the full concrete syntax of symbolic terms.
</p><blockquote class="figure"><div class="center"><hr class="floatrule"></div>
<img src="top2037.png"><div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 17: Mini-Ott in Ott: symbolic terms<a id="a19"></a></td></tr>
</table></div>
<div class="center"><hr class="floatrule"></div></blockquote><p>The premises and conclusions of inductive definition rules are
symbolic terms. 
The language of symbolic terms is defined informally below, with interpretation functions [[_]] that map defined entities into grammar clauses.</p><p>For a rule <span style="font-style:italic">rule</span> &#X202F; = 
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">nontermroot</span><sub>1</sub>&#X2004;&#X202F;&#X2004;,&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;,&#X2004;&#X202F;&#X2004;<span style="font-style:italic">nontermroot</span><sub><span style="font-style:italic">n</span></sub>&#X2004;<span style="font-family:monospace">::</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">&#X2019;&#X2019;</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">::=</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">prod</span><sub>1</sub>&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;<span style="font-style:italic">prod</span><sub><span style="font-style:italic">m</span></sub>&#X2004;</td></tr>
</table><p>
we have
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">rule</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">nontermroot</span>&#X2004;<span style="font-style:italic">suffix</span></td><td style="text-align:left;white-space:nowrap" >(1)&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" >[[<span style="font-style:italic">prod</span><sub>1</sub>]]&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" >..&#X2004;&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" >[[<span style="font-style:italic">prod</span><sub><span style="font-style:italic">m</span></sub>]]&#X2004;
</td></tr>
</table></td></tr>
</table><p>(1) for each <span style="font-style:italic">nontermroot</span> in the set
{<span style="font-style:italic">nontermroot</span><sub>1</sub> &#X202F; , &#X202F; .. &#X202F; , &#X202F;
<span style="font-style:italic">nontermroot</span><sub><span style="font-style:italic">n</span></sub> } 
and for each <span style="font-style:italic">nontermroot</span> defined by any <span style="font-style:italic">rule</span>&#X2032;
which is declared as a subrule of this rule. </p><p>For a production  <span style="font-style:italic">prod</span> &#X202F; = 
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-family:monospace">|</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">m</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">::</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">::</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">prodname</span></td></tr>
</table><p>
we have
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">prod</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" >[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">m</span></sub>]]&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">:</span><span style="font-style:italic">prodname</span><span style="font-family:monospace">:</span>&#X202F;&#X2004;[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">m</span></sub>]]&#X2004;
</td></tr>
</table></td></tr>
</table><p>For an element there are various cases. 
</p><ol class="enumerate" type=1><li class="li-enumerate">
For a terminal <span style="font-style:italic">terminal</span>
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">terminal</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">terminal</span></td></tr>
</table></td></tr>
</table>
</li><li class="li-enumerate">For a nonterminal <span style="font-style:italic">nontermroot</span> &#X202F; <span style="font-style:italic">suffix</span>
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">nontermroot</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">suffix</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >[[<span style="font-style:italic">rule</span>]]&#X2004;
</td></tr>
</table></td></tr>
</table>
where <span style="font-style:italic">rule</span> includes <span style="font-style:italic">nontermroot</span> among the
nonterminal roots it defines. (Note that this does not depend on what <span style="font-style:italic">suffix</span> was used in the grammar, and similarly for the <span style="font-style:italic">metavar</span> case below.)</li><li class="li-enumerate">For an index variable <span style="font-style:italic">indexvarroot</span>
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">indexvarroot</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">indexvarroot</span>&#X2032;
</td></tr>
</table></td></tr>
</table>
for each <span style="font-style:italic">indexvarroot</span>&#X2032; defined by the <span style="font-family:monospace">indexvar</span>
definition that defines <span style="font-style:italic">indexvarroot</span>.</li><li class="li-enumerate">For a metavariable <span style="font-style:italic">metavarroot</span> &#X202F; <span style="font-style:italic">suffix</span>
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">metavarroot</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">suffix</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">metavarroot</span>&#X2032;&#X2004;<span style="font-style:italic">suffix</span></td><td style="text-align:left;white-space:nowrap" >(1)&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">variable</span>&#X2004;</td></tr>
</table></td></tr>
</table>
(1) for each <span style="font-style:italic">metavarroot</span>&#X2032; defined by the <span style="font-family:monospace">metavar</span>
definition that defines <span style="font-style:italic">metavarroot</span>.
(2) where <span style="font-style:italic">variable</span> ranges over all the strings defined by
the <span style="font-family:monospace">lex</span> regexp of the <span style="font-family:monospace">metavar</span>
definition that defines <span style="font-style:italic">metavarroot</span>, except for any string
which can be parsed as a nonterminal, metavariable or terminal of the syntax
definition.
</li><li class="li-enumerate">A list form element <span style="font-style:italic">element</span> could be any of the following, either without a separating terminal:
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;
&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2004;&#X202F;
<span style="font-style:italic">element</span>&#X2032;<sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span>&#X2032;<sub><span style="font-style:italic">n</span></sub>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">number</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">number</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2032;<span style="font-family:monospace">-1</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
</table></td></tr>
</table>
or with a separating terminal:
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;
&#X202F;&#X2004;<span style="font-style:italic">terminal</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">terminal</span>&#X2004;&#X202F;
<span style="font-style:italic">element</span>&#X2032;<sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span>&#X2032;<sub><span style="font-style:italic">n</span></sub>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;<span style="font-style:italic">terminal</span>&#X202F;<span style="font-family:monospace">//</span>&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;<span style="font-style:italic">terminal</span>&#X202F;<span style="font-family:monospace">//</span>&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;<span style="font-style:italic">terminal</span>&#X202F;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">number</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;<span style="font-style:italic">element</span><sub>1</sub>&#X2004;..&#X2004;<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X2004;&#X202F;<span style="font-style:italic">terminal</span>&#X202F;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">number</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2032;<span style="font-family:monospace">-1</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
</table></td></tr>
</table>
In any of these cases the interpretation [[<span style="font-style:italic">element</span>]] is the lists (separated by the <span style="font-style:italic">terminal</span> if one was specified) of concrete list entries and of list forms.
Without a separating <span style="font-style:italic">terminal</span>, this is: 
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">element</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >(<span style="font-style:italic">concrete</span>_<span style="font-style:italic">list</span>_<span style="font-style:italic">entry</span>&#X2004;|&#X2004;<span style="font-style:italic">list</span>_<span style="font-style:italic">form</span>)<sup>*</sup></td><td style="text-align:left;white-space:nowrap" >(2),&#X2004;(3)</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">concrete</span>_<span style="font-style:italic">list</span>_<span style="font-style:italic">entry</span></td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>]]&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">list</span>_<span style="font-style:italic">form</span></td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" >[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>]]&#X2004;
&#X202F;<span style="font-style:italic">dots</span>&#X2032;&#X202F;
[[<span style="font-style:italic">element</span>&#X2032;<sub>1</sub>]]&#X2004;&#X202F;&#X2004;..&#X2004;&#X202F;&#X2004;[[<span style="font-style:italic">element</span>&#X2032;<sub><span style="font-style:italic">n</span></sub>]]</td><td style="text-align:left;white-space:nowrap" >(1)&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;..&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>]]&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">//</span>&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2033;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;..&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>]]&#X202F;<span style="font-family:monospace">//</span>&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2033;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2034;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;..&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>]]&#X202F;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2033;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">number</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2034;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&lt;/</span>&#X2004;&#X202F;[[<span style="font-style:italic">element</span><sub>1</sub>]]&#X2004;..&#X2004;[[<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>]]&#X202F;<span style="font-family:monospace">//</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2033;&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">IN</span>&#X2004;&#X202F;&#X2004;<span style="font-style:italic">number</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-style:italic">dots</span>&#X2032;&#X2004;&#X202F;&#X2004;<span style="font-style:italic">indexvar</span>&#X2034;<span style="font-family:monospace">-1</span>&#X2004;&#X202F;&#X2004;<span style="font-family:monospace">/&gt;</span>&#X2004;
</td></tr>
</table></td></tr>
</table>
This is subject to constraints: (1) that 
[[<span style="font-style:italic">element</span><sub>1</sub>]] &#X202F; .. &#X202F; [[<span style="font-style:italic">element</span><sub><span style="font-style:italic">n</span></sub>]]
and
[[<span style="font-style:italic">element</span>&#X2032;<sub>1</sub>]] &#X202F; .. &#X202F; [[<span style="font-style:italic">element</span>&#X2032;<sub><span style="font-style:italic">n</span></sub>]] can be
anti-unified with exactly one varying index; (2) if the list has only
concrete entries (i.e., no list forms), its length must meet
the constraint of any <span style="font-style:italic">dots</span> in the
<span style="font-style:italic">element</span>.<p>With a separating <span style="font-style:italic">terminal</span>, we have: 
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" >&#X2004;[[<span style="font-style:italic">element</span>]]</td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >&#X454;&#X2004;|&#X2004;(<span style="font-style:italic">concrete</span>_<span style="font-style:italic">list</span>_<span style="font-style:italic">entry</span>&#X2004;|&#X2004;<span style="font-style:italic">list</span>_<span style="font-style:italic">form</span>)
(<span style="font-style:italic">terminal</span>&#X2004;(<span style="font-style:italic">concrete</span>_<span style="font-style:italic">list</span>_<span style="font-style:italic">entry</span>&#X2004;|&#X2004;<span style="font-style:italic">list</span>_<span style="font-style:italic">form</span>))<sup>*</sup>
</td></tr>
</table></td></tr>
</table></li></ol><p>In the above 
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">dots</span></td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">..</span>&#X2004;|&#X2004;<span style="font-family:monospace">...</span>&#X2004;|&#X2004;<span style="font-family:monospace">....</span>&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">number</span></td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">0</span>&#X2004;|&#X2004;<span style="font-family:monospace">1</span>&#X2004;&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">suffix</span></td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">suffix</span>_<span style="font-style:italic">item</span><sup>*</sup>&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">suffix</span>_<span style="font-style:italic">item</span></td><td style="text-align:center;white-space:nowrap" >::=</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" >(<span style="font-family:monospace">0</span>&#X2004;|&#X2004;<span style="font-family:monospace">1</span>&#X2004;|<span style="font-family:monospace">2</span>&#X2004;|&#X2004;<span style="font-family:monospace">3</span>&#X2004;|<span style="font-family:monospace">4</span>&#X2004;|&#X2004;<span style="font-family:monospace">5</span>&#X2004;|<span style="font-family:monospace">6</span>&#X2004;|&#X2004;<span style="font-family:monospace">7</span>&#X2004;|<span style="font-family:monospace">8</span>&#X2004;|&#X2004;<span style="font-family:monospace">9</span>)<sup>+</sup></td><td style="text-align:left;white-space:nowrap" >(longest match)&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">_</span>&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-family:monospace">&#X2019;</span>&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">indexvar</span>&#X2004;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:center;white-space:nowrap" >|</td><td style="text-align:left;white-space:nowrap" ><span style="font-style:italic">indexvar</span><span style="font-family:monospace">-1</span>&#X2004;</td></tr>
</table></td></tr>
</table><p>Further, whitespace (<code class="verb">' '|'\010'|'\009'|'\013'|'\012'</code>) is allowed before any token except a those in a suffix, and nonterminals, metavariables, index variables, and terminals that end with an alphanumeric character, must not be followed by an alphanumeric character.</p><p>The tool also builds a parser
for concrete terms, with fake nonterminal roots <span style="font-family:monospace">concrete_ntr</span>
for each primary <span style="font-family:monospace">ntr</span> of the syntax definition. One can
switch to concrete-term parsing with a <span style="font-family:monospace">:concrete:</span> annotation,
as in the example 
</p><pre class="verbatim"><span style="font-size:small">\[ [[ :concrete: \Z1&lt;:Top. \x:Z1.x ]]\]
</span></pre><p><span style="font-size:small">
</span>
shown in Figure&#X2004;&#X200D;<a href="#a56">10</a>. Below such an annotation, only concrete terms
are permitted, with no further annotation, no symbolic nonterminals or
metavariables, no list dot forms or comprehensions, etc.</p><p>Parsing of terms is done with a scannerless GLR parser over character-list
inputs. The parser
searches for all parses of the input. If none are found, the ASCII
and TeX output are annotated <span style="font-family:monospace">no parses</span>, with a copy of the
input with <span style="font-family:monospace">***</span> inserted at the point where the last token was
read. This is often at the point of the error (though if, for
example, a putative dot form is read but the two element lists cannot
be anti-unified, it will be after the point of the error). 
If multiple parses are found, the TeX output is annotated
<span style="font-family:monospace">multiple parses</span> and the different parses are output to the
console in detail during the Ott run.</p><p>The GLR parser 
achieves reasonable performance on the small symbolic terms that are
typical in semantic rules. Its performance on large (whole-program
size) examples is untested.</p>
<!--TOC section id="sec65" Reference: Generation of proof assistant definitions-->
<h2 id="sec65" class="section">24&#X2003;Reference: Generation of proof assistant definitions</h2><!--SEC END --><p><a id="a42"></a>This section briefly summarises the steps involved in the generation
of proof assistant definitions from an Ott source file. For a description of the locally-nameless backend, refer to <a href="http://moscova.inria.fr/&#X2004;&#X200D;zappa/projects/ln_ott/"><span style="font-family:monospace">http://moscova.inria.fr/&#X2004;&#X200D;zappa/projects/ln_ott/</span></a>.
</p>
<!--TOC subsection id="sec66" Generation of types-->
<h3 id="sec66" class="subsection">24.1&#X2003;Generation of types</h3><!--SEC END --><ul class="itemize"><li class="li-itemize"> 
The primary metavariable roots and primary nonterminal roots are used
directly as the names of proof assistant types, except where they
have a hom specifying a root-overriding string.
</li><li class="li-itemize">Type abbreviation declarations are produced for metavars, in the
source-file order, skipping metavars or nonterminals defined with <span style="color:#A51815"><span style="font-family:monospace">phantom</span></span>.
</li><li class="li-itemize">Type generation considers each rule of the user&#X2019;s source grammar
except those for <code class="verb">formula</code> and <code class="verb">terminals</code> (or the
synthesized rules for the syntax of judgements or <code class="verb">user_syntax</code>).
</li><li class="li-itemize">The subrule order is analysed to identify the top elements. For
each of those, a proof assistant type will be generated &#X2014; either a
free type (<code class="verb">coq</code>: <code class="verb">inductive</code>, <code class="verb">isa</code>:
<code class="verb">datatype</code>, <code class="verb">hol</code>: <code class="verb">Hol_datatype</code>), or if there is a
type hom for the proof assistant in question, a type abbreviation.
No types are generated for the non-top elements, as they will be
represented as predicates over the top free type above them.
</li><li class="li-itemize">For the former, each non-meta production of the rule
gives rise to a constructor. The production name (with any per-rule
prefix already applied) is used directly as the constructor name. 
The (curried) constructor argument types are taken from the
types associated with the metavariables and nonterminals mentioned
in the production body. 
</li><li class="li-itemize">Rules (within each <span style="color:#A51815"><span style="font-family:monospace">grammar</span></span> block, if <span style="font-family:monospace">-merge
false</span>, or all rules, if <span style="font-family:monospace">-merge true</span>) are topologically sorted according to the dependency order
(a free-type rule directly depends on another if one of its non-meta
productions includes a nonterminal of the other; dependencies for rules with a type-hom
for the proof assistant in question
are obtained from a crude lexing of the body of the type hom).
We then generate mutually recursive type
definitions for connected components, in an order consistent with
the dependencies.
</li><li class="li-itemize">For productions that involve list dot forms or list comprehension
forms, for HOL and Isabelle we produce constructors with argument
types that involve native list types. For Coq, however, we
synthesise an additional inductive type for each list-of-tuples that arises
(both for those that occur in the grammar and for others required in
the translations of inductive definitions) and include them in the
topological sort. 
</li></ul>
<!--TOC subsection id="sec67" Generation of functions-->
<h3 id="sec67" class="subsection">24.2&#X2003;Generation of functions</h3><!--SEC END --><p>
A small number of library functions (<code class="verb">list_mem</code>,
<code class="verb">list_minus</code>,...) are included in the output if they are
required.</p><p>Several Coq list functions (<code class="verb">map</code>, <code class="verb">make</code>, <code class="verb">unmake</code>, <code class="verb">nth</code>, <code class="verb">app</code>) are generated
for each synthesized list type.</p><p>The definitions of the more interesting functions (subrule predicates,
binding auxiliaries, free variable functions, and substitutions) are
generated over the free types generated for the maximal elements of the
subrule order (generation of these functions for rules with type homs
is not supported). The definitions are by pattern-matching and
recursion.
The patterns are generated by building canonical symbolic terms from
the productions of each relevant rule.
The recursion is essentially primitive recursion:
for Coq we produce <code class="verb">Fixpoint</code>s or <code class="verb">Definition</code>s
(the latter is sometimes needed as the former gives an error in the case where there is no
recursion);
for Isabelle we produce <code class="verb">primrec</code>s (or, experimentally, <code class="verb">fun</code>s);
for HOL we use an <code class="verb">ottDefine</code> variant of the <code class="verb">Define</code>
package.
In general we have to deal both with the type dependency 
(the topologically sorted mutually recursive types described above)
and with function dependency &#X2014; for example, for subrule predicates
and binding auxiliaries we may have multiple mutually recursive
functions over the same type.</p><p>For Coq the function generation over productions that involve list
types must mirror that, so we generate auxiliary functions 
that recurse over those list types. </p><p>For Isabelle the <code class="verb">primrec</code> package does not support 
definitions involving several mutually recursive functions over the
same type, so for these we generate single functions calculating 
tuples of results, define the intended functions as projections of
these, and generate lemmas (and simple proof scripts) characterising
them in terms of the intended definitions.
Further, it does not support pattern matching involving nested
constructors. We therefore generate auxiliary functions for
productions with embedded list types. Isabelle tuples are treated as
iterated pairs, so we do the same for productions with tuples of size
3 or more. 
Isabelle also requires a function definition for each recursive type.
In the case where there are multiple uses of the same type
(e.g.&#X2004;&#X200D;several uses of <code class="verb">t list</code> in different productions) all the
functions we wish to generate need identical auxiliaries. As yet, the
tool does not generate the identical copies required.</p><p>If the option <code class="verb">-isabelle_primrec</code> is set to <code class="verb">false</code>, then
Ott uses the <code class="verb">fun</code> package instead of the <code class="verb">primrec</code> package.
Since at the time of writing Isabelle 2008 is not capable of proving
automatically termination of all the <code class="verb">fun</code>s that Ott generates,
this feature should be considered experimental.</p><p>For HOL the standard <code class="verb">Define</code> package tries an automatic
termination proof. For productions that involve list types 
our generated functions involve various list functions which prevent
those proofs working in all cases. 
We therefore use an <code class="verb">ottDefine</code> variant (due to Scott Owens),
with slightly stronger support for proving termination of
definitions involving list operators.</p>
<!--TOC subsubsection id="sec68" Subrule predicates-->
<h4 id="sec68" class="subsubsection">24.2.1&#X2003;Subrule predicates</h4><!--SEC END --><p><a id="a43"></a>We generate subrule predicates to carve out the subsets of each free
proof assistant type (from the maximal elements of the subrule order) 
that represent the rules of the grammar. 
The non-free rules are the least subset of the rules that either
(1) occur on the left of a subrule (<code class="verb">&lt;::</code>) declaration, or
(2) have a (non-meta) production that mentions a non-free rule. 
Note that these can include rules that are maximal elements of the
subrule order, e.g.&#X2004;&#X200D;if an expression grammar included a production
involving packaged values. 
The subrule predicate for a type is defined by pattern matching over
constructors of the maximal type above it &#X2014; for each non-meta
production of the maximal type it calculates a disjunction
over all the productions of the lower type that are subproductions of
it, invoking other subrule predicates as appropriate. </p>
<!--TOC subsubsection id="sec69" Binding auxiliaries-->
<h4 id="sec69" class="subsubsection">24.2.2&#X2003;Binding auxiliaries</h4><!--SEC END --><p>
The binding auxiliary functions calculate the intuitive semantics of auxiliary functions defined in bindspecs of the Ott source file. Currently these are represented as proof assistant lists of metavariables or nonterminals (arguably set types should be used instead, at least in Isabelle).</p>
<!--TOC subsubsection id="sec70" Free variables-->
<h4 id="sec70" class="subsubsection">24.2.3&#X2003;Free variables</h4><!--SEC END --><p>
The free variable functions simply walk over the structure of the free proof assistant types, using any bind specifications (and binding auxiliaries) as appropriate. 
For these, and for substitutions, we simplify the generated functions by using the dependency analysis of the syntax to exclude recursive calls where there is no dependency. </p>
<!--TOC subsubsection id="sec71" Substitutions-->
<h4 id="sec71" class="subsubsection">24.2.4&#X2003;Substitutions</h4><!--SEC END --><p>
The generated substitution functions also walk over the structure of the free proof assistant types. 
For each production, for each occurrence of a nonterminal <code class="verb">nt</code> within it, we first calculate the things (of whatever type is in question) binding in that <code class="verb">nt</code>, i.e.&#X2004;&#X200D;those that should be removed from the domain of any substitution pushed down into it. There are two cases:
(1) the <code class="verb">mse'</code> from any <code class="verb">bind mse' in nt</code>;
(2) <code class="verb">nt</code> itself if it occurs in the <code class="verb">mse''</code> of any <code class="verb">bind mse'' in nt''</code>, i.e.&#X2004;&#X200D;
<code class="verb">nt</code> itself if it is directly used to bind elsewhere.
List forms within bindspecs are dealt with analogously. 
</p><p>The substitution function clause for a production is then of one of two forms:
either (1) the production comprises a single element, of the nonterminal or metavariable that we are substituting for, and this is within the rule of the nonterminal that it is being replaced by, or (2) all other cases. 
For (1) the element is compared with the domain of the substitution, and replaced by the corresponding value from the range if it is found.
For (2) the substitution functions are mapped over the subelements, having first removed any bound things from the domain of the substitution. </p><p>This is all done similarly, but with differences in detail, for single and for multiple substitutions. </p>
<!--TOC subsection id="sec72" Generation of relations-->
<h3 id="sec72" class="subsection">24.3&#X2003;Generation of relations</h3><!--SEC END --><p>
The semantic relations are defined
with the proof-assistant inductive relations packages
(<code class="verb">coq</code>: <code class="verb">Inductive</code>,
<code class="verb">isa</code>: <code class="verb">inductive</code>,
<code class="verb">hol</code>: <code class="verb">Hol_reln</code>).
They use the mutual recursion structure that is given by the user,
with each <code class="verb">defns</code> block giving rise to a potentially mutually
recursive definition of each <code class="verb">defn</code> inside it.
(It is debatable whether it would be preferable to do an automatic dependency analysis and topological sort, as for the syntax.)
Each definition rule gives rise to an implicational clause, essentially
that the premises (Ott <code class="verb">formula</code>s) imply the conclusion (an Ott symbolic term of whichever judgement is being defined). 
In addition:
</p><ul class="itemize"><li class="li-itemize">
Symbolic terms are transformed in various different ways:
<ul class="itemize"><li class="li-itemize">
Nodes of non-meta productions are output as applications of the appropriate proof-assistant constructor (and, for a subrule, promoted to the corresponding constructor of a maximal rule).
</li><li class="li-itemize">Nodes of meta productions are transformed with the user-specified homomorphism.
</li><li class="li-itemize">Nodes of judgement forms are represented as applications of the defined relation in Coq and HOL, and as set-membership assertions in Isabelle.
</li><li class="li-itemize">Lists of formulae (the <code class="verb">formula_dots</code> production) are special-cased.
</li></ul>
</li><li class="li-itemize">For each nonterminal of a non-free syntax rule (as in &#XA7;<a href="#a43">24.2.1</a>) that occurs,
e.g.&#X2004;&#X200D;a usage of <code class="verb">v'</code> where <code class="verb">v&lt;::t</code>, an additional premise invoking the subrule predicate for the non-free rule is added, e.g.&#X2004;&#X200D;<code class="verb">is_v v'</code>.
</li><li class="li-itemize">The set of symbolic terms of the definition rule are analysed together to identify list forms with the same bounds. A single proof assistant variable is introduced for each such, with appropriate projections and list maps/foralls at the usage points.
</li><li class="li-itemize">For Coq, auxiliary defined relations are introduced for list forms.
</li><li class="li-itemize">For Coq, as the projections from list forms involve (Ott-generated) <code class="verb">nth</code> functions that return option types, for any such projection a pattern-match against <code class="verb">Some</code> is introduced as an additional premise.
</li><li class="li-itemize">For Coq and HOL, explicit quantifiers are introduced for all variables mentioned in the rule.
</li></ul>
<!--TOC section id="sec73" Reference: Summary of homomorphisms-->
<h2 id="sec73" class="section">25&#X2003;Reference: Summary of homomorphisms</h2><!--SEC END --><p><a id="a41"></a>Homomorphisms can appear in various positions in an Ott source
file. The table below summarises their meanings. A * indicates that arguments are meaningful for that usage (e.g.&#X2004;&#X200D;<span style="font-family:monospace"><span style="color:#007FFF">[[</span></span><span style="font-family:monospace">e1</span><span style="font-family:monospace"><span style="color:#007FFF">]]</span></span> in a production mentioning a nonterminal or metavariable
<code class="verb">e1</code>).</p><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>a metavar or indexvar declaration, after one of the defined metavar/indexvar roots, or</td></tr>
<tr><td style="text-align:left;white-space:nowrap"  colspan=3>a rule, after one of the defined nonterminal
roots</td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >LaTeX typesetting for symbolic variables with that root</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa</span></span>/<span style="color:#A51815"><span style="font-family:monospace">coq</span></span>/<span style="color:#A51815"><span style="font-family:monospace">hol</span></span>/<span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle/Coq/HOL/OCaml root overriding string (1) </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">repr-locally-nameless</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >use a locally-nameless representation (Coq backend only) </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>a metavar or indexvar declaration, after the <span style="font-family:monospace">::=</span></td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Coq representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">hol</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >HOL representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >OCaml representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >LaTeX typesetting for symbolic variables </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">com</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >comment to appear in LaTeX syntax definition </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Coq proof script to decide equality over the representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq-universe</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Coq universe (e.g.&#X2004;&#X200D;<span style="font-family:monospace">Type</span>) for the representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">repr-locally-nameless</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >(Coq only) use a locally-nameless representation </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">phantom</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >suppress the representation type definition in theorem prover output </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">lex</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >regular expression for lexing concrete variables </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">texvar</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >LaTeX typesetting for concrete variables </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isavar</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >Isabelle output for concrete variables </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">holvar</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >HOL output for concrete variables </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ocamlvar</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >OCaml output for concrete variables </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>a rule, after the <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle representation type, if a non-free type is required </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Coq representation type, if a non-free type is required </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">hol</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >HOL representation type, if a non-free type is required </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >OCaml representation type, if a non-free type is required </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >LaTeX typesetting for symbolic variables </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">com</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >comment to appear in LaTeX syntax definition </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq-equality</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Coq proof script to decide equality over the representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq-universe</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Coq universe (e.g.&#X2004;&#X200D;<span style="font-family:monospace">Type</span>) for the representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">phantom</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >suppress the representation type definition in theorem prover output </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">aux</span></span></td><td style="text-align:center;white-space:nowrap" >(*)</td><td style="text-align:left;white-space:nowrap" >construct an auxiliary grammar rule with a single production </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">icho</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span>, <span style="color:#A51815"><span style="font-family:monospace">isa</span></span>, <span style="color:#A51815"><span style="font-family:monospace">hol</span></span>, and <span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ichlo</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span>,
<span style="color:#A51815"><span style="font-family:monospace">isa</span></span>, <span style="color:#A51815"><span style="font-family:monospace">hol</span></span>, <span style="color:#A51815"><span style="font-family:monospace">lem</span></span>, and <span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ich</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span>, <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> and <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ic</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> and <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ch</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> and <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ih</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> and <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>a production</td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >Isabelle output, for a non-free (meta) production </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >Coq output, for a non-free (meta) production </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">hol</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >HOL output, for a non-free (meta) production </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >OCaml output, for a non-free (meta) production </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >LaTeX typesetting for symbolic terms </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">texlong</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >typeset as long production </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">com</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >comment to appear in LaTeX syntax definition </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">order</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >specify order of arguments to prover or Ocaml constructor</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isasyn</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >Isabelle mixfix syntax output </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isaprec</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle mixfix syntax precedence string </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ich</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span>, <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> and <span style="color:#A51815"><span style="font-family:monospace">hol</span></span>homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ic</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> and <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ch</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">coq</span></span> and <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ih</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >shorthand for identical <span style="color:#A51815"><span style="font-family:monospace">isa</span></span> and <span style="color:#A51815"><span style="font-family:monospace">hol</span></span> homs</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>a production of the <span style="font-family:monospace">terminals</span> grammar</td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle output, for terminals in default generated Isabelle mixfix declarations </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >LaTeX default typesetting for terms </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">com</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >comment to appear in LaTeX syntax definition </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>a <span style="color:#A51815"><span style="font-family:monospace">defn</span></span>, before the <span style="color:#A51815"><span style="font-family:monospace">by</span></span></td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >LaTeX typesetting for symbolic terms </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">com</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >comment to appear in LaTeX syntax definition </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isasyn</span></span></td><td style="text-align:center;white-space:nowrap" >*</td><td style="text-align:left;white-space:nowrap" >Isabelle mixfix syntax output </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isaprec</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle mixfix syntax precedence string </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">lemwcf</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Lem witness, check, and functions spec for indrelns </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap"  colspan=3>a <span style="color:#A51815"><span style="font-family:monospace">homs</span></span> section clause (for a production or a definition)</td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap"  colspan=3>as in the above production and <span style="color:#A51815"><span style="font-family:monospace">defn</span></span> forms</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>a group of defns, after the <span style="color:#007FFF"><span style="font-family:monospace">::=</span></span></td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq-universe</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Coq universe (e.g.&#X2004;&#X200D;<span style="font-family:monospace">Type</span>) for the representation type </td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>an <span style="color:#A51815"><span style="font-family:monospace">embed</span></span> section</td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >embedded Isabelle output</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >embedded Coq output</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">hol</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >embedded HOL output</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">ocaml</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >embedded OCaml output</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >embedded LaTeX output</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">tex-preamble</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >embedded LaTeX output, appearing in the LaTeX preamble</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">coq-lib</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >do not generate definitions for the listed helper functions</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa-auxfn-proof</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle proof script </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa-subrule-proof</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle proof script </td></tr>
</table><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap"  colspan=3>in a subrule, substitution or function definition</td></tr>
<tr><td class="hrule" colspan=3></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="color:#A51815"><span style="font-family:monospace">isa-proof</span></span></td><td style="text-align:center;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >Isabelle proof script </td></tr>
</table><p>(1) This is occasionally useful to work around a clash between a
metavar or nonterminal primary root and a proof assistant symbol,
e.g.&#X2004;&#X200D;<span style="font-family:monospace">value</span> in Isabelle or <span style="font-family:monospace">T</span> in HOL.</p>
<!--TOC section id="sec74" Reference: The Ott source grammar-->
<h2 id="sec74" class="section">26&#X2003;Reference: The Ott source grammar</h2><!--SEC END --><p>
This is automatically generated (by <code class="verb">mly-y2l</code>) from the
<code class="verb">ocamlyacc</code> grammar for Ott.
</p><p>The lexing of Ott source files is context-dependent; this does not
show that.</p><p>Not everything in the grammar is fully supported &#X2014; in particular,
option element forms, non-dotted element list forms, the three <code class="verb">names</code> distinctness forms of
bindspecs, and context rules.</p><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">main</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
items
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">items</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
item items
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
EOF
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">item</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
metavardefn
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
RULES rules
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DEFNCLASS defnclass
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
FUNDEFNCLASS fundefnclass
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
SUBRULES subrules
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
CONTEXTRULES contextrules
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
SUBSTITUTIONS substitutions
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
FREEVARS freevars
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
EMBED embed
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
PARSING parsing_annotations
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
HOMS hom_section
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COQSECTIONBEGIN coq_section_begin
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COQSECTIONEND coq_section_end
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COQVARIABLE coq_variable
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">metavardefn</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
metavardefn_int
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
indexvardefn_int
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">metavardefn_int</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
METAVAR ne_ident_hom_desc_list CCE metavarrep
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">indexvardefn_int</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
INDEXVAR ne_ident_hom_desc_list CCE metavarrep
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">metavarrep</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
homomorphism_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">homomorphism_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ homomorphism }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">homomorphism</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOUBLELEFTBRACE hom_name hom_spec_el_list DOUBLERIGHTBRACE
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">hom_name</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
[ BLANKS ] STRING BLANKS
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">hom_spec_el_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ hom_spec_el }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">hom_spec_el</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOUBLELEFTBRACKET hom_inner DOUBLERIGHTBRACKET
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
BLANKS
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOTDOT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOTDOTDOT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOTDOTDOTDOT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">hom_inner</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident_and_blanks_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident_and_blanks_list dots ident_and_blanks_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COMP_LEFT ident_and_blanks_list COMP_MIDDLE comp_bound COMP_RIGHT blanks_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">embedmorphism_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ embedmorphism }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">embedmorphism</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOUBLELEFTBRACE hom_name embed_spec_el_list DOUBLERIGHTBRACE
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">embed_spec_el_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ embed_spec_el }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">embed_spec_el</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOUBLELEFTBRACKET embed_inner DOUBLERIGHTBRACKET
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
BLANKS
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOTDOT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOTDOTDOT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOTDOTDOTDOT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">embed_inner</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ ( STRING | BLANKS ) }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">bindspec</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
BIND mse IN ident
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident EQ mse
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
NAMES LPAREN mse RPAREN EQ NAMES LPAREN mse RPAREN
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
NAMES LPAREN mse RPAREN HASH NAMES LPAREN mse RPAREN
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DISTINCTNAMES LPAREN mse RPAREN
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">bindspeclist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ bindspec }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">mse</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident dots ident
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COMP_LEFT ident COMP_MIDDLE comp_bound COMP_RIGHT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident LPAREN ident RPAREN
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident LPAREN ident dots ident RPAREN
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident LPAREN COMP_LEFT ident COMP_MIDDLE comp_bound COMP_RIGHT RPAREN
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident COMP_LEFT ident COMP_MIDDLE comp_bound COMP_RIGHT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
mse UNION mse
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
EMPTY
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">bindspeclistlist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ BIND_LEFT_DELIM bindspeclist BIND_RIGHT_DELIM }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">bindspecall</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
bindspeclistlist
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">dots</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
[ DOTDOT | DOTDOTDOT | DOTDOTDOTDOT ]
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">element</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
dots
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COMP_LEFT element_list COMP_MIDDLE comp_bound COMP_RIGHT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COMP_LEFT element_list COMP_MIDDLE ident COMP_MIDDLE comp_bound COMP_RIGHT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">comp_bound</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident [ COMP_IN ident [ dots ident ] ]
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">element_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ element }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">rules</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
rule_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">rule_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ rule }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">rule</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ne_ident_hom_desc_list COLONCOLON STRING CCE homomorphism_list prodlist
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">prod</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
flavour element_list COLONCOLON ident_list COLONCOLON STRING bindspecall homomorphism_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">prodlist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ prod }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">flavour</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
BAR
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">ident_desc</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">ne_ident_hom_desc_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident_desc homomorphism_list [ COMMA ne_ident_hom_desc_list ]
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">ident</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">blanks</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
BLANKS
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">ident_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ ( ident | BLANKS ) }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">ident_and_blanks_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ ( ident | blanks ) }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">blanks_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ BLANKS }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">defnclass</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING COLONCOLON STRING CCE homomorphism_list defn_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">defn_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ defn }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">defn</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DEFN element_list COLONCOLON ident_list COLONCOLON STRING COLONCOLON STRING homomorphism_list BY semiraw_rule_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">fundefnclass</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING CCE homomorphism_list fundefn_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">fundefn_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ fundefn }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">fundefn</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
FUNDEFN element_list COLONCOLON ident COLONCOLON STRING homomorphism_list BY BLANKLINE anylinelist
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">anylinelist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ ( line | COMMENTLINE | BLANKLINE ) }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">line</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
LINE
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">lineline</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
LINELINE
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">linelist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ ( line | COMMENTLINE ) }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">nelinelist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
[ ( line | COMMENTLINE ) linelist ]
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">semiraw_rule</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
linelist lineline linelist
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
nelinelist
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">blanklinelist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ BLANKLINE }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">neblanklinelist</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
BLANKLINE { BLANKLINE }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">defncom</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DEFNCOM embed_spec_el_list DOUBLERIGHTBRACE
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">semiraw_rule_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
blanklinelist
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
neblanklinelist semiraw_rule semiraw_rule_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
neblanklinelist defncom semiraw_rule_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">subrules</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
subrules_body
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">subrules_body</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ subrule }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">subrule</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident_desc LTCOLONCOLON ident_desc homomorphism_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">contextrules</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
contextrules_body
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">contextrules_body</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ contextrule }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">contextrule</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident_desc UNDERSCORECOLONCOLON ident_desc COLONCOLON ident_desc
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">substitutions</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
substitutions_body
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">substitutions_body</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ substitution }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">substitution</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
substitution_kind ident_desc ident_desc COLONCOLON ident_desc homomorphism_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">substitution_kind</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
SINGLE
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
MULTIPLE
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">freevars</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
freevars_body
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">freevars_body</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ freevar }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">freevar</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident_desc ident_desc COLONCOLON ident_desc homomorphism_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">embed</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
embedmorphism_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">parsing_annotation_type</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
LTEQ
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
LEFT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
RIGHT
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
NON
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">parsing_annotations</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
parsing_annotations_body
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">parsing_annotations_body</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ parsing_annotation }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">parsing_annotation</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
ident_desc parsing_annotation_type ident_desc
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">hom_section_item</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
COLONCOLON STRING bindspecall homomorphism_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">hom_section_item_list</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ hom_section_item }
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">hom_section</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING hom_section_item_list
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">coq_section_begin</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">coq_section_end</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">coq_variable</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">unfiltered_spec_el</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
DOUBLELEFTBRACKET unfiltered_inner DOUBLERIGHTBRACKET
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
STRING
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">&nbsp;</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">|</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
BLANKS
</span></div></div><span style="font-size:small"> </span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><span style="font-size:small">unfiltered_inner</span></td><td style="text-align:right;white-space:nowrap" ><span style="font-size:small">::=</span></td><td style="text-align:left;white-space:nowrap" ><span style="font-size:small"> </span><div class="minipage"><div class="flushleft"><span style="font-size:small">
{ ( STRING | BLANKS ) }
</span></div></div><span style="font-size:small"> </span></td></tr>
</table>
<!--TOC section id="sec75" Reference: Examples-->
<h2 id="sec75" class="section">27&#X2003;Reference: Examples</h2><!--SEC END --><p><a id="a33"></a>The project web page
</p><blockquote class="quotation">
<a href="http://www.cl.cam.ac.uk/users/pes20/ott/"><span style="font-family:monospace">http://www.cl.cam.ac.uk/users/pes20/ott/</span></a>
</blockquote><p>
gives a variety of examples. Some of these, and additional
small examples, are included in the distribution in the <code class="verb">tests</code>
directory. Typically they can be built using the <code class="verb">Makefile</code> in
the <code class="verb">ott</code> directory, e.g.&#X2004;&#X200D;typing <code class="verb">make test10</code> or (more generally) <code class="verb">make tests/test10.out</code>) there.</p><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test10.ott</code></td><td style="text-align:left;white-space:nowrap" >untyped CBV lambda</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test10st.ott</code></td><td style="text-align:left;white-space:nowrap" >simply typed CBV lambda</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test8.ott</code></td><td style="text-align:left;white-space:nowrap" >ML polymorphism example</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test7a.ott</code></td><td style="text-align:left;white-space:nowrap" >POPLmark Fsub example (without records)</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test7b.ott</code></td><td style="text-align:left;white-space:nowrap" >POPLmark Fsub example (with records)</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">leroy-jfp96.ott</code></td><td style="text-align:left;white-space:nowrap" >Leroy module system </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">lj.ott</code></td><td style="text-align:left;white-space:nowrap" >LJ: Lightweight Java</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test7t.mng</code></td><td style="text-align:left;white-space:nowrap" >whole-document tex mng source</td></tr>
<tr><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >(<code class="verb">make test7afilter</code> to build) </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test7tt.mng</code></td><td style="text-align:left;white-space:nowrap" >fragment tex mng source</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><code class="verb">test11.ott</code></td><td style="text-align:left;white-space:nowrap" >subrule example</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test12.ott</code></td><td style="text-align:left;white-space:nowrap" >topological sort example</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test13.ott</code></td><td style="text-align:left;white-space:nowrap" >small bindspec fragment</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><code class="verb">test10st_snapshot_out.thy</code></td><td style="text-align:left;white-space:nowrap" >snapshot of generated Isabelle from <code class="verb">test10st.ott</code> </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><code class="verb">test10st_metatheory_autoed.thy</code></td><td style="text-align:left;white-space:nowrap" >Isabelle proof script for type
preservation and progress </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><code class="verb">test10st_codegen.thy</code></td><td style="text-align:left;white-space:nowrap" >Isabelle code generation script for reduction</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><code class="verb">test10_isasyn.ott</code></td><td style="text-align:left;white-space:nowrap" >Isabelle mixfix syntax example</td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><code class="verb">test10st_metatheoryScript.sml</code></td><td style="text-align:left;white-space:nowrap" >HOL proof script for type preservation and progress </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">test17.10.ott</code></td><td style="text-align:left;white-space:nowrap" >list comprehension examples</td></tr>
</table><p>The <code class="verb">examples/tapl</code> directory contains several examples taken from the book &#X2018;Types and Programming Languages&#X2019; by Benjamin Pierce. The <span style="font-family:monospace">make</span> targets, listed below, combine Ott source files
following roughly the TinkerType component structure used in TAPL.</p><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-bool</code></td><td style="text-align:left;white-space:nowrap" >booleans (p34) </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-arith</code></td><td style="text-align:left;white-space:nowrap" >arithmetic expressions (p41) </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-untyped</code></td><td style="text-align:left;white-space:nowrap" >untyped lambda-calculus with booleans </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-puresimple</code></td><td style="text-align:left;white-space:nowrap" >simply-typed lambda-calculus </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-tybool</code></td><td style="text-align:left;white-space:nowrap" >typed booleans </td></tr>
<tr><td style="text-align:left;white-space:nowrap" ><code class="verb">sys-sortoffullsimple</code></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-roughlyfullsimple</code></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-puresub</code></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code class="verb">sys-purercdsub</code></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td></tr>
</table><p>Other examples can be found on the locally-nameless backend web page.</p><!--TOC section id="sec76" Acknowledgements-->
<h2 id="sec76" class="section">Acknowledgements</h2><!--SEC END --><p>
We thank 
the Ott users for their feedback, especially Matthew Parkinson;
the other members of the POPLmark team, especially Benjamin
Pierce, Stephanie Weirich, and Steve Zdancewic, for 
discussions;
and Keith Wansbrough, Matthew Fairbairn, and Tom Wilkie, for their work
on various Ott predecessors.</p><p>We acknowledge the support of EPSRC grants
GR/T11715, EP/C510712, and EP/F036345, a Royal Society
University Research Fellowship (Sewell), an EPSRC Leadership
Fellowship (Sewell), 
EPSRC Programme Grant, EP/K008528/1 REMS <em>Rigorous Engineering of
Mainstrem Systems</em>,
and ANR grant ANR-06-SETI-010-02 (Zappa Nardelli). </p><!--BEGIN NOTES document-->
<hr class="footnoterule"><dl class="thefootnotes"><dt class="dt-thefootnotes">
<a id="note1" href="#text1">1</a></dt><dd class="dd-thefootnotes"><div class="footnotetext">Strictly, clauses
of primitive recursive function definitions from symbolic terms to strings, here of LaTeX code.</div></dd></dl>
<!--END NOTES-->
<!--CUT END -->
<!--HTMLFOOT-->
<!--ENDHTML-->
<!--FOOTER-->
<hr class="horizontal-rule" style="height:2px"><blockquote class="quote"><em>This document was translated from L<sup>A</sup>T<sub>E</sub>X by
</em><a href="http://hevea.inria.fr/index.html"><em>H</em><em><span style="font-size:small"><sup>E</sup></span></em><em>V</em><em><span style="font-size:small"><sup>E</sup></span></em><em>A</em></a><em>.</em></blockquote></body>
</html>
